"scrContracts As screen.'phoneLayout_FluidGridWithHeaderPageLayout_ver3.0'":
    OnVisible: |-
        =//Set(orderItemNumber,"12345");
        /*If(!IsBlank(OrderSHPItemID),
            Set(customFormMode,FormMode.Edit),
            Set(customFormMode,FormMode.New)
        );*/
        
        If(customFormMode = FormMode.Edit || customFormMode = FormMode.View,
            Set(ContractSHPItem,LookUp(DMSContract,ID = ContractSHPItemID)),
            Set(ContractSHPItem,Blank())
        );
        
        If(customFormMode = FormMode.Edit && (!(SHPMeClaim.Email in ContractSHPItem.'Actual Owner E-mail') || !IsBlank(ContractSHPItem.'Action Required')),
            Set(customFormMode,FormMode.View)
        );
        
        UpdateContext({popUpDelegateToVisibility: false});
        UpdateContext({popUpLogItemDetailVisibility: false});
        UpdateContext({popUpLogItemDetailVisibility: false});
        UpdateContext({popUpReopenVisibility: false});
        UpdateContext({popUpNewAttachmentLinkVisibility: false});
        UpdateContext({popUpNewAttachmentVisibility: false});
        If(customFormMode = FormMode.Edit,
            UpdateContext({showLoading: true}),
            UpdateContext({showLoading: false})
        );
        UpdateContext({showLoadingNewItem: false});
        UpdateContext({showLoadingItemsCount: 0});
        //form validation
           /*UpdateContext({txtOrderNumber_validation: true});
           UpdateContext({cbOrdLegalEntity_validation: true});
           UpdateContext({cbOrdContractNumber_validation: true});
           UpdateContext({dpOrderDate_validation: true});
           UpdateContext({txtOrderDescription_validation: true});
           UpdateContext({cbOrdVendor_validation: true});
           UpdateContext({cbOrdRequestor_validation: true});
           UpdateContext({cbOrdDepartment_validation: true});
           UpdateContext({txtOrdBudgetOwner_validation: true});
           UpdateContext({cbOrderOrderer_validation: true});
           UpdateContext({txtOrderRecipient_validation: true});
           UpdateContext({txtlblOrderDescriptionDetailed_validation: true});
           UpdateContext({cbWatchers_validation: true});
           UpdateContext({txtOrderOrdLogEventDescription_validation: true});
           UpdateContext({OrderItems_validation: true});*/
        
        UpdateContext({txtContractLogEventDescription_validation: true});
        UpdateContext({cbContractLegalEntity_validation: true});
        UpdateContext({txtContractNumber_validation: true});
        UpdateContext({txtContractAmendment_validation: true});
        UpdateContext({txtContractDescription_validation: true});
        UpdateContext({cbContractOwner_validation: true});
        UpdateContext({cbContractDepartment_validation: true});
        UpdateContext({txtContractReason_validation: true});
        UpdateContext({cbContractDuration_validation: true});
        UpdateContext({dpContractDateOfExpiration_validation: true});
        UpdateContext({txtContractTerminationPeriodMonths_validation: true});
        UpdateContext({txtContractLiabilityLimitValue_validation: true});
        UpdateContext({txtContractFinValue_validation: true});
        UpdateContext({cbContractFinValueCurrency_validation: true});
        UpdateContext({txtContractFinValueLocalCurrency_validation: true});
        UpdateContext({txtContractFinValueExchRate_validation: true});
        UpdateContext({txtContractSubject_validation: true});
        UpdateContext({txtContractNotes_validation: true});
        UpdateContext({txtContractPrintsNumberHEU_validation: true});
        UpdateContext({txtContractPrintsNumberOther_validation: true});
        UpdateContext({txtContractPartyRegID1_validation: true});
        UpdateContext({txtContractPartyName1_validation: true});
        UpdateContext({glrOrderAttachments_2_validation: true});
        UpdateContext({txtDelagateToDescription_validation: true});
        UpdateContext({cbDelegateTo_validation: true});
        UpdateContext({txtReturnToDescription_validation: true});
        UpdateContext({cbReturnTo_validation: true});
        UpdateContext({budgetOwner_validation: true});
        UpdateContext({txtContractInternalNumber_validation: true});
        UpdateContext({txtContractMainContractYear_validation: true});
        UpdateContext({cbContractAmendmentContract_validation: true});
        UpdateContext({cbContractAmendmentType_validation: true});

    tmrAttachments As timer:
        AutoPause: =false
        AutoStart: =true
        Duration: =5000
        OnTimerEnd: =Refresh(DMSContractDocuments);
        Repeat: =true
        Visible: =false
        X: =996
        Y: =468
        ZIndex: =1

    CanvasContractDetails As fluidGrid.fluidGridWithBlankCard:
        BorderThickness: =0
        Height: =Parent.Height - buttonsContracts.Height - headerContracts.Height - 15
        Width: =Parent.Width
        Y: =buttonsContracts.Y + buttonsContracts.Height + 15
        ZIndex: =2

        dcContractDetails As dataCard.blankCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =1967
            Width: =1366
            X: =0
            Y: =0
            ZIndex: =1

            rightColumnContract As groupContainer:
                Fill: =Transparent
                Height: =1503
                Width: =633
                X: =733
                ZIndex: =1

                ContractApprovalDetails As groupContainer:
                    Fill: =patternColor5.Fill
                    Height: =853
                    Width: =606
                    Y: =620
                    ZIndex: =4

                    ProcessHistory_2 As groupContainer:
                        BorderColor: =patternColor1.Fill
                        BorderThickness: =1
                        Fill: =Transparent
                        Height: =515
                        Width: =583
                        X: =10
                        Y: =314
                        ZIndex: =1

                        "glrProcessHistoryItems_2 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
                            Height: =348
                            Items: =Sort(Filter(DMSProcessLog, DMSLogItemId = Text(ContractSHPItem.ID)),Created, Descending)
                            Layout: =Layout.Vertical
                            TemplatePadding: =0
                            TemplateSize: =45
                            Width: =573
                            X: =10
                            Y: =85
                            ZIndex: =1

                            Separator1_6 As rectangle:
                                Fill: =patternColor1.Fill
                                Height: =1
                                OnSelect: =Select(Parent)
                                Width: =Parent.TemplateWidth
                                Y: =Parent.TemplateHeight - 1
                                ZIndex: =1

                            lblOrdLogEventDescriptionValue_2 As label:
                                Color: =labelSettings.Color
                                Font: =labelSettings.Font
                                Height: =38
                                Size: =10
                                Text: =Left(ThisItem.DMSLogEventDescription, 34) & If(Len(ThisItem.DMSLogEventDescription) > 34, "...")
                                Tooltip: =labelSettings.Tooltip
                                VerticalAlign: =VerticalAlign.Top
                                Width: =132
                                X: =398
                                Y: =4
                                ZIndex: =2

                            lblOrdLogEventTitleValue_2 As label:
                                Color: =labelSettings.Color
                                Font: =labelSettings.Font
                                Height: =38
                                Size: =10
                                Text: |-
                                    =//LookUp(LogActivities,AppKey=Value(ThisItem.DMSLogEventTitle) && Language=SelectedLanguage,String)
                                    ThisItem.DMSLogEventTitle
                                Tooltip: =labelSettings.Tooltip
                                Width: =291
                                X: =98
                                Y: =4
                                ZIndex: =3

                            lblOrdLogDateValue_2 As label:
                                Align: =Align.Right
                                Color: =labelSettings.Color
                                Font: =labelSettings.Font
                                Height: =38
                                Size: =10
                                Text: |-
                                    =Text(ThisItem.DMSLogDate, "[$-en-US]dd. mm. yyyy") & "
                                    " & Text(ThisItem.DMSLogDate, "[$-en-US]hh:mm")
                                Tooltip: =labelSettings.Tooltip
                                Width: =86
                                Y: =4
                                ZIndex: =5

                            Icon1_2 As icon.Add:
                                Color: =patternColor4.Fill
                                Height: =26
                                Icon: =Icon.ChevronRight
                                OnSelect: |-
                                    =Select(Parent);
                                    UpdateContext({popUpLogItemDetailVisibility: true});
                                Width: =30
                                X: =530
                                Y: =10
                                ZIndex: =6

                        lblOrdLogEventDescription_2 As label:
                            Color: =labelSettings.Color
                            Font: =labelSettings.Font
                            Size: =labelSettings.Size
                            Text: =LookUp(StringsProcess,AppKey="lblOrdLogEventDescription" && Language=SelectedLanguage,String)
                            Tooltip: =labelSettings.Tooltip
                            X: =417
                            Y: =50
                            ZIndex: =6

                        lblOrdLogEventTitle_2 As label:
                            Color: =labelSettings.Color
                            Font: =labelSettings.Font
                            Size: =labelSettings.Size
                            Text: =LookUp(StringsProcess,AppKey="lblOrdLogEventTitle" && Language=SelectedLanguage,String)
                            Tooltip: =labelSettings.Tooltip
                            Width: =134
                            X: =105
                            Y: =50
                            ZIndex: =7

                        lblOrdLogDate_2 As label:
                            Color: =labelSettings.Color
                            Font: =labelSettings.Font
                            Size: =labelSettings.Size
                            Text: =LookUp(StringsProcess,AppKey="lblOrdLogDate" && Language=SelectedLanguage,String)
                            Tooltip: =labelSettings.Tooltip
                            Width: =95
                            X: =10
                            Y: =50
                            ZIndex: =10

                        lblProcessLog_2 As label:
                            Color: =labelSettings.Color
                            Font: =labelSettings.Font
                            FontWeight: =FontWeight.Semibold
                            Size: =labelSettings.Size
                            Text: =LookUp(StringsProcess,AppKey="lblProcessLog" && Language=SelectedLanguage,String)
                            Tooltip: =labelSettings.Tooltip
                            Width: =190
                            X: =10
                            Y: =9
                            ZIndex: =11

                    txtContractLogActualPhaseDate As text:
                        BorderColor: =patternColor3.Fill
                        BorderThickness: =1
                        Default: =ContractSHPItem.Modified
                        DisabledColor: |-
                            =RGBA(0, 0, 0, 1)
                            //RGBA(166; 166; 166; 1)
                        DisplayMode: =DisplayMode.Disabled
                        FocusedBorderColor: =patternColor4.Fill
                        FocusedBorderThickness: =1
                        HoverBorderColor: =patternColor4.Fill
                        HoverFill: =ColorFade(patternColor3.Fill, 90%)
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =382
                        X: =211
                        Y: =txtContractLogActualOwner.Y + 100
                        ZIndex: =4

                    lblContractLogActualPhaseDate As label:
                        Color: =labelSettings.Color
                        Font: =labelSettings.Font
                        Size: =labelSettings.Size
                        Text: =LookUp(StringsProcess,AppKey="lblPhaseDate" && Language=SelectedLanguage,String)
                        Tooltip: =labelSettings.Tooltip
                        Width: =190
                        X: =lblContractLogActualOwner.X
                        Y: =lblContractLogActualOwner.Y + 100
                        ZIndex: =5

                    txtContractLogActualPhase As text:
                        BorderColor: =patternColor3.Fill
                        BorderThickness: =1
                        Default: =LookUp(StatesContract, AppKey= Value(ContractSHPItem.'Actual Phase') && Language = SelectedLanguage, String)
                        DisabledColor: |-
                            =RGBA(0, 0, 0, 1)
                            //RGBA(166; 166; 166; 1)
                        DisplayMode: =DisplayMode.Disabled
                        FocusedBorderColor: =patternColor4.Fill
                        FocusedBorderThickness: =1
                        HoverBorderColor: =patternColor4.Fill
                        HoverFill: =ColorFade(patternColor3.Fill, 90%)
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =382
                        X: =211
                        Y: =txtContractLogActualOwner.Y + 50
                        ZIndex: =6

                    lblContractLogActualPhase As label:
                        Color: =labelSettings.Color
                        Font: =labelSettings.Font
                        Size: =labelSettings.Size
                        Text: =LookUp(StringsProcess,AppKey="lblPhase" && Language=SelectedLanguage,String)
                        Tooltip: =labelSettings.Tooltip
                        Width: =190
                        X: =lblContractLogActualOwner.X
                        Y: =lblContractLogActualOwner.Y + 50
                        ZIndex: =7

                    txtContractLogActualOwner As text:
                        BorderColor: =patternColor3.Fill
                        BorderThickness: =1
                        Default: |-
                            =//ContractSHPItem.DMSContractProcessActualOwner.DisplayName
                            ContractSHPItem.'Actual Owner Name'
                        DisabledColor: |-
                            =RGBA(0, 0, 0, 1)
                            //RGBA(166; 166; 166; 1)
                        DisplayMode: =DisplayMode.Disabled
                        FocusedBorderColor: =patternColor4.Fill
                        FocusedBorderThickness: =1
                        HoverBorderColor: =patternColor4.Fill
                        HoverFill: =ColorFade(patternColor3.Fill, 90%)
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =382
                        X: =211
                        Y: =lblContractLogActualOwner.Y
                        ZIndex: =8

                    lblContractLogActualOwner As label:
                        Color: =labelSettings.Color
                        Font: =labelSettings.Font
                        Size: =labelSettings.Size
                        Text: =LookUp(StringsProcess,AppKey="lblOwner" && Language=SelectedLanguage,String)
                        Tooltip: =labelSettings.Tooltip
                        Width: =190
                        X: =10
                        Y: =10
                        ZIndex: =9

                    txtContractLogEventDescription As text:
                        BorderColor: =If(txtContractLogEventDescription_validation,patternColor3.Fill,patternColor6.Fill)
                        BorderThickness: =1
                        Default: =""
                        DisplayMode: |-
                            =If(customFormMode = FormMode.Edit || customFormMode = FormMode.New,
                                DisplayMode.Edit,
                                DisplayMode.View
                            )
                        FocusedBorderColor: =patternColor4.Fill
                        FocusedBorderThickness: =1
                        Height: =140
                        HoverBorderColor: =patternColor4.Fill
                        HoverFill: =ColorFade(patternColor3.Fill, 90%)
                        Mode: =TextMode.MultiLine
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Tooltip: =
                        Width: =382
                        X: =211
                        Y: =txtContractLogActualOwner.Y + 150
                        ZIndex: =10

                    lblContractLogEventDescription As label:
                        Color: =labelSettings.Color
                        Font: =labelSettings.Font
                        Size: =labelSettings.Size
                        Text: =LookUp(StringsProcess,AppKey="lblOrdLogEventDescription" && Language=SelectedLanguage,String)
                        Tooltip: =
                        Width: =190
                        X: =10
                        Y: =lblContractLogActualOwner.Y + 150
                        ZIndex: =11

                ContractingParty As groupContainer:
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =620
                    Width: =606
                    ZIndex: =5

                    cbContractPartyCode1 As combobox:
                        BorderColor: =patternColor3.Fill
                        BorderThickness: =1
                        ChevronBackground: =
                        ChevronFill: =patternColor1.Fill
                        ChevronHoverBackground: =patternColor4.Fill
                        DefaultSelectedItems: =LookUp(DMSVendor,'ERP Code' = ContractSHPItem.DMSContractPartyCode1 && 'Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code')
                        DisabledColor: |-
                            =RGBA(0, 0, 0, 1)
                            //RGBA(166; 166; 166; 1)
                        DisplayFields: =["DMSVendorName"]
                        DisplayMode: |-
                            =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                                DisplayMode.Edit,
                                If(customFormMode = FormMode.Edit,
                                    DisplayMode.Disabled,
                                    DisplayMode.Disabled
                                )
                            )
                        FocusedBorderColor: =patternColor4.Fill
                        FocusedBorderThickness: =1
                        HoverBorderColor: =patternColor4.Fill
                        HoverFill: =ColorFade(patternColor3.Fill, 90%)
                        InputTextPlaceholder: =LookUp(StringsOrder,AppKey="findItems" && Language=SelectedLanguage,String)
                        Items: |-
                            =Sort(Filter(DMSVendor,('Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code') && StartsWith('Name (DMSVendorName)',Self.SearchText)),'Name (DMSVendorName)',Ascending)
                            
                            /*Filter(DMSVendor;'Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code')*/
                        SearchFields: =["DMSVendorName"]
                        SearchItems: |-
                            =Search(Sort(Filter(DMSVendor,('Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code') && StartsWith('Name (DMSVendorName)',Self.SearchText)),'Name (DMSVendorName)',Ascending)
                            
                            /*Filter(DMSVendor;'Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code')*/,cbContractPartyCode1.SearchText,"DMSVendorName")
                        SelectionColor: =White
                        SelectionFill: =patternColor4.Fill
                        SelectMultiple: =false
                        Tooltip: =
                        Width: =373
                        X: =231
                        ZIndex: =1

                    lblContractPartyCode1 As label:
                        Color: =labelSettings.Color
                        Font: =labelSettings.Font
                        Size: =labelSettings.Size
                        Text: =LookUp(StringsContract,AppKey="lblContractPartyCode1" && Language=SelectedLanguage,String)
                        Tooltip: =
                        Width: =190
                        X: =21
                        ZIndex: =2

                    txtContractPartyRegID1 As text:
                        BorderColor: =If(txtContractPartyRegID1_validation,patternColor3.Fill,patternColor6.Fill)
                        BorderThickness: =1
                        Default: |-
                            =If(!(IsEmpty(cbContractPartyCode1.SelectedItems) || IsBlank(cbContractPartyCode1.SelectedItems)),
                               First(cbContractPartyCode1.SelectedItems).'Registration ID',
                               ContractSHPItem.DMSContractPartyID1
                            )
                        DisabledColor: |-
                            =RGBA(0, 0, 0, 1)
                            //RGBA(166; 166; 166; 1)
                        DisplayMode: |-
                            =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                                DisplayMode.Edit,
                                If(customFormMode = FormMode.Edit,
                                    DisplayMode.Disabled,
                                    DisplayMode.Disabled
                                )
                            )
                        FocusedBorderColor: =patternColor4.Fill
                        FocusedBorderThickness: =1
                        HoverBorderColor: =patternColor4.Fill
                        HoverFill: =ColorFade(patternColor3.Fill, 90%)
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Tooltip: =
                        Width: =373
                        X: =231
                        Y: =47
                        ZIndex: =3

                    lblContractPartyRegID1 As label:
                        Color: =labelSettings.Color
                        Font: =labelSettings.Font
                        Size: =labelSettings.Size
                        Text: =LookUp(StringsContract,AppKey="lblContractPartyRegID1" && Language=SelectedLanguage,String) & If(customFormMode = FormMode.Edit," *","")
                        Tooltip: =
                        Width: =190
                        X: =21
                        Y: =47
                        ZIndex: =4

                    txtContractPartyName1 As text:
                        BorderColor: =If(txtContractPartyName1_validation,patternColor3.Fill,patternColor6.Fill)
                        BorderThickness: =1
                        Default: |-
                            =If(!(IsEmpty(cbContractPartyCode1.SelectedItems) || IsBlank(cbContractPartyCode1.SelectedItems)),
                               First(cbContractPartyCode1.SelectedItems).'Name (DMSVendorName)',
                               ContractSHPItem.'Contract Party 1'
                            )
                        DisabledColor: |-
                            =RGBA(0, 0, 0, 1)
                            //RGBA(166; 166; 166; 1)
                        DisplayMode: |-
                            =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                                DisplayMode.Edit,
                                If(customFormMode = FormMode.Edit,
                                    DisplayMode.Disabled,
                                    DisplayMode.Disabled
                                )
                            )
                        FocusedBorderColor: =patternColor4.Fill
                        FocusedBorderThickness: =1
                        HoverBorderColor: =patternColor4.Fill
                        HoverFill: =ColorFade(patternColor3.Fill, 90%)
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Tooltip: =
                        Width: =373
                        X: =231
                        Y: =100
                        ZIndex: =5

                    lblContractPartyName1 As label:
                        Color: =labelSettings.Color
                        Font: =labelSettings.Font
                        Size: =labelSettings.Size
                        Text: =LookUp(StringsContract,AppKey="lblContractPartyName1" && Language=SelectedLanguage,String) & If(customFormMode = FormMode.Edit," *","")
                        Tooltip: =
                        Width: =210
                        X: =21
                        Y: =100
                        ZIndex: =6

                    cbContractPartyCode2 As combobox:
                        BorderColor: =patternColor3.Fill
                        BorderThickness: =1
                        ChevronBackground: =
                        ChevronFill: =patternColor1.Fill
                        ChevronHoverBackground: =patternColor4.Fill
                        DefaultSelectedItems: =LookUp(DMSVendor,'ERP Code' = ContractSHPItem.DMSContractPartyCode2 && 'Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code')
                        DisabledColor: |-
                            =RGBA(0, 0, 0, 1)
                            //RGBA(166; 166; 166; 1)
                        DisplayFields: =["DMSVendorName"]
                        DisplayMode: |-
                            =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                                DisplayMode.Edit,
                                If(customFormMode = FormMode.Edit,
                                    DisplayMode.Disabled,
                                    DisplayMode.Disabled
                                )
                            )
                        FocusedBorderColor: =patternColor4.Fill
                        FocusedBorderThickness: =1
                        HoverBorderColor: =patternColor4.Fill
                        HoverFill: =ColorFade(patternColor3.Fill, 90%)
                        InputTextPlaceholder: =LookUp(StringsOrder,AppKey="findItems" && Language=SelectedLanguage,String)
                        Items: |-
                            =Sort(Filter(DMSVendor,('Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code') && StartsWith('Name (DMSVendorName)',Self.SearchText)),'Name (DMSVendorName)',Ascending)
                            
                            /*Filter(DMSVendor;'Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code')*/
                        SearchFields: =["DMSVendorName"]
                        SearchItems: |-
                            =Search(Sort(Filter(DMSVendor,('Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code') && StartsWith('Name (DMSVendorName)',Self.SearchText)),'Name (DMSVendorName)',Ascending)
                            
                            /*Filter(DMSVendor;'Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code')*/,cbContractPartyCode2.SearchText,"DMSVendorName")
                        SelectionColor: =White
                        SelectionFill: =patternColor4.Fill
                        SelectMultiple: =false
                        Tooltip: =
                        Width: =373
                        X: =231
                        Y: =151
                        ZIndex: =7

                    lblContractPartyCode2 As label:
                        Color: =labelSettings.Color
                        Font: =labelSettings.Font
                        Size: =labelSettings.Size
                        Text: =LookUp(StringsContract,AppKey="lblContractPartyCode2" && Language=SelectedLanguage,String)
                        Tooltip: =
                        Width: =190
                        X: =21
                        Y: =151
                        ZIndex: =8

                    txtContractPartyRegID2 As text:
                        BorderColor: =patternColor3.Fill
                        BorderThickness: =1
                        Default: |-
                            =If(!(IsEmpty(cbContractPartyCode2.SelectedItems) || IsBlank(cbContractPartyCode2.SelectedItems)),
                               First(cbContractPartyCode2.SelectedItems).'Registration ID',
                               ContractSHPItem.DMSContractPartyID2
                            )
                        DisabledColor: |-
                            =RGBA(0, 0, 0, 1)
                            //RGBA(166; 166; 166; 1)
                        DisplayMode: |-
                            =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                                DisplayMode.Edit,
                                If(customFormMode = FormMode.Edit,
                                    DisplayMode.Disabled,
                                    DisplayMode.Disabled
                                )
                            )
                        FocusedBorderColor: =patternColor4.Fill
                        FocusedBorderThickness: =1
                        HoverBorderColor: =patternColor4.Fill
                        HoverFill: =ColorFade(patternColor3.Fill, 90%)
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Tooltip: =
                        Width: =373
                        X: =231
                        Y: =198
                        ZIndex: =9

                    lblContractPartyRegID2 As label:
                        Color: =labelSettings.Color
                        Font: =labelSettings.Font
                        Size: =labelSettings.Size
                        Text: =LookUp(StringsContract,AppKey="lblContractPartyRegID2" && Language=SelectedLanguage,String)
                        Tooltip: =
                        Width: =190
                        X: =21
                        Y: =198
                        ZIndex: =10

                    txtContractPartyName2 As text:
                        BorderColor: =patternColor3.Fill
                        BorderThickness: =1
                        Default: |-
                            =If(!(IsEmpty(cbContractPartyCode2.SelectedItems) || IsBlank(cbContractPartyCode2.SelectedItems)),
                               First(cbContractPartyCode2.SelectedItems).'Name (DMSVendorName)',
                               ContractSHPItem.DMSContractPartyName2
                            )
                        DisabledColor: |-
                            =RGBA(0, 0, 0, 1)
                            //RGBA(166; 166; 166; 1)
                        DisplayMode: |-
                            =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                                DisplayMode.Edit,
                                If(customFormMode = FormMode.Edit,
                                    DisplayMode.Disabled,
                                    DisplayMode.Disabled
                                )
                            )
                        FocusedBorderColor: =patternColor4.Fill
                        FocusedBorderThickness: =1
                        HoverBorderColor: =patternColor4.Fill
                        HoverFill: =ColorFade(patternColor3.Fill, 90%)
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Tooltip: =
                        Width: =373
                        X: =231
                        Y: =251
                        ZIndex: =11

                    lblContractPartyName2 As label:
                        Color: =labelSettings.Color
                        Font: =labelSettings.Font
                        Size: =labelSettings.Size
                        Text: =LookUp(StringsContract,AppKey="lblContractPartyName2" && Language=SelectedLanguage,String)
                        Tooltip: =
                        Width: =190
                        X: =21
                        Y: =251
                        ZIndex: =12

                    cbContractPartyCode3 As combobox:
                        BorderColor: =patternColor3.Fill
                        BorderThickness: =1
                        ChevronBackground: =
                        ChevronFill: =patternColor1.Fill
                        ChevronHoverBackground: =patternColor4.Fill
                        DefaultSelectedItems: =LookUp(DMSVendor,'ERP Code' = ContractSHPItem.DMSContractPartyCode3 && 'Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code')
                        DisabledColor: |-
                            =RGBA(0, 0, 0, 1)
                            //RGBA(166; 166; 166; 1)
                        DisplayFields: =["DMSVendorName"]
                        DisplayMode: |-
                            =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                                DisplayMode.Edit,
                                If(customFormMode = FormMode.Edit,
                                    DisplayMode.Disabled,
                                    DisplayMode.Disabled
                                )
                            )
                        FocusedBorderColor: =patternColor4.Fill
                        FocusedBorderThickness: =1
                        HoverBorderColor: =patternColor4.Fill
                        HoverFill: =ColorFade(patternColor3.Fill, 90%)
                        InputTextPlaceholder: =LookUp(StringsOrder,AppKey="findItems" && Language=SelectedLanguage,String)
                        Items: |-
                            =Sort(Filter(DMSVendor,('Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code') && StartsWith('Name (DMSVendorName)',Self.SearchText)),'Name (DMSVendorName)',Ascending)
                            
                            /*Filter(DMSVendor;'Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code')*/
                        SearchFields: =["DMSVendorName"]
                        SearchItems: |-
                            =Search(Sort(Filter(DMSVendor,('Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code') && StartsWith('Name (DMSVendorName)',Self.SearchText)),'Name (DMSVendorName)',Ascending)
                            
                            /*Filter(DMSVendor;'Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code')*/,cbContractPartyCode3.SearchText,"DMSVendorName")
                        SelectionColor: =White
                        SelectionFill: =patternColor4.Fill
                        SelectMultiple: =false
                        Tooltip: =
                        Width: =373
                        X: =231
                        Y: =304
                        ZIndex: =13

                    lblContractPartyCode3 As label:
                        Color: =labelSettings.Color
                        Font: =labelSettings.Font
                        Size: =labelSettings.Size
                        Text: =LookUp(StringsContract,AppKey="lblContractPartyCode3" && Language=SelectedLanguage,String)
                        Tooltip: =
                        Width: =190
                        X: =22
                        Y: =304
                        ZIndex: =14

                    txtContractPartyRegID3 As text:
                        BorderColor: =patternColor3.Fill
                        BorderThickness: =1
                        Default: |-
                            =If(!(IsEmpty(cbContractPartyCode3.SelectedItems) || IsBlank(cbContractPartyCode3.SelectedItems)),
                               First(cbContractPartyCode3.SelectedItems).'Registration ID',
                               ContractSHPItem.DMSContractPartyID3
                            )
                        DisabledColor: |-
                            =RGBA(0, 0, 0, 1)
                            //RGBA(166; 166; 166; 1)
                        DisplayMode: |-
                            =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                                DisplayMode.Edit,
                                If(customFormMode = FormMode.Edit,
                                    DisplayMode.Disabled,
                                    DisplayMode.Disabled
                                )
                            )
                        FocusedBorderColor: =patternColor4.Fill
                        FocusedBorderThickness: =1
                        HoverBorderColor: =patternColor4.Fill
                        HoverFill: =ColorFade(patternColor3.Fill, 90%)
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Tooltip: =
                        Width: =373
                        X: =231
                        Y: =351
                        ZIndex: =15

                    lblContractPartyRegID3 As label:
                        Color: =labelSettings.Color
                        Font: =labelSettings.Font
                        Size: =labelSettings.Size
                        Text: =LookUp(StringsContract,AppKey="lblContractPartyRegID3" && Language=SelectedLanguage,String)
                        Tooltip: =
                        Width: =190
                        X: =22
                        Y: =351
                        ZIndex: =16

                    txtContractPartyName3 As text:
                        BorderColor: =patternColor3.Fill
                        BorderThickness: =1
                        Default: |-
                            =If(!(IsEmpty(cbContractPartyCode3.SelectedItems) || IsBlank(cbContractPartyCode3.SelectedItems)),
                               First(cbContractPartyCode3.SelectedItems).'Name (DMSVendorName)',
                               ContractSHPItem.DMSContractPartyName3
                            )
                        DisabledColor: |-
                            =RGBA(0, 0, 0, 1)
                            //RGBA(166; 166; 166; 1)
                        DisplayMode: |-
                            =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                                DisplayMode.Edit,
                                If(customFormMode = FormMode.Edit,
                                    DisplayMode.Disabled,
                                    DisplayMode.Disabled
                                )
                            )
                        FocusedBorderColor: =patternColor4.Fill
                        FocusedBorderThickness: =1
                        HoverBorderColor: =patternColor4.Fill
                        HoverFill: =ColorFade(patternColor3.Fill, 90%)
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Tooltip: =
                        Width: =373
                        X: =231
                        Y: =404
                        ZIndex: =17

                    lblContractPartyName3 As label:
                        Color: =labelSettings.Color
                        Font: =labelSettings.Font
                        Size: =labelSettings.Size
                        Text: =LookUp(StringsContract,AppKey="lblContractPartyName3" && Language=SelectedLanguage,String)
                        Tooltip: =
                        Width: =190
                        X: =22
                        Y: =404
                        ZIndex: =18

                    cbContractPartyCode4 As combobox:
                        BorderColor: =patternColor3.Fill
                        BorderThickness: =1
                        ChevronBackground: =
                        ChevronFill: =patternColor1.Fill
                        ChevronHoverBackground: =patternColor4.Fill
                        DefaultSelectedItems: =LookUp(DMSVendor,'ERP Code' = ContractSHPItem.DMSContractPartyCode4 && 'Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code')
                        DisabledColor: |-
                            =RGBA(0, 0, 0, 1)
                            //RGBA(166; 166; 166; 1)
                        DisplayFields: =["DMSVendorName"]
                        DisplayMode: |-
                            =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                                DisplayMode.Edit,
                                If(customFormMode = FormMode.Edit,
                                    DisplayMode.Disabled,
                                    DisplayMode.Disabled
                                )
                            )
                        FocusedBorderColor: =patternColor4.Fill
                        FocusedBorderThickness: =1
                        HoverBorderColor: =patternColor4.Fill
                        HoverFill: =ColorFade(patternColor3.Fill, 90%)
                        InputTextPlaceholder: =LookUp(StringsOrder,AppKey="findItems" && Language=SelectedLanguage,String)
                        Items: |-
                            =Sort(Filter(DMSVendor,('Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code') && StartsWith('Name (DMSVendorName)',Self.SearchText)),'Name (DMSVendorName)',Ascending)
                            
                            /*Filter(DMSVendor;'Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code')*/
                        SearchFields: =["DMSVendorName"]
                        SearchItems: |-
                            =Search(Sort(Filter(DMSVendor,('Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code') && StartsWith('Name (DMSVendorName)',Self.SearchText)),'Name (DMSVendorName)',Ascending)
                            
                            /*Filter(DMSVendor;'Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code')*/,cbContractPartyCode4.SearchText,"DMSVendorName")
                        SelectionColor: =White
                        SelectionFill: =patternColor4.Fill
                        SelectMultiple: =false
                        Tooltip: =
                        Width: =373
                        X: =231
                        Y: =456
                        ZIndex: =19

                    lblContractPartyCode4 As label:
                        Color: =labelSettings.Color
                        Font: =labelSettings.Font
                        Size: =labelSettings.Size
                        Text: =LookUp(StringsContract,AppKey="lblContractPartyCode4" && Language=SelectedLanguage,String)
                        Tooltip: =
                        Width: =190
                        X: =22
                        Y: =456
                        ZIndex: =20

                    txtContractPartyRegID4 As text:
                        BorderColor: =patternColor3.Fill
                        BorderThickness: =1
                        Default: |-
                            =If(!(IsEmpty(cbContractPartyCode4.SelectedItems) || IsBlank(cbContractPartyCode4.SelectedItems)),
                               First(cbContractPartyCode4.SelectedItems).'Registration ID',
                               ContractSHPItem.DMSContractPartyID4
                            )
                        DisabledColor: |-
                            =RGBA(0, 0, 0, 1)
                            //RGBA(166; 166; 166; 1)
                        DisplayMode: |-
                            =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                                DisplayMode.Edit,
                                If(customFormMode = FormMode.Edit,
                                    DisplayMode.Disabled,
                                    DisplayMode.Disabled
                                )
                            )
                        FocusedBorderColor: =patternColor4.Fill
                        FocusedBorderThickness: =1
                        HoverBorderColor: =patternColor4.Fill
                        HoverFill: =ColorFade(patternColor3.Fill, 90%)
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Tooltip: =
                        Width: =373
                        X: =231
                        Y: =503
                        ZIndex: =21

                    lblContractPartyRegID4 As label:
                        Color: =labelSettings.Color
                        Font: =labelSettings.Font
                        Size: =labelSettings.Size
                        Text: =LookUp(StringsContract,AppKey="lblContractPartyRegID4" && Language=SelectedLanguage,String)
                        Tooltip: =
                        Width: =190
                        X: =22
                        Y: =503
                        ZIndex: =22

                    txtContractPartyName4 As text:
                        BorderColor: =patternColor3.Fill
                        BorderThickness: =1
                        Default: |-
                            =If(!(IsEmpty(cbContractPartyCode4.SelectedItems) || IsBlank(cbContractPartyCode4.SelectedItems)),
                               First(cbContractPartyCode4.SelectedItems).'Name (DMSVendorName)',
                               ContractSHPItem.DMSContractPartyName4
                            )
                        DisabledColor: |-
                            =RGBA(0, 0, 0, 1)
                            //RGBA(166; 166; 166; 1)
                        DisplayMode: |-
                            =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                                DisplayMode.Edit,
                                If(customFormMode = FormMode.Edit,
                                    DisplayMode.Disabled,
                                    DisplayMode.Disabled
                                )
                            )
                        FocusedBorderColor: =patternColor4.Fill
                        FocusedBorderThickness: =1
                        HoverBorderColor: =patternColor4.Fill
                        HoverFill: =ColorFade(patternColor3.Fill, 90%)
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Tooltip: =
                        Width: =373
                        X: =231
                        Y: =556
                        ZIndex: =23

                    lblContractPartyName4 As label:
                        Color: =labelSettings.Color
                        Font: =labelSettings.Font
                        Size: =labelSettings.Size
                        Text: =LookUp(StringsContract,AppKey="lblContractPartyName4" && Language=SelectedLanguage,String)
                        Tooltip: =
                        Width: =190
                        X: =22
                        Y: =556
                        ZIndex: =24

            leftColumnContract As groupContainer:
                Fill: =Transparent
                Height: =1606
                Width: =733
                X: =0*0
                ZIndex: =2

                txtContractReason As text:
                    BorderColor: =If(txtContractReason_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    Default: =ContractSHPItem.Reason
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    Height: =140
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    Mode: =TextMode.MultiLine
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =
                    Width: =484
                    X: =cbContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 12 * 50
                    ZIndex: =3

                lblContractReason As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractReason" && Language=SelectedLanguage,String)
                    Tooltip: =
                    Width: =190
                    X: =lblContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 12 * 50
                    ZIndex: =4

                cbContractLegalEntity As combobox:
                    BorderColor: =If(cbContractLegalEntity_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    ChevronBackground: =
                    ChevronFill: =patternColor1.Fill
                    ChevronHoverBackground: =patternColor4.Fill
                    DefaultSelectedItems: |-
                        =If(customFormMode = FormMode.New,
                            LookUp(DMSLegalEntity, 'Legal Entity Code' = CurrentLegalEntity),
                            LookUp(DMSLegalEntity, 'Legal Entity Code' = ContractSHPItem.'Legal Entity Code')
                        )
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisplayFields: =["DMSLegalEntityName"]
                    DisplayMode: |-
                        =If(/*(customFormMode = FormMode.Edit && ContractSHPItem.DMSContractProcessActualPhase = "10") ||*/ customFormMode = FormMode.New,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    InputTextPlaceholder: =LookUp(StringsOrder,AppKey="findItems" && Language=SelectedLanguage,String)
                    Items: =DMSLegalEntity
                    SearchFields: =["DMSLegalEntityName"]
                    SearchItems: =Search(DMSLegalEntity,cbContractLegalEntity.SearchText,"DMSLegalEntityName")
                    SelectionColor: =White
                    SelectionFill: =patternColor4.Fill
                    SelectMultiple: =false
                    Tooltip: =
                    Width: =484
                    X: =238
                    ZIndex: =5

                lblContractLegalEntity As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractLegalEntity" && Language=SelectedLanguage,String) & " *"
                    Tooltip: =
                    Width: =190
                    X: =40
                    ZIndex: =6

                cbContractDepartment As combobox:
                    BorderColor: =If(cbContractDepartment_validation && budgetOwner_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    ChevronBackground: =
                    ChevronFill: =patternColor1.Fill
                    ChevronHoverBackground: =patternColor4.Fill
                    Default: =LookUp(DMSDepartment,'Cost Center Code'=ContractSHPItem.DMSContractDepartmentCode)
                    DefaultSelectedItems: =LookUp(DMSDepartment,'Cost Center Code' = ContractSHPItem.DMSContractDepartmentCode && 'Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code')
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisplayFields: =["DMSDepartmentName"]
                    DisplayMode: |-
                        =If(/*(customFormMode = FormMode.Edit && ContractSHPItem.DMSContractProcessActualPhase = "10") ||*/ customFormMode = FormMode.New,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    InputTextPlaceholder: =LookUp(StringsOrder,AppKey="findItems" && Language=SelectedLanguage,String)
                    Items: =Filter(DMSDepartment,'Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code')
                    OnChange: |-
                        =If(
                            IsBlank(LookUp(Office365Users.SearchUserV2().value, Mail = First(Self.SelectedItems).'Budget Owner'.Email).Mail),
                            UpdateContext({budgetOwner_validation: false});
                            Notify(LookUp(StringsContract,AppKey="BudgetOwnerValidationFault" && Language=SelectedLanguage,String),NotificationType.Error),
                            UpdateContext({budgetOwner_validation: true})
                        )
                    SearchFields: =["DMSDepartmentName"]
                    SearchItems: =Search(Filter(DMSDepartment,'Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code'),cbContractDepartment.SearchText,"DMSDepartmentName")
                    SelectionColor: =White
                    SelectionFill: =patternColor4.Fill
                    SelectMultiple: =false
                    Tooltip: =
                    Width: =484
                    X: =cbContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 1 * 50
                    ZIndex: =7

                lblContractDepartment As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractDepartment" && Language=SelectedLanguage,String) & " *"
                    Tooltip: =
                    Width: =190
                    X: =lblContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 1 * 50
                    ZIndex: =8

                cbContractOwner As combobox:
                    BorderColor: =If(cbContractOwner_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    ChevronBackground: =
                    ChevronFill: =patternColor1.Fill
                    ChevronHoverBackground: =patternColor4.Fill
                    DefaultSelectedItems: |
                        =If(customFormMode = FormMode.New,
                            First(Filter(ShowColumns(Office365Users.SearchUser({searchTerm:"",top: 999}),"DisplayName","Mail"),Mail = User().Email)),
                            First(Filter(ShowColumns(Office365Users.SearchUser({searchTerm:"",top: 999}),"DisplayName","Mail"),Mail = First(ContractSHPItem.'Contract Owner').Email))
                        )
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisplayFields: =["DisplayName","Mail"]
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    InputTextPlaceholder: =LookUp(StringsOrder,AppKey="findItems" && Language=SelectedLanguage,String)
                    Items: |-
                        =ShowColumns(Office365Users.SearchUser({searchTerm:"",top: 999}),"DisplayName","Mail")
                    PressedColor: =White
                    SearchFields: =["DisplayName"]
                    SearchItems: |-
                        =Search(ShowColumns(Office365Users.SearchUser({searchTerm:"",top: 999}),"DisplayName","Mail"),cbContractOwner.SearchText,"DisplayName")
                    SelectionColor: =White
                    SelectionFill: =patternColor4.Fill
                    SelectMultiple: =false
                    Tooltip: =
                    Width: =484
                    X: =cbContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 11 * 50
                    ZIndex: =9

                lblContractOwner As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractOwner" && Language=SelectedLanguage,String) & If(customFormMode = FormMode.Edit," *","")
                    Tooltip: =
                    Width: =190
                    X: =lblContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 11 * 50
                    ZIndex: =10

                txtContractDescription As text:
                    BorderColor: =If(txtContractDescription_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    Default: =ContractSHPItem.'Contract Title'
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisplayMode: |-
                        =If(/*(customFormMode = FormMode.Edit && ContractSHPItem.DMSContractProcessActualPhase = "10") ||*/ customFormMode = FormMode.New,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =
                    Width: =484
                    X: =cbContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 2 * 50
                    ZIndex: =14

                lblContractDescription As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractDescription" && Language=SelectedLanguage,String) & " *"
                    Tooltip: =
                    Width: =190
                    X: =lblContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 2 * 50
                    ZIndex: =15

                lblContractDateSent As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractDateSent" && Language=SelectedLanguage,String)
                    Tooltip: =
                    Width: =190
                    X: =lblContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 8 * 50
                    ZIndex: =16

                txtContractNumber As text:
                    BorderColor: =If(txtContractNumber_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    Default: |
                        =/*If(customFormMode = FormMode.New,
                          "CON" &  Text(First(Sort(DMSContract.ID,ID,Descending)).ID + 1,"[$-en-US]000000"),
                          ContractSHPItem.DMSContractNumber
                        )*/
                        
                        If(!(customFormMode = FormMode.New) && IsBlank(ContractSHPItem.Contract),
                          "CON" &  Text(ContractSHPItem.ID,"[$-en-US]000000"),
                          ContractSHPItem.Contract
                        )
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisplayMode: |-
                        =DisplayMode.Disabled
                        
                        /*If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*//*;
                            DisplayMode.Edit;
                            If(customFormMode = FormMode.Edit;
                                DisplayMode.Disabled;
                                DisplayMode.Disabled
                            )
                        )*/
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =
                    Width: =484
                    X: =cbContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 3 * 50
                    ZIndex: =17

                lblContractNumber As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractNumber" && Language=SelectedLanguage,String) & If(customFormMode = FormMode.Edit," *","")
                    Tooltip: =
                    Width: =190
                    X: =lblContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 3 * 50
                    ZIndex: =18

                lblContractAmendment As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =If(cbContractAmendment,LookUp(StringsContract,AppKey="lblContractAmendment" && Language=SelectedLanguage,String) & " *",LookUp(StringsContract,AppKey="lblContractAmendment" && Language=SelectedLanguage,String))
                    Tooltip: =
                    Width: =190
                    X: =lblContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 4 * 50
                    ZIndex: =20

                cbContractAmendment As checkbox:
                    CheckboxBackgroundFill: =White
                    CheckboxBorderColor: =patternColor1.Fill
                    CheckmarkFill: =patternColor1.Fill
                    Default: =ContractSHPItem.DMSContractAmendment
                    DisplayMode: |-
                        =If(/*(customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") ||*/ customFormMode = FormMode.New,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderThickness: =0
                    Height: =40
                    OnSelect: =
                    OnUncheck: |-
                        =Reset(cbContractAmendmentContract);
                        Reset(cbContractAmendmentType);
                    Text: =""
                    Width: =40
                    X: =cbContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 4 * 50
                    ZIndex: =28

                txtContractAmendment As text:
                    BorderColor: =If(txtContractAmendment_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    Default: =If(customFormMode = FormMode.New,0,ContractSHPItem.DMSContractAmendmentNum)
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisplayMode: |-
                        =DisplayMode.Disabled
                        
                        /*If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*//*;
                            DisplayMode.Edit;
                            If(customFormMode = FormMode.Edit;
                                DisplayMode.Disabled;
                                DisplayMode.Disabled
                            )
                        )*/
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =
                    Width: =60
                    X: =662
                    Y: =cbContractLegalEntity.Y + 4 * 50
                    ZIndex: =29

                lblContractDateReceived As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractDateReceived" && Language=SelectedLanguage,String)
                    Tooltip: =
                    Width: =190
                    X: =lblContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 9 * 50
                    ZIndex: =30

                lblContractDateOfSignature As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractDateOfSignature" && Language=SelectedLanguage,String)
                    Tooltip: =
                    Width: =190
                    X: =lblContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 10 * 50
                    ZIndex: =32

                lblContractInBudget As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractInBudget" && Language=SelectedLanguage,String)
                    Tooltip: =labelSettings.Tooltip
                    Width: =171
                    X: =lblContractLegalEntity.X
                    Y: =745
                    ZIndex: =34

                cbContractInBudget As checkbox:
                    CheckboxBackgroundFill: =White
                    CheckboxBorderColor: =patternColor1.Fill
                    CheckmarkFill: =patternColor1.Fill
                    Default: =ContractSHPItem.'In Budget'
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderThickness: =0
                    Height: =40
                    OnSelect: =
                    Text: =
                    Width: =40
                    X: =cbContractLegalEntity.X
                    Y: =745
                    ZIndex: =35

                lblContractReservedMatters As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractReservedMatters" && Language=SelectedLanguage,String)
                    Tooltip: =labelSettings.Tooltip
                    Width: =171
                    X: =lblContractLegalEntity.X
                    Y: =785
                    ZIndex: =36

                cbContractReservedMatters As checkbox:
                    CheckboxBackgroundFill: =White
                    CheckboxBorderColor: =patternColor1.Fill
                    CheckmarkFill: =patternColor1.Fill
                    Default: =ContractSHPItem.'Reserved Matters'
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderThickness: =0
                    Height: =40
                    OnSelect: =
                    Text: =""
                    Width: =40
                    X: =cbContractLegalEntity.X
                    Y: =785
                    ZIndex: =37

                lblContractDuration As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractDuration" && Language=SelectedLanguage,String)
                    Tooltip: =labelSettings.Tooltip
                    Width: =171
                    X: =40
                    Y: =829
                    ZIndex: =38

                lblContractDateOfExpiration As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractDateOfExpiration" && Language=SelectedLanguage,String)
                    Tooltip: =
                    Width: =190
                    X: =40
                    Y: =879
                    ZIndex: =40

                lblContractTerminationWithoutReason As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractTerminationWithoutReason" && Language=SelectedLanguage,String)
                    Tooltip: =labelSettings.Tooltip
                    Width: =190
                    X: =lblContractLegalEntity.X
                    Y: =971
                    ZIndex: =42

                cbContractTerminationWithoutReason As checkbox:
                    CheckboxBackgroundFill: =White
                    CheckboxBorderColor: =patternColor1.Fill
                    CheckmarkFill: =patternColor1.Fill
                    Default: =ContractSHPItem.DMSContractTerminationWithoutReason
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderThickness: =0
                    Height: =40
                    OnSelect: =
                    Text: =ContractSHPItem.DMSContractTerminationWithoutReason
                    Width: =40
                    X: =cbContractLegalEntity.X
                    Y: =971
                    ZIndex: =43

                txtContractTerminationPeriodMonths As text:
                    BorderColor: =If(txtContractTerminationPeriodMonths_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    Default: =ContractSHPItem.DMSContractTerminationPeriodMonths
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    Format: =TextFormat.Number
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =
                    Width: =201
                    X: =521
                    Y: =966
                    ZIndex: =44

                lblContractTerminationPeriodMonths As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractTerminationPeriodMonths" && Language=SelectedLanguage,String)
                    Tooltip: =
                    Width: =187
                    X: =318
                    Y: =966
                    ZIndex: =45

                lblContractLiabilityLimit As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractLiabilityLimit" && Language=SelectedLanguage,String)
                    Tooltip: =labelSettings.Tooltip
                    Width: =190
                    X: =lblContractLegalEntity.X
                    Y: =1018
                    ZIndex: =46

                cbContractLiabilityLimit As checkbox:
                    CheckboxBackgroundFill: =White
                    CheckboxBorderColor: =patternColor1.Fill
                    CheckmarkFill: =patternColor1.Fill
                    Default: =ContractSHPItem.'Liability Limit'
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderThickness: =0
                    Height: =40
                    OnSelect: =
                    Text: =ContractSHPItem.'Liability Limit'
                    Width: =40
                    X: =cbContractLegalEntity.X
                    Y: =1018
                    ZIndex: =47

                txtContractLiabilityLimitValue As text:
                    BorderColor: =If(txtContractLiabilityLimitValue_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    Default: =ContractSHPItem.DMSContractLiabilityLimitValue
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    Format: =TextFormat.Number
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =
                    Width: =201
                    X: =521
                    Y: =1018
                    ZIndex: =48

                lblContractLiabilityLimitValue As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractLiabilityLimitValue" && Language=SelectedLanguage,String)
                    Tooltip: =
                    Width: =187
                    X: =318
                    Y: =1018
                    ZIndex: =49

                txtContractFinValueLocalCurrency As text:
                    Align: =Align.Right
                    BorderColor: =If(txtContractFinValueLocalCurrency_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    Default: =Value(txtContractFinValue.Text) * Value(txtContractFinValueExchRate.Text)
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisabledFill: =If(txtContractFinValueLocalCurrency_validation,RGBA(244, 244, 244, 1),ColorFade(patternColor6.Fill,0.6))
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") || customFormMode = FormMode.New,
                            DisplayMode.Disabled,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    Format: =TextFormat.Number
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =
                    Width: =120
                    X: =cbContractLegalEntity.X
                    Y: =1120
                    ZIndex: =50

                lblContractFinValueLocalCurrency As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractFinValueLocalCurrency" && Language=SelectedLanguage,String)
                    Tooltip: =
                    Width: =190
                    X: =lblContractLegalEntity.X
                    Y: =1120
                    ZIndex: =51

                txtContractFinValue As text:
                    Align: =Align.Right
                    BorderColor: =If(txtContractFinValue_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    Default: |-
                        =If(
                                customFormMode = FormMode.New,
                                0,
                                ContractSHPItem.'Financial Value'
                        )
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    Format: =TextFormat.Number
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =
                    Width: =120
                    X: =cbContractLegalEntity.X
                    Y: =1069
                    ZIndex: =52

                lblContractFinValue As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractFinValue" && Language=SelectedLanguage,String) &  If(customFormMode = FormMode.Edit," *","")
                    Tooltip: =
                    Width: =190
                    X: =lblContractLegalEntity.X
                    Y: =1069
                    ZIndex: =53

                txtContractFinValueExchRate As text:
                    BorderColor: =If(txtContractFinValueExchRate_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    Default: |-
                        =//If(customFormMode = FormMode.New, 1, ContractSHPItem.DMSContractFinValueExchRate)
                        
                        If(
                            IsBlank(ContractSHPItem.'Contract Exchange Rate'),
                            LookUp(
                                DMSCurrency,
                                'Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code' && Currency = First(cbContractFinValueCurrency.SelectedItems).Currency
                            ).'Exchange Rate',
                            ContractSHPItem.'Contract Exchange Rate'
                        )
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =
                    Width: =201
                    X: =521
                    Y: =1120
                    ZIndex: =54

                lblContractFinValueExchRate As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractFinValueExchRate" && Language=SelectedLanguage,String) &  If(customFormMode = FormMode.Edit," *","")
                    Tooltip: =
                    Width: =147
                    X: =367
                    Y: =1120
                    ZIndex: =55

                cbContractFinValueCurrency As combobox:
                    BorderColor: =If(cbContractFinValueCurrency_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    ChevronBackground: =
                    ChevronFill: =patternColor1.Fill
                    ChevronHoverBackground: =patternColor4.Fill
                    DefaultSelectedItems: =LookUp(DMSCurrency,Currency=ContractSHPItem.'Contract Currency'  && 'Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code')
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisplayFields: =["DMSCurrencyCode"]
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    InputTextPlaceholder: =LookUp(StringsOrder,AppKey="findItems" && Language=SelectedLanguage,String)
                    IsSearchable: =false
                    Items: =Filter(DMSCurrency,'Legal Entity Code' = First(cbContractLegalEntity.SelectedItems).'Legal Entity Code')
                    SearchFields: =["DMSCurrencyCode"]
                    SearchItems: =[]
                    SelectionColor: =White
                    SelectionFill: =patternColor4.Fill
                    SelectMultiple: =false
                    Tooltip: =
                    Width: =201
                    X: =521
                    Y: =1069
                    ZIndex: =56

                lblContractFinValueCurrency As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Height: =39
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractFinValueCurrency" && Language=SelectedLanguage,String) &  If(customFormMode = FormMode.Edit," *","")
                    Tooltip: =
                    Width: =147
                    X: =367
                    Y: =1070
                    ZIndex: =57

                txtContractSubject As text:
                    BorderColor: =If(txtContractSubject_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    Default: =ContractSHPItem.'Contract Subject'
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    Height: =140
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    Mode: =TextMode.MultiLine
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =
                    Width: =484
                    X: =cbContractLegalEntity.X
                    Y: =1181
                    ZIndex: =58

                lblContractSubject As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractSubject" && Language=SelectedLanguage,String)
                    Tooltip: =
                    Width: =190
                    X: =lblContractLegalEntity.X
                    Y: =1181
                    ZIndex: =59

                txtContractNotes As text:
                    BorderColor: =If(txtContractNotes_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    Default: =ContractSHPItem.DMSContractNotes
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    Height: =140
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    Mode: =TextMode.MultiLine
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =
                    Width: =484
                    X: =cbContractLegalEntity.X
                    Y: =1335
                    ZIndex: =60

                lblContractNotes As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractNotes" && Language=SelectedLanguage,String)
                    Tooltip: =
                    Width: =190
                    X: =lblContractLegalEntity.X
                    Y: =1335
                    ZIndex: =61

                txtContractPrintsNumberHEU As text:
                    BorderColor: =If(txtContractPrintsNumberHEU_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    Default: =ContractSHPItem.DMSContractPrintsNumberHEU
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    Format: =TextFormat.Number
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =
                    Width: =117
                    X: =524
                    Y: =1489
                    ZIndex: =62

                txtContractPrintsNumberTotal As text:
                    BorderColor: =patternColor6.Fill
                    BorderThickness: =1
                    Default: =Value(txtContractPrintsNumberHEU.Text) + Value(txtContractPrintsNumberOther.Text)
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") || customFormMode = FormMode.New,
                            DisplayMode.View,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.View,
                                DisplayMode.View
                            )
                        )
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    Format: =TextFormat.Number
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =
                    Width: =112
                    X: =cbContractLegalEntity.X
                    Y: =1488
                    ZIndex: =63

                lblContractPrintsNumberTotal As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractPrintsNumberTotal" && Language=SelectedLanguage,String)
                    Tooltip: =
                    Width: =190
                    X: =lblContractLegalEntity.X
                    Y: =1488
                    ZIndex: =64

                lblContractPrintsNumberOther As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractPrintsNumberOther" && Language=SelectedLanguage,String)
                    Tooltip: =
                    Width: =157
                    X: =367
                    Y: =1545
                    ZIndex: =65

                lblContractPrintsNumberHEU As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractPrintsNumberHEU" && Language=SelectedLanguage,String)
                    Tooltip: =
                    Width: =157
                    X: =367
                    Y: =1489
                    ZIndex: =66

                txtContractPrintsNumberOther As text:
                    BorderColor: =If(txtContractPrintsNumberOther_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    Default: =ContractSHPItem.DMSContractPrintsNumberOther
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    Format: =TextFormat.Number
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =
                    Width: =117
                    X: =524
                    Y: =1545
                    ZIndex: =67

                cbContractDuration As combobox:
                    BorderColor: =If(cbContractDuration_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    ChevronBackground: =
                    ChevronFill: =patternColor1.Fill
                    ChevronHoverBackground: =patternColor4.Fill
                    Default: =ContractSHPItem.DMSContractDuration
                    DefaultSelectedItems: =ContractSHPItem.DMSContractDuration
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisplayFields: =["Value"]
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    InputTextPlaceholder: =LookUp(StringsOrder,AppKey="findItems" && Language=SelectedLanguage,String)
                    IsSearchable: =false
                    Items: =Choices([@DMSContract].DMSContractDuration)
                    SearchFields: =["Value"]
                    SearchItems: =[]
                    SelectionColor: =White
                    SelectionFill: =patternColor4.Fill
                    SelectMultiple: =false
                    Tooltip: =
                    Width: =484
                    X: =cbContractLegalEntity.X
                    Y: =829
                    ZIndex: =68

                lblContractAutomaticRenewal As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractAutomaticRenewal" && Language=SelectedLanguage,String)
                    Tooltip: =labelSettings.Tooltip
                    Width: =190
                    X: =40
                    Y: =928
                    ZIndex: =69

                cbContractAutomaticRenewal As checkbox:
                    CheckboxBackgroundFill: =White
                    CheckboxBorderColor: =patternColor1.Fill
                    CheckmarkFill: =patternColor1.Fill
                    Default: =ContractSHPItem.DMSContractAutomaticRenewal
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderThickness: =0
                    Height: =40
                    OnSelect: =
                    Text: =ContractSHPItem.DMSContractAutomaticRenewal
                    Width: =40
                    X: =238
                    Y: =928
                    ZIndex: =70

                dpContractDateSent_background As datepicker:
                    BorderColor: =patternColor3.Fill
                    BorderThickness: =1
                    DefaultDate: =
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "100"),
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    Fill: =RGBA(237, 237, 237, 1)
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    IconBackground: =RGBA(237, 237, 237, 1)
                    IconFill: =Transparent
                    InputTextPlaceholder: =
                    Tooltip: =
                    Width: =484
                    X: =238
                    Y: =399
                    ZIndex: =71

                "dpContractDateSent As 'Date picker'":
                    AcceptsFocus: =false
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "100"),
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    Font: =Font.'Open Sans'
                    FontSize: =14
                    FontWeight: ="normal"
                    Height: =39
                    IconSize: =16
                    InitialPickerDate: =
                    PaddingBottom: =0
                    PaddingTop: =0
                    PCFTeamsTheme: =TeamsTheme.Default
                    ShowGoToToday: =false
                    Value: |-
                        =If(customFormMode = FormMode.New,
                            Today(),
                            ContractSHPItem.DMSContractDateSent
                        )
                    Visible: =true
                    Width: =483
                    X: =cbContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 8 * 50
                    ZIndex: =72

                dpContractDateOfExpiration_background As datepicker:
                    BorderColor: =If(dpContractDateOfExpiration_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    DefaultDate: =
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") || customFormMode = FormMode.New,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    Fill: =RGBA(237, 237, 237, 1)
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    IconBackground: =RGBA(237, 237, 237, 1)
                    IconFill: =Transparent
                    InputTextPlaceholder: =
                    Tooltip: =
                    Width: =484
                    X: =238
                    Y: =879
                    ZIndex: =73

                "dpContractDateOfExpiration As 'Date picker'":
                    AcceptsFocus: =false
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") /*|| customFormMode = FormMode.New*/,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    Font: =Font.'Open Sans'
                    FontSize: =14
                    FontWeight: ="normal"
                    Height: =39
                    IconSize: =16
                    InitialPickerDate: =
                    PaddingBottom: =0
                    PaddingTop: =0
                    PCFTeamsTheme: =TeamsTheme.Default
                    ShowGoToToday: =false
                    Value: |-
                        =If(customFormMode = FormMode.New,
                            Today(),
                            ContractSHPItem.'Date of Expiration'
                        )
                    Visible: =true
                    Width: =483
                    X: =239
                    Y: =880
                    ZIndex: =74

                dpContractDateReceived_background As datepicker:
                    BorderColor: |-
                        =//If(dpOrderDate_validation,patternColor3.Fill,patternColor6.Fill)
                        patternColor3.Fill
                    BorderThickness: =1
                    DefaultDate: =
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "100"),
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    Fill: =RGBA(237, 237, 237, 1)
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    IconBackground: =RGBA(237, 237, 237, 1)
                    IconFill: =Transparent
                    InputTextPlaceholder: =
                    Tooltip: =
                    Width: =484
                    X: =238
                    Y: =449
                    ZIndex: =75

                "dpContractDateReceived As 'Date picker'":
                    AcceptsFocus: =false
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "100"),
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    Font: =Font.'Open Sans'
                    FontSize: =14
                    FontWeight: ="normal"
                    Height: =39
                    IconSize: =16
                    InitialPickerDate: =
                    PaddingBottom: =0
                    PaddingTop: =0
                    PCFTeamsTheme: =TeamsTheme.Default
                    ShowGoToToday: =false
                    Value: |-
                        =If(customFormMode = FormMode.New,
                            Today(),
                            ContractSHPItem.DMSContractDateReceived
                        )
                    Visible: =true
                    Width: =483
                    X: =cbContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 9 * 50
                    ZIndex: =76

                dpContractDateOfSignature_background As datepicker:
                    BorderColor: |-
                        =//If(dpOrderDate_validation,patternColor3.Fill,patternColor6.Fill)
                        patternColor3.Fill
                    BorderThickness: =1
                    DefaultDate: =
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "100"),
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    Fill: =RGBA(237, 237, 237, 1)
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    IconBackground: =RGBA(237, 237, 237, 1)
                    IconFill: =Transparent
                    InputTextPlaceholder: =
                    Tooltip: =
                    Width: =484
                    X: =238
                    Y: =499
                    ZIndex: =77

                "dpContractDateOfSignature As 'Date picker'":
                    AcceptsFocus: =false
                    DisplayMode: |-
                        =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "100"),
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    Font: =Font.'Open Sans'
                    FontSize: =14
                    FontWeight: ="normal"
                    Height: =39
                    IconSize: =16
                    InitialPickerDate: =
                    PaddingBottom: =0
                    PaddingTop: =0
                    PCFTeamsTheme: =TeamsTheme.Default
                    ShowGoToToday: =false
                    Value: |-
                        =If(customFormMode = FormMode.New,
                            Today(),
                            ContractSHPItem.DMSContractDateOfSignature
                        )
                    Visible: =true
                    Width: =483
                    X: =cbContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 10 * 50
                    ZIndex: =78

                lblContractInternalNumber As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblInternalNumber" && Language=SelectedLanguage,String) & " *"
                    Tooltip: =
                    Width: =190
                    X: =lblContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 5 * 50
                    ZIndex: =79

                lblContractMainContractYear As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblMainContractYear" && Language=SelectedLanguage,String) & " *"
                    Tooltip: =
                    Width: =190
                    X: =lblContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 6 * 50
                    ZIndex: =80

                lblContractConIdentification As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractIdentification" && Language=SelectedLanguage,String)
                    Tooltip: =
                    Width: =190
                    X: =lblContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 7 * 50
                    ZIndex: =81

                txtContractInternalNumber As text:
                    BorderColor: =If(txtContractInternalNumber_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    Default: =ContractSHPItem.DMSContractInternalNumber
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisplayMode: |-
                        =If(/*(customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") ||*/ customFormMode = FormMode.New,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =
                    Width: =484
                    X: =cbContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 5 * 50
                    ZIndex: =82

                txtContractMainContractYear As text:
                    BorderColor: =If(txtContractMainContractYear_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    Default: |-
                        =If(
                            (customFormMode = FormMode.New) /*&& IsBlank(ContractSHPItem.Contract)*/,
                            Text(
                                LookUp(
                                    DMSContract,
                                    Contract = First(cbContractAmendmentContract.SelectedItems).Contract
                                ).DMSContractDateOfSignature,
                                "yyyy"
                            ),
                            ContractSHPItem.DMSContractMainContractYear
                        )
                        /*If(
                            IsBlank(First(cbContractAmendmentContract.SelectedItems).Contract) || IsEmpty(First(cbContractAmendmentContract.SelectedItems).Contract);
                            If(
                                (customFormMode = FormMode.New) && IsBlank(ContractSHPItem.Contract);
                                Text(LookUp(
                                    DMSContract;
                                    Contract = First(cbContractAmendmentContract.SelectedItems).Contract
                                ).DMSContractDateOfSignature;"yyyy");
                                ContractSHPItem.DMSContractMainContractYear
                            )
                        )*/
                        /*
                        If(
                            !IsBlank(cbContractAmendmentContract.Selected) || IsEmpty(cbContractAmendmentContract.Selected);
                            If(
                                (customFormMode = FormMode.New) && IsBlank(ContractSHPItem.Contract);
                                Text(LookUp(
                                    DMSContract;
                                    Contract = cbContractAmendmentContract.Selected.Contract
                                ).DMSContractDateOfSignature;"yyyy");
                                ContractSHPItem.DMSContractMainContractYear
                            )
                        )
                        */
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisplayMode: |-
                        =If(/*(customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") ||*/ customFormMode = FormMode.New,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =
                    Width: =484
                    X: =cbContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 6 * 50
                    ZIndex: =83

                txtContractConIdentification As text:
                    BorderColor: =If(txtContractNumber_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    Default: =ContractSHPItem.DMSContractContractIdentification
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisplayMode: =DisplayMode.Disabled
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Tooltip: =
                    Width: =484
                    X: =cbContractLegalEntity.X
                    Y: =cbContractLegalEntity.Y + 7 * 50
                    ZIndex: =84

                cbContractAmendmentType As combobox:
                    BorderColor: =If(cbContractAmendmentType_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    ChevronBackground: =
                    ChevronFill: =patternColor1.Fill
                    ChevronHoverBackground: =patternColor4.Fill
                    DefaultSelectedItems: |+
                        =LookUp(DMSAmendmentType, DMSAmeTypeCode = ContractSHPItem.DMSContractAmendmentType)
                        
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisplayFields: =["DMSAmeTypeCode"]
                    DisplayMode: |-
                        =If(/*(customFormMode = FormMode.Edit && ContractSHPItem.DMSContractProcessActualPhase = "10") ||*/ customFormMode = FormMode.New && cbContractAmendment.Value,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    InputTextPlaceholder: =LookUp(StringsOrder,AppKey="findItems" && Language=SelectedLanguage,String)
                    Items: =DMSAmendmentType
                    SearchFields: =["DMSAmeTypeCode"]
                    SearchItems: =Search(DMSAmendmentType,cbContractAmendmentType.SearchText,"DMSAmeTypeCode")
                    SelectionColor: =White
                    SelectionFill: =patternColor4.Fill
                    SelectMultiple: =false
                    Tooltip: =
                    Width: =150
                    X: =cbContractLegalEntity.X + 267
                    Y: =cbContractLegalEntity.Y + 4 * 50
                    ZIndex: =85

                cbContractAmendmentContract As combobox:
                    BorderColor: =If(cbContractAmendmentContract_validation,patternColor3.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    ChevronBackground: =
                    ChevronFill: =patternColor1.Fill
                    ChevronHoverBackground: =patternColor4.Fill
                    DefaultSelectedItems: =LookUp(DMSContract, Contract = ContractSHPItem.DMSContractAmendmentContract)
                    DisabledColor: |-
                        =RGBA(0, 0, 0, 1)
                        //RGBA(166; 166; 166; 1)
                    DisplayFields: =["DMSContractNumber"]
                    DisplayMode: |-
                        =If(/*(customFormMode = FormMode.Edit && ContractSHPItem.DMSContractProcessActualPhase = "10") ||*/ customFormMode = FormMode.New && cbContractAmendment.Value ,
                            DisplayMode.Edit,
                            If(customFormMode = FormMode.Edit,
                                DisplayMode.Disabled,
                                DisplayMode.Disabled
                            )
                        )
                    FocusedBorderColor: =patternColor4.Fill
                    FocusedBorderThickness: =1
                    HoverBorderColor: =patternColor4.Fill
                    HoverFill: =ColorFade(patternColor3.Fill, 90%)
                    InputTextPlaceholder: =LookUp(StringsOrder,AppKey="findItems" && Language=SelectedLanguage,String)
                    Items: =Filter(Sort(DMSContract,ID,Descending),StartsWith(Contract,Self.SearchText))
                    SearchFields: =["DMSContractNumber"]
                    SearchItems: =Search(Filter(Sort(DMSContract,ID,Descending),StartsWith(Contract,Self.SearchText)),cbContractAmendmentContract.SearchText,"DMSContractNumber")
                    SelectionColor: =White
                    SelectionFill: =patternColor4.Fill
                    SelectMultiple: =false
                    Tooltip: =
                    Width: =220
                    X: =cbContractLegalEntity.X + 40
                    Y: =cbContractLegalEntity.Y + 4 * 50
                    ZIndex: =86

            ContractAttachments As groupContainer:
                BorderColor: =If(glrOrderAttachments_2_validation,patternColor1.Fill,patternColor6.Fill)
                BorderThickness: =1
                Fill: =Transparent
                Height: =283
                Width: =697
                X: =13
                Y: =1637
                ZIndex: =3

                lblAttachment_2 As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    FontWeight: =FontWeight.Semibold
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsOrder,AppKey="lblAttachment" && Language=SelectedLanguage,String)
                    Tooltip: =labelSettings.Tooltip
                    Width: =190
                    X: =6
                    Y: =45
                    ZIndex: =1

                "glrOrderAttachments_2 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
                    Height: =185
                    Items: |-
                        =//LookUp(DMSContract,ID = ContractSHPItemID).Plohy
                        Filter(DMSContractDocuments,DMSContractID = Text(ContractSHPItemID))
                        //Filter(DMSContractDocuments, 'Cesta ke sloce' = "DMSContractDocuments/" & ContractSHPItem.DMSContractLegalEntityCode & "/" & ContractSHPItem.DMSContractDepartmentCode & "/" & ContractSHPItem.ID & "/")
                    Layout: =Layout.Vertical
                    TemplatePadding: =0
                    TemplateSize: =45
                    Width: =662
                    X: =18
                    Y: =85
                    ZIndex: =2

                    Separator1_10 As rectangle:
                        Fill: =patternColor1.Fill
                        Height: =1
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - 1
                        ZIndex: =5

                    lblAttachmentName_2 As label:
                        Color: =labelSettings.Color
                        Font: =labelSettings.Font
                        Height: =33
                        Size: =labelSettings.Size
                        Text: =ThisItem.'File name with extension'
                        Tooltip: =labelSettings.Tooltip
                        Width: =581
                        X: =6
                        Y: =9
                        ZIndex: =6

                    icoDelete_4 As icon.Cancel:
                        Color: =patternColor1.Fill
                        DisplayMode: =If(SHPMeClaim.Email = ContractSHPItem.'Actual Owner E-mail' || customFormMode = FormMode.New, DisplayMode.Edit,DisplayMode.Disabled)
                        FocusedBorderThickness: =0
                        Height: =31
                        Icon: =Icon.Cancel
                        OnSelect: |-
                            =UpdateContext({popUpNewAttachmentVisibility: true});
                        Visible: |-
                            =//customFormMode = FormMode.Edit || customFormMode = FormMode.New
                            false
                        Width: =25
                        X: =587
                        Y: =9
                        ZIndex: =14

                    icoDownload_2 As icon.Download:
                        Color: =patternColor1.Fill
                        DisplayMode: |-
                            =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") || customFormMode = FormMode.New,
                                DisplayMode.Edit,
                                If(customFormMode = FormMode.Edit,
                                    DisplayMode.Edit,
                                    DisplayMode.Disabled
                                )
                            )
                        FocusedBorderThickness: =0
                        Height: =25
                        Icon: =Icon.Edit
                        OnSelect: |-
                            =Launch(ThisItem.'Link to item')
                            //Download(ThisItem.'Odkaz na poloku')
                        Width: =25
                        X: =626
                        Y: =12
                        ZIndex: =15

                lblContractAttachments As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    FontWeight: =FontWeight.Semibold
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsContract,AppKey="lblContractAttachments" && Language=SelectedLanguage,String) &  If(customFormMode = FormMode.Edit," *","")
                    Tooltip: =labelSettings.Tooltip
                    Width: =190
                    X: =6
                    Y: =5
                    ZIndex: =3

                btnNewAttachment_2 As icon.Edit:
                    Color: =patternColor1.Fill
                    DisplayMode: =If(SHPMeClaim.Email = ContractSHPItem.'Actual Owner E-mail' || customFormMode = FormMode.New, DisplayMode.Edit,DisplayMode.Disabled)
                    FocusedBorderThickness: =0
                    Height: =25
                    Icon: =Icon.Add
                    OnSelect: |-
                        =Refresh(DMSContract);
                        ResetForm(frmContractAttachments);
                        UpdateContext({popUpNewAttachmentVisibility: true});
                    PaddingTop: =-1
                    Visible: =customFormMode = FormMode.Edit || customFormMode = FormMode.New
                    Width: =25
                    X: =604
                    Y: =11
                    ZIndex: =4

                btnNewAttachment_3 As icon.Edit:
                    Color: =patternColor1.Fill
                    DisplayMode: =If(SHPMeClaim.Email = ContractSHPItem.'Actual Owner E-mail' || customFormMode = FormMode.New, DisplayMode.Edit,DisplayMode.Disabled)
                    FocusedBorderThickness: =0
                    Height: =27
                    Icon: =Icon.Reload
                    OnSelect: =Refresh(DMSContractDocuments)
                    PaddingTop: =-1
                    Visible: =customFormMode = FormMode.Edit || customFormMode = FormMode.New
                    Width: =25
                    X: =562
                    Y: =11
                    ZIndex: =5

                btnNewAttachment_4 As icon.Edit:
                    Color: =patternColor1.Fill
                    DisplayMode: |-
                        =//If(SHPMeClaim.Email = ContractSHPItem.DMSContractProcessActualOwnerEMail || customFormMode = FormMode.New, DisplayMode.Edit,DisplayMode.Disabled)
                        DisplayMode.Edit
                    FocusedBorderThickness: =0
                    Height: =25
                    Icon: =Icon.Folder
                    OnSelect: |-
                        =Select(btnContractSave);
                        Download(txtContractWeb & "DMSContractDocuments/" & ContractSHPItem.'Legal Entity Code' & "/" & ContractSHPItem.DMSContractDepartmentCode & "/" & ContractSHPItem.ID & "/")
                    PaddingTop: =-1
                    Visible: |-
                        =//customFormMode = FormMode.Edit || customFormMode = FormMode.New
                        true
                    Width: =25
                    X: =646
                    Y: =12
                    ZIndex: =6

                lblNonActive_3 As label:
                    Align: =Align.Center
                    Color: =RGBA(255, 255, 255, 1)
                    Fill: =RGBA(0, 0, 0, 0.4)
                    Height: =Parent.Height
                    Size: =30
                    Text: =LookUp(StringsContract,AppKey="lblNonActive" && Language=SelectedLanguage,String)
                    Visible: =customFormMode = FormMode.New
                    Width: =Parent.Width
                    ZIndex: =7

                ContractLoadingSpinner As groupContainer:
                    BorderColor: =If(glrOrderAttachments_2_validation,patternColor1.Fill,patternColor6.Fill)
                    BorderThickness: =1
                    Fill: =Transparent
                    Height: =283
                    Visible: =showLoading || showLoadingNewItem
                    Width: =697
                    ZIndex: =12

                    loadingGif As image:
                        Height: =150
                        Image: =Loading
                        OnSelect: |-
                            =Refresh(DMSContractDocuments);
                            If(!IsBlankOrError(LookUp(DMSContractDocuments, DMSContractID = ContractSHPItem.'Legal Entity Code' & "_" & ContractSHPItem.DMSContractDepartmentCode & "_" & ContractSHPItem.ID)),
                                UpdateContext({showLoading: false})
                            );
                        Width: =150
                        X: =269
                        Y: =70
                        ZIndex: =1

                    loadingTimer As timer:
                        Duration: =1000
                        OnSelect: |-
                            =Refresh(DMSContractDocuments);
                            If(!IsBlankOrError(LookUp(DMSContractDocuments, DMSContractID = ContractSHPItem.'Legal Entity Code' & "_" & ContractSHPItem.DMSContractDepartmentCode & "_" & ContractSHPItem.ID)),
                                UpdateContext({showLoading: false})
                            );
                        OnTimerEnd: |-
                            =Refresh(DMSContractDocuments);
                            If(!IsBlankOrError(LookUp(DMSContractDocuments, DMSContractID = ContractSHPItem.'Legal Entity Code' & "_" & ContractSHPItem.DMSContractDepartmentCode & "_" & ContractSHPItem.ID)),
                                UpdateContext({showLoading: false})
                            );
                        Repeat: =true
                        Start: =showLoading
                        Visible: =false
                        X: =380
                        Y: =20
                        ZIndex: =2

                    loadingTimer_NewItem As timer:
                        Duration: =1000
                        OnSelect: |
                            =Refresh(DMSContractDocuments);
                            If(showLoadingItemsCount < CountRows(glrOrderAttachments_2.AllItems),
                                UpdateContext({showLoadingNewItem: false})
                            );
                        OnTimerEnd: |-
                            =Refresh(DMSContractDocuments);
                            If(showLoadingItemsCount < CountRows(glrOrderAttachments_2.AllItems),
                                UpdateContext({showLoadingNewItem: false})
                            );
                        Repeat: =true
                        Start: =showLoadingNewItem
                        Visible: =false
                        X: =40
                        Y: =40
                        ZIndex: =3

            ContractAttachmentsLinks As groupContainer:
                BorderColor: =If(glrOrderAttachments_2_validation,patternColor1.Fill,patternColor6.Fill)
                BorderThickness: =1
                Fill: =Transparent
                Height: =283
                Width: =591
                X: =733
                Y: =1637
                ZIndex: =4

                lblLink As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    FontWeight: =FontWeight.Semibold
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsOrder,AppKey="lblLink" && Language=SelectedLanguage,String)
                    Tooltip: =labelSettings.Tooltip
                    Width: =190
                    X: =6
                    Y: =45
                    ZIndex: =1

                "glrOrderAttachments_3 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
                    Height: =185
                    Items: |-
                        =//LookUp(DMSContract,ID = ContractSHPItemID).Plohy
                        Filter(DMSContractLink,DMSContractLinkContractID = ContractSHPItemID)
                        //Filter(DMSContractDocuments, 'Cesta ke sloce' = "DMSContractDocuments/" & ContractSHPItem.DMSContractLegalEntityCode & "/" & ContractSHPItem.DMSContractDepartmentCode & "/" & ContractSHPItem.ID & "/")
                    Layout: =Layout.Vertical
                    TemplatePadding: =0
                    TemplateSize: =45
                    Width: =573
                    X: =18
                    Y: =85
                    ZIndex: =2

                    Separator1_11 As rectangle:
                        Fill: =patternColor1.Fill
                        Height: =1
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - 1
                        ZIndex: =5

                    lblAttachmentName_3 As label:
                        Color: =labelSettings.Color
                        Font: =labelSettings.Font
                        Height: =33
                        OnSelect: =Launch(ThisItem.DMSContractLinkURL)
                        Size: =labelSettings.Size
                        Text: =ThisItem.DMSContractLinkTitle
                        Tooltip: =labelSettings.Tooltip
                        Underline: =true
                        Width: =490
                        Y: =7
                        ZIndex: =6

                    icoDelete_5 As icon.Cancel:
                        Color: =patternColor1.Fill
                        DisplayMode: |-
                            =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") || customFormMode = FormMode.New,
                                DisplayMode.Edit,
                                If(customFormMode = FormMode.Edit,
                                    DisplayMode.Edit,
                                    DisplayMode.Disabled
                                )
                            )
                        FocusedBorderThickness: =0
                        Height: =31
                        Icon: =Icon.Cancel
                        OnSelect: =Remove(DMSContractLink,ThisItem)
                        Width: =25
                        X: =532
                        Y: =7
                        ZIndex: =14

                    icoDownload_3 As icon.Download:
                        Color: =patternColor1.Fill
                        DisplayMode: |-
                            =If((customFormMode = FormMode.Edit && ContractSHPItem.'Actual Phase' = "10") || customFormMode = FormMode.New,
                                DisplayMode.Edit,
                                If(customFormMode = FormMode.Edit,
                                    DisplayMode.Edit,
                                    DisplayMode.Disabled
                                )
                            )
                        FocusedBorderThickness: =0
                        Height: =25
                        Icon: =Icon.Edit
                        OnSelect: |-
                            =UpdateContext({ttxtAttachmentLinkURL_validation: true});
                            UpdateContext({txtAttachmentLinkTitle_validation: true});
                            
                            UpdateContext({popUpNewAttachmentLinkVisibility: true});
                            UpdateContext({popUpContractAttachmentLinkItemFormMode: FormMode.Edit});
                            
                            UpdateContext({popUpContractAttachmentLinkItem: LookUp(DMSContractLink, ID = ThisItem.ID)});
                            UpdateContext({popUpContractAttachmentLinkItemID: ThisItem.ID});
                        Width: =25
                        X: =496
                        Y: =10
                        ZIndex: =15

                lblContractAttachments_1 As label:
                    Color: =labelSettings.Color
                    Font: =labelSettings.Font
                    FontWeight: =FontWeight.Semibold
                    Size: =labelSettings.Size
                    Text: =LookUp(StringsOrder,AppKey="lblContractAttachmentsLinks" && Language=SelectedLanguage,String) &  If(customFormMode = FormMode.Edit," *","")
                    Tooltip: =labelSettings.Tooltip
                    Width: =190
                    X: =6
                    Y: =5
                    ZIndex: =3

                btnNewAttachment_5 As icon.Edit:
                    Color: =patternColor1.Fill
                    DisplayMode: =If(SHPMeClaim.Email = ContractSHPItem.'Actual Owner E-mail' || customFormMode = FormMode.New, DisplayMode.Edit,DisplayMode.Disabled)
                    FocusedBorderThickness: =0
                    Height: =25
                    Icon: =Icon.Add
                    OnSelect: |-
                        =UpdateContext({ttxtAttachmentLinkURL_validation: true});
                        UpdateContext({txtAttachmentLinkTitle_validation: true});
                        
                        UpdateContext({popUpNewAttachmentLinkVisibility: true});
                        UpdateContext({popUpContractAttachmentLinkItemFormMode: FormMode.New});
                        UpdateContext({popUpContractAttachmentLinkItem: Blank()});
                        UpdateContext({popUpContractAttachmentLinkItemID: Blank()});
                    PaddingTop: =-1
                    Visible: =customFormMode = FormMode.Edit || customFormMode = FormMode.New
                    Width: =25
                    X: =551
                    Y: =11
                    ZIndex: =4

                lblNonActive_5 As label:
                    Align: =Align.Center
                    Color: =RGBA(255, 255, 255, 1)
                    Fill: =RGBA(0, 0, 0, 0.4)
                    Height: =Parent.Height
                    Size: =30
                    Text: =LookUp(StringsContract,AppKey="lblNonActive" && Language=SelectedLanguage,String)
                    Visible: =customFormMode = FormMode.New
                    Width: =Parent.Width
                    ZIndex: =7

    buttonsContracts As groupContainer:
        Fill: =Transparent
        Height: |-
            =/*If(customFormMode = FormMode.Edit || customFormMode = FormMode.New;
                58;
                0
            )
            */
            
            If(customFormMode = FormMode.Edit || customFormMode = FormMode.New,
                58,
                If(ContractSHPItem.'Actual Phase' = "100",
                58,
                    0
            ))
        Width: =Parent.Width
        X: =0*0
        Y: =lblContractTitle.Height
        ZIndex: =3

        btnContractSave As button:
            BorderColor: =patternColor3.DisabledFill
            BorderThickness: =0.5
            Color: =RGBA(0, 0, 0, 1)
            DisplayMode: =If((SHPMeClaim.Email in ContractSHPItem.'Actual Owner E-mail' || customFormMode = FormMode.New || AdminMode) && budgetOwner_validation, DisplayMode.Edit,DisplayMode.Disabled)
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =0.5
            HoverBorderColor: =patternColor4.Fill
            HoverColor: =
            HoverFill: =
            OnSelect: |
                =UpdateContext({txtContractLogEventDescription_validation: true});
                UpdateContext({cbContractLegalEntity_validation: true});
                UpdateContext({txtContractNumber_validation: true});
                UpdateContext({txtContractAmendment_validation: true});
                UpdateContext({txtContractDescription_validation: true});
                UpdateContext({cbContractOwner_validation: true});
                UpdateContext({cbContractDepartment_validation: true});
                UpdateContext({txtContractReason_validation: true});
                UpdateContext({cbContractDuration_validation: true});
                UpdateContext({dpContractDateOfExpiration_validation: true});
                UpdateContext({txtContractTerminationPeriodMonths_validation: true});
                UpdateContext({txtContractLiabilityLimitValue_validation: true});
                UpdateContext({txtContractFinValue_validation: true});
                UpdateContext({cbContractFinValueCurrency_validation: true});
                UpdateContext({txtContractFinValueLocalCurrency_validation: true});
                UpdateContext({txtContractFinValueExchRate_validation: true});
                UpdateContext({txtContractSubject_validation: true});
                UpdateContext({txtContractNotes_validation: true});
                UpdateContext({txtContractPrintsNumberHEU_validation: true});
                UpdateContext({txtContractPrintsNumberOther_validation: true});
                UpdateContext({txtContractPartyRegID1_validation: true});
                UpdateContext({txtContractPartyName1_validation: true});
                UpdateContext({glrOrderAttachments_2_validation: true});
                UpdateContext({txtContractInternalNumber_validation: true});
                UpdateContext({txtContractMainContractYear_validation: true});
                UpdateContext({cbContractAmendmentContract_validation: true});
                UpdateContext({cbContractAmendmentType_validation: true});
                If(
                    IsEmpty(cbContractLegalEntity.SelectedItems) || IsBlank(cbContractLegalEntity.SelectedItems),
                    UpdateContext({cbContractLegalEntity_validation: false}),
                    UpdateContext({cbContractLegalEntity_validation: true})
                );
                If(
                    IsEmpty(cbContractDepartment.SelectedItems) || IsBlank(cbContractDepartment.SelectedItems),
                    UpdateContext({cbContractDepartment_validation: false}),
                    UpdateContext({cbContractDepartment_validation: true})
                );
                If(
                    IsBlank(txtContractDescription.Text),
                    UpdateContext({txtContractDescription_validation: false}),
                    UpdateContext({txtContractDescription_validation: true})
                );
                If(
                    IsBlank(txtContractFinValue.Text),
                    UpdateContext({txtContractFinValue_validation: false}),
                    UpdateContext({txtContractFinValue_validation: true})
                );
                //<--nov pro migraci archivu
                //kdy amendment true
                If(cbContractAmendment.Value,
                    If(
                        IsEmpty(First(cbContractAmendmentContract.SelectedItems).Contract) || IsBlank(First(cbContractAmendmentContract.SelectedItems).Contract),
                        UpdateContext({cbContractAmendmentContract_validation: false}),
                        UpdateContext({cbContractAmendmentContract_validation: true})
                    );
                    If(
                       IsEmpty(cbContractAmendmentType.SelectedItems) || IsBlank(cbContractAmendmentType.SelectedItems),
                       UpdateContext({cbContractAmendmentType_validation: false}),
                       UpdateContext({cbContractAmendmentType_validation: true})
                    ),
                    UpdateContext({cbContractAmendmentContract_validation: true});
                    UpdateContext({cbContractAmendmentType_validation: true})
                );
                //vdy
                If(
                    IsBlank(txtContractInternalNumber.Text),
                    UpdateContext({txtContractInternalNumber_validation: false}),
                    UpdateContext({txtContractInternalNumber_validation: true})
                );
                If(
                    IsBlank(txtContractMainContractYear.Text),
                    UpdateContext({txtContractMainContractYear_validation: false}),
                    UpdateContext({txtContractMainContractYear_validation: true})
                );
                //-->nov pro migraci archivu
                If(
                    cbContractLegalEntity_validation && cbContractDepartment_validation && txtContractDescription_validation && cbContractAmendmentContract_validation && cbContractAmendmentType_validation && txtContractInternalNumber_validation && txtContractMainContractYear_validation && txtContractFinValue_validation,
                    If(
                        IsBlank(cbContractOwner.SelectedItems) || IsEmpty(cbContractOwner.SelectedItems),
                        Set(
                            cbContractOwnerValue,
                            BlankPeople
                        ),
                        Set(
                            cbContractOwnerValue,
                            Table(
                                {
                                    '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                                    Claims: "i:0#.f|membership|" & First(cbContractOwner.SelectedItems).Mail,
                                    Department: "",
                                    DisplayName: First(cbContractOwner.SelectedItems).DisplayName,
                                    Email: First(cbContractOwner.SelectedItems).Mail,
                                    JobTitle: ".",
                                    Picture: "."
                                }
                            )
                        )
                    );
                    If(
                        IsBlank(cbContractDepartment.SelectedItems) || IsEmpty(cbContractDepartment.SelectedItems),
                        Set(
                            cbContractBudgetOwnerValue,
                            BlankPeople
                        ),
                        Set(
                            cbContractBudgetOwnerValue,
                            Table(
                                {
                                    '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                                    Claims: "i:0#.f|membership|" & Lower(First(cbContractDepartment.SelectedItems).'Budget Owner E-mail'),
                                    Department: "",
                                    DisplayName: First(cbContractDepartment.SelectedItems).'Budget Owner Name',
                                    Email: First(cbContractDepartment.SelectedItems).'Budget Owner E-mail',
                                    JobTitle: ".",
                                    Picture: "."
                                }
                            )
                        )
                    );
                    Refresh(DMSContract);
                    Set(
                        NewContractSHPItem,
                        Patch(
                            DMSContract,
                            If(
                                customFormMode = FormMode.New,
                                Defaults(DMSContract),
                                LookUp(
                                    DMSContract,
                                    ID = ContractSHPItemID
                                )
                            ),
                            //Defaults(DMSContract),
                            {
                                Title: If(
                                    customFormMode = FormMode.New,
                                    "NEW_CONTRACT",
                                    txtContractNumber.Text
                                )
                            },
                            {DMSContractAmendment: cbContractAmendment.Value},
                            {DMSContractAmendmentNum: Value(txtContractAmendment.Text)},
                            {DMSContractAmendmentContract: First(cbContractAmendmentContract.SelectedItems).Contract},
                            {DMSContractAmendmentType: cbContractAmendmentType.Selected.DMSAmeTypeCode},
                            {DMSContractInternalNumber: txtContractInternalNumber.Text},
                            {DMSContractMainContractYear: txtContractMainContractYear.Text},
                            {DMSContractContractIdentification: txtContractConIdentification.Text},
                            {DMSContractAutomaticRenewal: cbContractAutomaticRenewal.Value},
                            {'Date of Expiration': dpContractDateOfExpiration.Value},
                            {DMSContractDateOfSignature: dpContractDateOfSignature.Value},
                            {DMSContractDateReceived: dpContractDateReceived.Value},
                            {DMSContractDateSent: dpContractDateSent.Value},
                            {DMSContractDepartmentCode: First(cbContractDepartment.SelectedItems).'Cost Center Code'},
                            {'Cost Center': First(cbContractDepartment.SelectedItems).'Name (DMSDepartmentName)'},
                            {DMSContractDuration: First(cbContractDuration.SelectedItems)},
                            {'Financial Value': Value(txtContractFinValue.Text)},
                            {'Contract Currency': First(cbContractFinValueCurrency.SelectedItems).Currency},
                            {'Contract Exchange Rate': Value(txtContractFinValueExchRate.Text)},
                            {'Value in Local Currency': Value(txtContractFinValueLocalCurrency.Text)},
                            {'In Budget': cbContractInBudget.Value},
                            {'Legal Entity Code': First(cbContractLegalEntity.SelectedItems).'Legal Entity Code'},
                            {'Legal Entity': First(cbContractLegalEntity.SelectedItems).'Legal Entity Name'},
                            {
                                'Legal Entity Type': LookUp(
                                    Choices([@DMSContract].'Legal Entity Type'),
                                    Value = First(cbContractLegalEntity.SelectedItems).'Legal Entity Type'
                                )
                            },
                            {'Liability Limit': cbContractLiabilityLimit.Value},
                            {DMSContractLiabilityLimitValue: Value(txtContractLiabilityLimitValue.Text)},
                            {DMSContractNotes: txtContractNotes.Text},
                            {Contract: txtContractNumber.Text},
                            {'Contract Owner': cbContractOwnerValue},
                            {DMSContractPartyCode1: First(cbContractPartyCode1.SelectedItems).'ERP Code'},
                            {DMSContractPartyCode2: First(cbContractPartyCode2.SelectedItems).'ERP Code'},
                            {DMSContractPartyCode3: First(cbContractPartyCode3.SelectedItems).'ERP Code'},
                            {DMSContractPartyCode4: First(cbContractPartyCode4.SelectedItems).'ERP Code'},
                            {DMSContractPartyID1: txtContractPartyRegID1.Text},
                            {DMSContractPartyID2: txtContractPartyRegID2.Text},
                            {DMSContractPartyID3: txtContractPartyRegID3.Text},
                            {DMSContractPartyID4: txtContractPartyRegID4.Text},
                            {'Contract Party 1': txtContractPartyName1.Text},
                            {DMSContractPartyName2: txtContractPartyName2.Text},
                            {DMSContractPartyName3: txtContractPartyName3.Text},
                            {DMSContractPartyName4: txtContractPartyName4.Text},
                            {DMSContractPrintsNumberHEU: Value(txtContractPrintsNumberHEU.Text)},
                            {DMSContractPrintsNumberOther: Value(txtContractPrintsNumberOther.Text)},
                            {DMSContractPrintsNumberTotal: Value(txtContractPrintsNumberTotal.Text)},
                            {'Process Note': txtContractLogEventDescription.Text},
                            {Reason: txtContractReason.Text},
                            {'Reserved Matters': cbContractReservedMatters.Value},
                            //{DMSContractState:},
                            {
                                'Actual Phase': If(
                                    customFormMode = FormMode.New,
                                    "10",
                                    ContractSHPItem.'Actual Phase'
                                )
                            },
                            {
                                'Actual Owner': If(
                                    customFormMode = FormMode.New,
                                    Table(SHPMeClaim),
                                    ContractSHPItem.'Actual Owner'
                                )
                            },
                            {
                                'Actual Owner E-mail': If(
                                    customFormMode = FormMode.New,
                                    SHPMeClaim.Email,
                                    ContractSHPItem.'Actual Owner E-mail'
                                )
                            },
                            {
                                'Actual Owner Name': If(
                                    customFormMode = FormMode.New,
                                    SHPMeClaim.DisplayName,
                                    ContractSHPItem.'Actual Owner Name'
                                )
                            },
                            {'Contract Subject': txtContractSubject.Text},
                            {DMSContractTerminationPeriodMonths: Value(txtContractTerminationPeriodMonths.Text)},
                            {DMSContractTerminationWithoutReason: cbContractTerminationWithoutReason.Value},
                            {'Contract Title': txtContractDescription.Text},
                            {'Budget Owner': cbContractBudgetOwnerValue},
                            {'Budget Owner E-mail': First(cbContractBudgetOwnerValue).Email},
                            {'Budget Owner Name': First(cbContractBudgetOwnerValue).DisplayName}
                        );
                    );
                    If(
                        customFormMode = FormMode.New,
                        /*If(!cbContractAmendment.Value,
                            Patch(
                                DMSContract,
                                LookUp(DMSContract,ID = NewContractSHPItem.ID),
                                {Title: "CON" &  Text(NewContractSHPItem.ID,"[$-en-US]000000")},
                                {DMSContractNumber:"CON" &  Text(NewContractSHPItem.ID,"[$-en-US]000000")}
                            );
                        );*/
                        //Set(ContractSHPItem,LookUp(DMSContract,ID = NewContractSHPItem.ID));
                        //Set(ContractSHPItemID,ContractSHPItem.ID);
                        /*UpdateContext({ContractNumberFlow: "CON" &  Text(NewContractSHPItem.ID;"[$-en-US]000000")});;*/
                        If(cbContractAmendment.Value,
                            Set(AmendmentFlow,DMS_Amendment.Run(NewContractSHPItem.DMSContractAmendmentContract,NewContractSHPItem.ID,NewContractSHPItem.Title,NewContractSHPItem.DMSContractAmendment,NewContractSHPItem.DMSContractAmendmentType,"CON" &  Text(NewContractSHPItem.ID,"[$-en-US]000000"))),
                            Set(AmendmentFlow,DMS_Amendment.Run("AmC0",NewContractSHPItem.ID,NewContractSHPItem.Title,NewContractSHPItem.DMSContractAmendment,"AmT0","CON" &  Text(NewContractSHPItem.ID,"[$-en-US]000000")))
                        );
                        Set(
                            customFormMode,
                            FormMode.Edit
                        );
                        UpdateContext({showLoading: true});
                        //Reset(txtContractNumber);
                        //CHRQ Contract folder flow
                DMS_ContractsCreateAttachmentFolder_CanvasApp.Run(
                            NewContractSHPItem.'Legal Entity Code',
                            NewContractSHPItem.DMSContractDepartmentCode,
                            NewContractSHPItem.ID
                        );
                    );
                    Set(
                        ContractSHPItem,
                        LookUp(
                            DMSContract,
                            ID = NewContractSHPItem.ID
                        )
                    );
                    Set(
                        ContractSHPItemID,
                        ContractSHPItem.ID
                    );
                    Reset(txtContractLogEventDescription);
                    Refresh(DMSProcessLog);
                    Notify(
                        LookUp(
                            StringsProcess,
                            AppKey = "NotificationSaved" && Language = SelectedLanguage,
                            String
                        ),
                        NotificationType.Success
                    );
                    ,
                    Notify(
                        LookUp(
                            StringsProcess,
                            AppKey = "errEmptyField" && Language = SelectedLanguage,
                            String
                        ),
                        NotificationType.Error
                    );
                    
                );
            PressedBorderColor: =patternColor4.Fill
            PressedColor: =
            PressedFill: =ColorFade(patternColor3.Fill, 90%)
            Text: =If(customFormMode = FormMode.New,LookUp(StringsContract,AppKey="lblContinue" && Language=SelectedLanguage,String),LookUp(StringsContract,AppKey="btnContractSave" && Language=SelectedLanguage,String))
            Width: =120
            X: =40
            Y: =18
            ZIndex: =1

        btnContractRequestComments As button:
            BorderColor: =patternColor3.DisabledFill
            BorderThickness: =0.5
            Color: =RGBA(0, 0, 0, 1)
            DisplayMode: =If(SHPMeClaim.Email in ContractSHPItem.'Actual Owner E-mail' || customFormMode = FormMode.New || AdminMode, DisplayMode.Edit,DisplayMode.Disabled)
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =0.5
            HoverBorderColor: =patternColor4.Fill
            HoverColor: =
            HoverFill: =
            OnSelect: |-
                =//upraveno dle CAS0000118003
                UpdateContext({txtContractFinValue_validation: true});
                If(
                    IsBlank(txtContractFinValue.Text),
                    UpdateContext({txtContractFinValue_validation: false}),
                    UpdateContext({txtContractFinValue_validation: true})
                );
                If(txtContractFinValue_validation,
                    If(ContractSHPItem.'Actual Phase' = "20" && txtContractFinValue_validation,
                	    // STOP
                	    Patch(
                	    	DMSContract,
                	    	LookUp(DMSContract,ID = ContractSHPItemID),
                	    	{DMSContractActionDate:Now()},
                	    	{DMSContractActionDescription:txtContractLogEventDescription.Text},
                	    	{'Action Required':"END COMMENT"},
                	    	{'Action Required By':SHPMeClaim},
                	    	{DMSContractActionRequiredByEMail:SHPMeClaim.Email}
                	    );
                        Notify(LookUp(StringsProcess,AppKey="NotificationReturned" && Language=SelectedLanguage,String) & " " & ContractSHPItem.'Previous Owner Name',      NotificationType.Success);
                        Set(customFormMode, FormMode.View);
                        ,
                    
                	    UpdateContext({txtDelagateToDescription_validation: true});
                	    UpdateContext({cbDelegateTo_validation: true});
                	    UpdateContext({popUpCommentVisibility: true});
                    ),
                Notify(LookUp(StringsProcess,AppKey="errEmptyField" && Language=SelectedLanguage,String),NotificationType.Error));
            PressedBorderColor: =patternColor4.Fill
            PressedColor: =
            PressedFill: =ColorFade(patternColor3.Fill, 90%)
            Text: |-
                =If(ContractSHPItem.'Actual Phase' = "20",
                    LookUp(StringsInvoice,AppKey="btnOrdStopComments" && Language=SelectedLanguage,String),
                    LookUp(StringsInvoice,AppKey="btnOrdRequestComments" && Language=SelectedLanguage,String)
                )
            Visible: =CountRows(ContractSHPItem.'Actual Owner') < 2 && !(customFormMode = FormMode.New)
            Width: =206
            X: =174
            Y: =18
            ZIndex: =2

        btnContractStartApproval As button:
            BorderColor: =patternColor3.DisabledFill
            BorderThickness: =0.5
            Color: =RGBA(0, 0, 0, 1)
            DisplayMode: =If(SHPMeClaim.Email in ContractSHPItem.'Actual Owner E-mail' || customFormMode = FormMode.New || AdminMode, DisplayMode.Edit,DisplayMode.Disabled)
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =0.5
            HoverBorderColor: =patternColor4.Fill
            HoverColor: =
            HoverFill: =
            OnSelect: |-
                =If(IsEmpty(cbContractLegalEntity.SelectedItems) || IsBlank(cbContractLegalEntity.SelectedItems),
                   UpdateContext({cbContractLegalEntity_validation: false}),
                   UpdateContext({cbContractLegalEntity_validation: true})
                );
                If(IsBlank(txtContractNumber.Text),
                   UpdateContext({txtContractNumber_validation: false}),
                   UpdateContext({txtContractNumber_validation: true})
                );
                If(cbContractAmendment.Value && IsBlank(txtContractAmendment.Text),
                   UpdateContext({txtContractAmendment_validation: false}),
                   UpdateContext({txtContractAmendment_validation: true})
                );
                If(IsBlank(txtContractDescription.Text),
                   UpdateContext({txtContractDescription_validation: false}),
                   UpdateContext({txtContractDescription_validation: true})
                );
                If(IsEmpty(cbContractOwner.SelectedItems) || IsBlank(cbContractOwner.SelectedItems),
                   UpdateContext({cbContractOwner_validation: false}),
                   UpdateContext({cbContractOwner_validation: true})
                );
                If(IsEmpty(cbContractDepartment.SelectedItems) || IsBlank(cbContractDepartment.SelectedItems),
                   UpdateContext({cbContractDepartment_validation: false}),
                   UpdateContext({cbContractDepartment_validation: true})
                );
                /*If(IsBlank(txtContractReason.Text),
                   UpdateContext({txtContractReason_validation: false}),
                   UpdateContext({txtContractReason_validation: true})
                );
                If(IsEmpty(cbContractDuration.SelectedItems) || IsBlank(cbContractDuration.SelectedItems),
                   UpdateContext({cbContractDuration_validation: false}),
                   UpdateContext({cbContractDuration_validation: true})
                );
                If(IsEmpty(dpContractDateOfExpiration.SelectedDate) || IsBlank(dpContractDateOfExpiration.SelectedDate),
                   UpdateContext({dpContractDateOfExpiration_validation: false}),
                   UpdateContext({dpContractDateOfExpiration_validation: true})
                );
                If(IsBlank(txtContractTerminationPeriodMonths.Text),
                   UpdateContext({txtContractTerminationPeriodMonths_validation: false}),
                   UpdateContext({txtContractTerminationPeriodMonths_validation: true})
                );
                If(IsBlank(txtContractLiabilityLimitValue.Text),
                   UpdateContext({txtContractLiabilityLimitValue_validation: false}),
                   UpdateContext({txtContractLiabilityLimitValue_validation: true})
                );
                */
                If(IsBlank(txtContractFinValue.Text),
                   UpdateContext({txtContractFinValue_validation: false}),
                   UpdateContext({txtContractFinValue_validation: true})
                );
                If(IsEmpty(cbContractFinValueCurrency.SelectedItems) || IsBlank(cbContractFinValueCurrency.SelectedItems),
                   UpdateContext({cbContractFinValueCurrency_validation: false}),
                   UpdateContext({cbContractFinValueCurrency_validation: true})
                );
                /*If(IsBlank(txtContractFinValueLocalCurrency.Text) || !(Value(txtContractFinValueLocalCurrency.Text) > 0),
                   UpdateContext({txtContractFinValueLocalCurrency_validation: false}),
                   UpdateContext({txtContractFinValueLocalCurrency_validation: true})
                );*/
                If(IsBlank(txtContractFinValueExchRate.Text),
                   UpdateContext({txtContractFinValueExchRate_validation: false}),
                   UpdateContext({txtContractFinValueExchRate_validation: true})
                );
                /*
                If(IsBlank(txtContractSubject.Text),
                   UpdateContext({txtContractSubject_validation: false}),
                   UpdateContext({txtContractSubject_validation: true})
                );
                If(IsBlank(txtContractNotes.Text),
                   UpdateContext({txtContractNotes_validation: false}),
                   UpdateContext({txtContractNotes_validation: true})
                );
                If(IsBlank(txtContractPrintsNumberHEU.Text),
                   UpdateContext({txtContractPrintsNumberHEU_validation: false}),
                   UpdateContext({txtContractPrintsNumberHEU_validation: true})
                );
                If(IsBlank(txtContractPrintsNumberOther.Text),
                   UpdateContext({txtContractPrintsNumberOther_validation: false}),
                   UpdateContext({txtContractPrintsNumberOther_validation: true})
                );*/
                If(IsBlank(txtContractPartyRegID1.Text),
                   UpdateContext({txtContractPartyRegID1_validation: false}),
                   UpdateContext({txtContractPartyRegID1_validation: true})
                );
                If(IsBlank(txtContractPartyName1.Text),
                   UpdateContext({txtContractPartyName1_validation: false}),
                   UpdateContext({txtContractPartyName1_validation: true})
                );
                If(CountRows(glrOrderAttachments_2.AllItems) < 1 && CountRows(glrOrderAttachments_3.AllItems) < 1,
                   UpdateContext({glrOrderAttachments_2_validation: false}),
                   UpdateContext({glrOrderAttachments_2_validation: true})
                );
                
                If(
                    cbContractLegalEntity_validation &&
                    txtContractNumber_validation &&
                    txtContractAmendment_validation &&
                    txtContractDescription_validation &&
                    cbContractOwner_validation &&
                    cbContractDepartment_validation &&
                    //txtContractReason_validation &&
                    //cbContractDuration_validation &&
                    //dpContractDateOfExpiration_validation &&
                    //txtContractTerminationPeriodMonths_validation &&
                    //txtContractLiabilityLimitValue_validation &&
                    txtContractFinValue_validation &&
                    //cbContractFinValueCurrency_validation &&
                    txtContractFinValueLocalCurrency_validation &&
                    //txtContractFinValueExchRate_validation &&
                    //txtContractSubject_validation &&
                    //txtContractNotes_validation &&
                    //txtContractPrintsNumberHEU_validation &&
                    //txtContractPrintsNumberOther_validation &&
                    txtContractPartyRegID1_validation &&
                    txtContractPartyName1_validation &&
                    glrOrderAttachments_2_validation,
                    Refresh(DMSContract);
                    If(IsBlank(cbContractOwner.SelectedItems) || IsEmpty(cbContractOwner.SelectedItems),
                        Set(cbContractOwnerValue,BlankPeople),
                        Set(cbContractOwnerValue,
                            Table({'@odata.type':"#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                            Claims:"i:0#.f|membership|" & First(cbContractOwner.SelectedItems).Mail,
                            Department:"",
                            DisplayName:First(cbContractOwner.SelectedItems).DisplayName,
                            Email:First(cbContractOwner.SelectedItems).Mail,
                            JobTitle:".",
                            Picture:"."})
                        )
                    );
                
                    If(IsBlank(cbContractDepartment.SelectedItems) || IsEmpty(cbContractDepartment.SelectedItems),
                        Set(cbContractBudgetOwnerValue,BlankPeople),
                        Set(cbContractBudgetOwnerValue,
                            Table({'@odata.type':"#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                            Claims:"i:0#.f|membership|" & Lower(First(cbContractDepartment.SelectedItems).'Budget Owner E-mail'),
                            Department:"",
                            DisplayName:First(cbContractDepartment.SelectedItems).'Budget Owner Name',
                            Email:First(cbContractDepartment.SelectedItems).'Budget Owner E-mail',
                            JobTitle:".",
                            Picture:"."})
                        )
                    );
                
                    Set(NewContractSHPItem,
                        Patch(
                            DMSContract,
                            If(customFormMode = FormMode.New,Defaults(DMSContract),LookUp(DMSContract,ID = ContractSHPItemID)),
                            //Defaults(DMSContract),
                            {Title: txtContractNumber.Text},
                            {DMSContractAmendment:cbContractAmendment.Value},
                            {DMSContractAmendmentNumber:txtContractAmendment.Text},
                            {DMSContractAutomaticRenewal:cbContractAutomaticRenewal.Value},
                            {'Date of Expiration':dpContractDateOfExpiration.Value},
                            {DMSContractDateOfSignature:dpContractDateOfSignature.Value},
                            {DMSContractDateReceived:dpContractDateReceived.Value},
                            {DMSContractDateSent:dpContractDateSent.Value},
                            {DMSContractDepartmentCode:First(cbContractDepartment.SelectedItems).'Cost Center Code'},
                            {'Cost Center':First(cbContractDepartment.SelectedItems).'Name (DMSDepartmentName)'},
                            {DMSContractDuration:First(cbContractDuration.SelectedItems)},
                            {'Financial Value':Value(txtContractFinValue.Text)},
                            {'Contract Currency':First(cbContractFinValueCurrency.SelectedItems).Currency},
                            {'Contract Exchange Rate':Value(txtContractFinValueExchRate.Text)},
                            {'Value in Local Currency':Value(txtContractFinValueLocalCurrency.Text)},
                            {'In Budget':cbContractInBudget.Value},
                            {'Legal Entity Code':First(cbContractLegalEntity.SelectedItems).'Legal Entity Code'},
                            {'Legal Entity':First(cbContractLegalEntity.SelectedItems).'Legal Entity Name'},
                            {'Legal Entity Type':LookUp(Choices([@DMSContract].'Legal Entity Type'),Value = First(cbContractLegalEntity.SelectedItems).'Legal Entity Type')},
                            {'Liability Limit':cbContractLiabilityLimit.Value},
                            {DMSContractLiabilityLimitValue:Value(txtContractLiabilityLimitValue.Text)},
                            {DMSContractNotes:txtContractNotes.Text},
                            {Contract:txtContractNumber.Text},
                            {'Contract Owner':cbContractOwnerValue},
                            {DMSContractPartyCode1:First(cbContractPartyCode1.SelectedItems).'ERP Code'},
                            {DMSContractPartyCode2:First(cbContractPartyCode2.SelectedItems).'ERP Code'},
                            {DMSContractPartyCode3:First(cbContractPartyCode3.SelectedItems).'ERP Code'},
                            {DMSContractPartyCode4:First(cbContractPartyCode4.SelectedItems).'ERP Code'},
                            {DMSContractPartyID1:txtContractPartyRegID1.Text},
                            {DMSContractPartyID2:txtContractPartyRegID2.Text},
                            {DMSContractPartyID3:txtContractPartyRegID3.Text},
                            {DMSContractPartyID4:txtContractPartyRegID4.Text},
                            {'Contract Party 1':txtContractPartyName1.Text},
                            {DMSContractPartyName2:txtContractPartyName2.Text},
                            {DMSContractPartyName3:txtContractPartyName3.Text},
                            {DMSContractPartyName4:txtContractPartyName4.Text},
                            {DMSContractPrintsNumberHEU:Value(txtContractPrintsNumberHEU.Text)},
                            {DMSContractPrintsNumberOther:Value(txtContractPrintsNumberOther.Text)},
                            {DMSContractPrintsNumberTotal:Value(txtContractPrintsNumberTotal.Text)},
                            {'Process Note':txtContractLogEventDescription.Text},
                            {Reason:txtContractReason.Text},
                            {'Reserved Matters':cbContractReservedMatters.Value},
                            //{DMSContractState:},
                            {'Actual Phase':If(customFormMode = FormMode.New,"10",ContractSHPItem.'Actual Phase')},
                            {'Actual Owner':If(customFormMode = FormMode.New,Table(SHPMeClaim),ContractSHPItem.'Actual Owner')},
                            {'Actual Owner E-mail':If(customFormMode = FormMode.New,SHPMeClaim.Email,ContractSHPItem.'Actual Owner E-mail')},
                            {'Actual Owner Name':If(customFormMode = FormMode.New,SHPMeClaim.DisplayName,ContractSHPItem.'Actual Owner Name')},
                            {'Contract Subject':txtContractSubject.Text},
                            {DMSContractTerminationPeriodMonths:Value(txtContractTerminationPeriodMonths.Text)},
                            {DMSContractTerminationWithoutReason:cbContractTerminationWithoutReason.Value},
                            {'Contract Title':txtContractDescription.Text},
                            {'Budget Owner':cbContractBudgetOwnerValue},
                            {'Budget Owner E-mail':First(cbContractBudgetOwnerValue).Email},
                            {'Budget Owner Name':First(cbContractBudgetOwnerValue).DisplayName}
                        );        
                    );
                    Set(ContractSHPItem,LookUp(DMSContract,ID = NewContractSHPItem.ID));
                    If(customFormMode = FormMode.New,
                        Patch(
                            DMSContract,
                            LookUp(DMSContract,ID = NewContractSHPItem.ID),
                            {Title:"CON" &  Text(NewContractSHPItem.ID,"[$-en-US]000000")},
                            {Contract:"CON" &  Text(NewContractSHPItem.ID,"[$-en-US]000000")}
                        );
                        Set(ContractSHPItem,LookUp(DMSContract,ID = NewContractSHPItem.ID));
                        Set(ContractSHPItemID,NewContractSHPItem.ID);
                        Set(customFormMode, FormMode.Edit);
                        UpdateContext({showLoading: true});
                        Reset(txtContractNumber);
                    );
                
                    //DMS_WriteLog.Run(Now(),1,ContractSHPItem.DMSContractProcessActualPhase,txtContractLogEventDescription.Text,User().Email,OrderSHPItem.ID);
                    Reset(txtContractLogEventDescription);
                    Refresh(DMSProcessLog);
                    
                    // APPROVE
                	Patch(
                		DMSContract,
                		LookUp(DMSContract,ID = NewContractSHPItem.ID),
                		{DMSContractActionDate:Now()},
                		{DMSContractActionDescription:txtContractLogEventDescription.Text},
                		{'Action Required':"START APPROVE"},
                		{'Action Required By':SHPMeClaim},
                		{DMSContractActionRequiredByEMail:SHPMeClaim.Email},
                        {'Approved By':Collect(NewContractSHPItem.'Approved By',SHPMeClaim)}
                	);
                    Set(customFormMode, FormMode.View);
                    Notify(LookUp(StringsProcess,AppKey="NotificationApprovalStarted" && Language=SelectedLanguage,String),NotificationType.Success);
                    ,
                    Notify(LookUp(StringsProcess,AppKey="errEmptyField" && Language=SelectedLanguage,String),NotificationType.Error);
                );
            PressedBorderColor: =patternColor4.Fill
            PressedColor: =
            PressedFill: =ColorFade(patternColor3.Fill, 90%)
            Text: =LookUp(StringsContract,AppKey="btnContractStartApproval" && Language=SelectedLanguage,String)
            Visible: =(customFormMode = FormMode.Edit && (ContractSHPItem.'Actual Phase' = "10")) /*|| customFormMode = FormMode.New*/
            Width: =199
            X: =391
            Y: =18
            ZIndex: =3

        btnContractCreateOrder As button:
            BorderColor: =patternColor3.DisabledFill
            BorderThickness: =0.5
            Color: =RGBA(0, 0, 0, 1)
            DisplayMode: |-
                =DisplayMode.Edit
                /*If(SHPMeClaim.Email in ContractSHPItem.'Actual Owner E-mail' || customFormMode = FormMode.New || AdminMode; DisplayMode.Edit;DisplayMode.Disabled)*/
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =0.5
            HoverBorderColor: =patternColor4.Fill
            HoverColor: =
            HoverFill: =
            OnSelect: |-
                =Set(OrderSHPItem,
                    Patch(OrderSHPItem,
                       {DMSOrdVendorCode:First(cbContractPartyCode1.SelectedItems).'ERP Code'},
                       {DMSOrdDepartmentCode:First(cbContractDepartment.SelectedItems).'Cost Center Code'},
                       {DMSOrdContractNumber:txtContractNumber.Text}
                    )
                );
                
                Set(generateOrderFromContract,true); // je poteba na onStart nastavit na false, stejn tak po uloen objednvky
                Set(customFormMode,FormMode.New);
                Navigate(scrOrders);
                
                //Launch("https://apps.powerapps.com/play/c1bea39c-dac4-47d6-aed7-b9885d20d977?tenantId=7d4b1c11-92c5-46f6-b07a-f7f95fc039c0&screen=1&formmode=1")
            PressedBorderColor: =patternColor4.Fill
            PressedColor: =
            PressedFill: =ColorFade(patternColor3.Fill, 90%)
            Text: =LookUp(StringsContract,AppKey="btnContractCreateOrder" && Language=SelectedLanguage,String)
            Visible: |-
                =/*customFormMode = FormMode.Edit && (
                    ContractSHPItem.'Actual Phase' = "100"
                )
                */
                
                ContractSHPItem.'Actual Phase' = "100"
            Width: =215
            X: =602
            Y: =18
            ZIndex: =4

        btnContractDelegate As button:
            BorderColor: =patternColor3.DisabledFill
            BorderThickness: =0.5
            Color: =RGBA(0, 0, 0, 1)
            DisplayMode: =If(SHPMeClaim.Email in ContractSHPItem.'Actual Owner E-mail' || customFormMode = FormMode.New || AdminMode, DisplayMode.Edit,DisplayMode.Disabled)
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =0.5
            HoverBorderColor: =patternColor4.Fill
            HoverColor: =
            HoverFill: =
            OnSelect: |-
                =UpdateContext({txtDelagateToDescription_validation: true});
                UpdateContext({cbDelegateTo_validation: true});
                UpdateContext({popUpDelegateToVisibility: true});
            PressedBorderColor: =patternColor4.Fill
            PressedColor: =
            PressedFill: =ColorFade(patternColor3.Fill, 90%)
            Text: =LookUp(StringsContract,AppKey="btnContractDelegate" && Language=SelectedLanguage,String)
            Visible: =CountRows(ContractSHPItem.'Actual Owner') < 2 && !(customFormMode = FormMode.New)
            X: =831
            Y: =18
            ZIndex: =5

        btnContractApprove As button:
            BorderColor: =patternColor3.DisabledFill
            BorderThickness: =0.5
            Color: =RGBA(0, 0, 0, 1)
            DisplayMode: =If(SHPMeClaim.Email in ContractSHPItem.'Actual Owner E-mail' || customFormMode = FormMode.New || AdminMode, DisplayMode.Edit,DisplayMode.Disabled)
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =0.5
            HoverBorderColor: =patternColor4.Fill
            HoverColor: =
            HoverFill: =
            OnSelect: |-
                =If(IsEmpty(cbContractLegalEntity.SelectedItems) || IsBlank(cbContractLegalEntity.SelectedItems),
                   UpdateContext({cbContractLegalEntity_validation: false}),
                   UpdateContext({cbContractLegalEntity_validation: true})
                );
                If(IsBlank(txtContractNumber.Text),
                   UpdateContext({txtContractNumber_validation: false}),
                   UpdateContext({txtContractNumber_validation: true})
                );
                If(cbContractAmendment.Value && IsBlank(txtContractAmendment.Text),
                   UpdateContext({txtContractAmendment_validation: false}),
                   UpdateContext({txtContractAmendment_validation: true})
                );
                If(IsBlank(txtContractDescription.Text),
                   UpdateContext({txtContractDescription_validation: false}),
                   UpdateContext({txtContractDescription_validation: true})
                );
                If(IsEmpty(cbContractOwner.SelectedItems) || IsBlank(cbContractOwner.SelectedItems),
                   UpdateContext({cbContractOwner_validation: false}),
                   UpdateContext({cbContractOwner_validation: true})
                );
                If(IsEmpty(cbContractDepartment.SelectedItems) || IsBlank(cbContractDepartment.SelectedItems),
                   UpdateContext({cbContractDepartment_validation: false}),
                   UpdateContext({cbContractDepartment_validation: true})
                );
                /*If(IsBlank(txtContractReason.Text),
                   UpdateContext({txtContractReason_validation: false}),
                   UpdateContext({txtContractReason_validation: true})
                );
                If(IsEmpty(cbContractDuration.SelectedItems) || IsBlank(cbContractDuration.SelectedItems),
                   UpdateContext({cbContractDuration_validation: false}),
                   UpdateContext({cbContractDuration_validation: true})
                );
                If(IsEmpty(dpContractDateOfExpiration.SelectedDate) || IsBlank(dpContractDateOfExpiration.SelectedDate),
                   UpdateContext({dpContractDateOfExpiration_validation: false}),
                   UpdateContext({dpContractDateOfExpiration_validation: true})
                );
                If(IsBlank(txtContractTerminationPeriodMonths.Text),
                   UpdateContext({txtContractTerminationPeriodMonths_validation: false}),
                   UpdateContext({txtContractTerminationPeriodMonths_validation: true})
                );
                If(IsBlank(txtContractLiabilityLimitValue.Text),
                   UpdateContext({txtContractLiabilityLimitValue_validation: false}),
                   UpdateContext({txtContractLiabilityLimitValue_validation: true})
                );
                If(IsBlank(txtContractFinValue.Text),
                   UpdateContext({txtContractFinValue_validation: false}),
                   UpdateContext({txtContractFinValue_validation: true})
                );
                If(IsEmpty(cbContractFinValueCurrency.SelectedItems) || IsBlank(cbContractFinValueCurrency.SelectedItems),
                   UpdateContext({cbContractFinValueCurrency_validation: false}),
                   UpdateContext({cbContractFinValueCurrency_validation: true})
                );
                If(IsBlank(txtContractFinValueLocalCurrency.Text),
                   UpdateContext({txtContractFinValueLocalCurrency_validation: false}),
                   UpdateContext({txtContractFinValueLocalCurrency_validation: true})
                );
                If(IsBlank(txtContractFinValueExchRate.Text),
                   UpdateContext({txtContractFinValueExchRate_validation: false}),
                   UpdateContext({txtContractFinValueExchRate_validation: true})
                );
                If(IsBlank(txtContractSubject.Text),
                   UpdateContext({txtContractSubject_validation: false}),
                   UpdateContext({txtContractSubject_validation: true})
                );
                If(IsBlank(txtContractNotes.Text),
                   UpdateContext({txtContractNotes_validation: false}),
                   UpdateContext({txtContractNotes_validation: true})
                );
                If(IsBlank(txtContractPrintsNumberHEU.Text),
                   UpdateContext({txtContractPrintsNumberHEU_validation: false}),
                   UpdateContext({txtContractPrintsNumberHEU_validation: true})
                );
                If(IsBlank(txtContractPrintsNumberOther.Text),
                   UpdateContext({txtContractPrintsNumberOther_validation: false}),
                   UpdateContext({txtContractPrintsNumberOther_validation: true})
                );*/
                If(IsBlank(txtContractPartyRegID1.Text),
                   UpdateContext({txtContractPartyRegID1_validation: false}),
                   UpdateContext({txtContractPartyRegID1_validation: true})
                );
                If(IsBlank(txtContractPartyName1.Text),
                   UpdateContext({txtContractPartyName1_validation: false}),
                   UpdateContext({txtContractPartyName1_validation: true})
                );
                If(CountRows(glrOrderAttachments_2.AllItems) < 1,
                   UpdateContext({glrOrderAttachments_2_validation: false}),
                   UpdateContext({glrOrderAttachments_2_validation: true})
                );
                
                If(
                    cbContractLegalEntity_validation &&
                    txtContractNumber_validation &&
                    txtContractAmendment_validation &&
                    txtContractDescription_validation &&
                    cbContractOwner_validation &&
                    cbContractDepartment_validation &&
                    //txtContractReason_validation &&
                    //cbContractDuration_validation &&
                    //dpContractDateOfExpiration_validation &&
                    //txtContractTerminationPeriodMonths_validation &&
                    //txtContractLiabilityLimitValue_validation &&
                    //txtContractFinValue_validation &&
                    //cbContractFinValueCurrency_validation &&
                    //txtContractFinValueLocalCurrency_validation &&
                    //txtContractFinValueExchRate_validation &&
                    //txtContractSubject_validation &&
                    //txtContractNotes_validation &&
                    //txtContractPrintsNumberHEU_validation &&
                    //txtContractPrintsNumberOther_validation &&
                    txtContractPartyRegID1_validation &&
                    txtContractPartyName1_validation &&
                    glrOrderAttachments_2_validation,
                    Refresh(DMSContract);
                    If(IsBlank(cbContractOwner.SelectedItems) || IsEmpty(cbContractOwner.SelectedItems),
                        Set(cbContractOwnerValue,BlankPeople),
                        Set(cbContractOwnerValue,
                            Table({'@odata.type':"#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                            Claims:"i:0#.f|membership|" & First(cbContractOwner.SelectedItems).Mail,
                            Department:"",
                            DisplayName:First(cbContractOwner.SelectedItems).DisplayName,
                            Email:First(cbContractOwner.SelectedItems).Mail,
                            JobTitle:".",
                            Picture:"."})
                        )
                    );
                
                    If(IsBlank(cbContractDepartment.SelectedItems) || IsEmpty(cbContractDepartment.SelectedItems),
                        Set(cbContractBudgetOwnerValue,BlankPeople),
                        Set(cbContractBudgetOwnerValue,
                            Table({'@odata.type':"#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                            Claims:"i:0#.f|membership|" & Lower(First(cbContractDepartment.SelectedItems).'Budget Owner E-mail'),
                            Department:"",
                            DisplayName:First(cbContractDepartment.SelectedItems).'Budget Owner Name',
                            Email:First(cbContractDepartment.SelectedItems).'Budget Owner E-mail',
                            JobTitle:".",
                            Picture:"."})
                        )
                    );
                
                    Set(NewContractSHPItem,
                        Patch(
                            DMSContract,
                            If(customFormMode = FormMode.New,Defaults(DMSContract),LookUp(DMSContract,ID = ContractSHPItemID)),
                            //Defaults(DMSContract),
                            {Title: txtContractNumber.Text},
                            {DMSContractAmendment:cbContractAmendment.Value},
                            {DMSContractAmendmentNumber:txtContractAmendment.Text},
                            {DMSContractAutomaticRenewal:cbContractAutomaticRenewal.Value},
                            {'Date of Expiration':dpContractDateOfExpiration.Value},
                            {DMSContractDateOfSignature:dpContractDateOfSignature.Value},
                            {DMSContractDateReceived:dpContractDateReceived.Value},
                            {DMSContractDateSent:dpContractDateSent.Value},
                            {DMSContractDepartmentCode:First(cbContractDepartment.SelectedItems).'Cost Center Code'},
                            {'Cost Center':First(cbContractDepartment.SelectedItems).'Name (DMSDepartmentName)'},
                            {DMSContractDuration:First(cbContractDuration.SelectedItems)},
                            {'Financial Value':Value(txtContractFinValue.Text)},
                            {'Contract Currency':First(cbContractFinValueCurrency.SelectedItems).Currency},
                            {'Contract Exchange Rate':Value(txtContractFinValueExchRate.Text)},
                            {'Value in Local Currency':Value(txtContractFinValueLocalCurrency.Text)},
                            {'In Budget':cbContractInBudget.Value},
                            {'Legal Entity Code':First(cbContractLegalEntity.SelectedItems).'Legal Entity Code'},
                            {'Legal Entity':First(cbContractLegalEntity.SelectedItems).'Legal Entity Name'},
                            {'Legal Entity Type':LookUp(Choices([@DMSContract].'Legal Entity Type'),Value = First(cbContractLegalEntity.SelectedItems).'Legal Entity Type')},
                            {'Liability Limit':cbContractLiabilityLimit.Value},
                            {DMSContractLiabilityLimitValue:Value(txtContractLiabilityLimitValue.Text)},
                            {DMSContractNotes:txtContractNotes.Text},
                            {Contract:txtContractNumber.Text},
                            {'Contract Owner':cbContractOwnerValue},
                            {DMSContractPartyCode1:First(cbContractPartyCode1.SelectedItems).'ERP Code'},
                            {DMSContractPartyCode2:First(cbContractPartyCode2.SelectedItems).'ERP Code'},
                            {DMSContractPartyCode3:First(cbContractPartyCode3.SelectedItems).'ERP Code'},
                            {DMSContractPartyCode4:First(cbContractPartyCode4.SelectedItems).'ERP Code'},
                            {DMSContractPartyID1:txtContractPartyRegID1.Text},
                            {DMSContractPartyID2:txtContractPartyRegID2.Text},
                            {DMSContractPartyID3:txtContractPartyRegID3.Text},
                            {DMSContractPartyID4:txtContractPartyRegID4.Text},
                            {'Contract Party 1':txtContractPartyName1.Text},
                            {DMSContractPartyName2:txtContractPartyName2.Text},
                            {DMSContractPartyName3:txtContractPartyName3.Text},
                            {DMSContractPartyName4:txtContractPartyName4.Text},
                            {DMSContractPrintsNumberHEU:Value(txtContractPrintsNumberHEU.Text)},
                            {DMSContractPrintsNumberOther:Value(txtContractPrintsNumberOther.Text)},
                            {DMSContractPrintsNumberTotal:Value(txtContractPrintsNumberTotal.Text)},
                            {'Process Note':txtContractLogEventDescription.Text},
                            {Reason:txtContractReason.Text},
                            {'Reserved Matters':cbContractReservedMatters.Value},
                            //{DMSContractState:},
                            {'Actual Phase':If(customFormMode = FormMode.New,"10",ContractSHPItem.'Actual Phase')},
                            {'Actual Owner':If(customFormMode = FormMode.New,Table(SHPMeClaim),ContractSHPItem.'Actual Owner')},
                            {'Actual Owner E-mail':If(customFormMode = FormMode.New,SHPMeClaim.Email,ContractSHPItem.'Actual Owner E-mail')},
                            {'Actual Owner Name':If(customFormMode = FormMode.New,SHPMeClaim.DisplayName,ContractSHPItem.'Actual Owner Name')},
                            {'Contract Subject':txtContractSubject.Text},
                            {DMSContractTerminationPeriodMonths:Value(txtContractTerminationPeriodMonths.Text)},
                            {DMSContractTerminationWithoutReason:cbContractTerminationWithoutReason.Value},
                            {'Contract Title':txtContractDescription.Text},
                            {'Budget Owner':cbContractBudgetOwnerValue},
                            {'Budget Owner E-mail':First(cbContractBudgetOwnerValue).Email},
                            {'Budget Owner Name':First(cbContractBudgetOwnerValue).DisplayName}
                        );        
                    );
                    Set(ContractSHPItem,LookUp(DMSContract,ID = NewContractSHPItem.ID));
                    If(customFormMode = FormMode.New,
                        /*Patch(
                            DMSContract,
                            LookUp(DMSContract,ID = NewContractSHPItem.ID),
                            {DMSContractNumber:"CON" &  Text(NewContractSHPItem.ID,"[$-en-US]000000")}
                        );*/
                        Set(ContractSHPItem,LookUp(DMSContract,ID = NewContractSHPItem.ID));
                        Set(ContractSHPItemID,NewContractSHPItem.ID);
                        Set(customFormMode, FormMode.Edit);
                        Reset(txtContractNumber);
                    );
                
                    //DMS_WriteLog.Run(Now(),1,ContractSHPItem.DMSContractProcessActualPhase,txtContractLogEventDescription.Text,User().Email,OrderSHPItem.ID);
                    Reset(txtContractLogEventDescription);
                    Refresh(DMSProcessLog);
                    
                    // APPROVE
                	Patch(
                		DMSContract,
                		LookUp(DMSContract,ID = NewContractSHPItem.ID),
                		{DMSContractActionDate:Now()},
                		{DMSContractActionDescription:txtContractLogEventDescription.Text},
                		{'Action Required':"START APPROVE"},
                		{'Action Required By':SHPMeClaim},
                		{DMSContractActionRequiredByEMail:SHPMeClaim.Email},
                        {'Approved By':Collect(NewContractSHPItem.'Approved By',SHPMeClaim)}
                	);
                    Set(customFormMode, FormMode.View);
                    Notify(LookUp(StringsProcess,AppKey="NotificationApproved" && Language=SelectedLanguage,String),NotificationType.Success);
                    ,
                    Notify(LookUp(StringsProcess,AppKey="errEmptyField" && Language=SelectedLanguage,String),NotificationType.Error);
                );
            PressedBorderColor: =patternColor4.Fill
            PressedColor: =
            PressedFill: =ColorFade(patternColor3.Fill, 90%)
            Text: =LookUp(StringsContract,AppKey="btnContractApprove" && Language=SelectedLanguage,String)
            Visible: |-
                =customFormMode = FormMode.Edit && (
                    ContractSHPItem.'Actual Phase' = "30" ||
                    ContractSHPItem.'Actual Phase' = "40" ||
                    ContractSHPItem.'Actual Phase' = "50" ||
                    ContractSHPItem.'Actual Phase' = "60" ||
                    ContractSHPItem.'Actual Phase' = "65" ||
                    ContractSHPItem.'Actual Phase' = "70" ||
                    ContractSHPItem.'Actual Phase' = "80" ||
                    ContractSHPItem.'Actual Phase' = "85" ||
                    ContractSHPItem.'Actual Phase' = "90" ||
                    ContractSHPItem.'Actual Phase' = "95"
                    )
            X: =1009
            Y: =18
            ZIndex: =6

        btnContractReject As button:
            BorderColor: =patternColor3.DisabledFill
            BorderThickness: =0.5
            Color: =RGBA(0, 0, 0, 1)
            DisplayMode: =If(SHPMeClaim.Email in ContractSHPItem.'Actual Owner E-mail' || customFormMode = FormMode.New || AdminMode, DisplayMode.Edit,DisplayMode.Disabled)
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =0.5
            HoverBorderColor: =patternColor4.Fill
            HoverColor: =
            HoverFill: =
            OnSelect: |-
                =If(IsEmpty(cbContractLegalEntity.SelectedItems) || IsBlank(cbContractLegalEntity.SelectedItems),
                   UpdateContext({cbContractLegalEntity_validation: false}),
                   UpdateContext({cbContractLegalEntity_validation: true})
                );
                If(IsBlank(txtContractNumber.Text),
                   UpdateContext({txtContractNumber_validation: false}),
                   UpdateContext({txtContractNumber_validation: true})
                );
                If(cbContractAmendment.Value && IsBlank(txtContractAmendment.Text),
                   UpdateContext({txtContractAmendment_validation: false}),
                   UpdateContext({txtContractAmendment_validation: true})
                );
                If(IsBlank(txtContractDescription.Text),
                   UpdateContext({txtContractDescription_validation: false}),
                   UpdateContext({txtContractDescription_validation: true})
                );
                If(IsEmpty(cbContractOwner.SelectedItems) || IsBlank(cbContractOwner.SelectedItems),
                   UpdateContext({cbContractOwner_validation: false}),
                   UpdateContext({cbContractOwner_validation: true})
                );
                If(IsEmpty(cbContractDepartment.SelectedItems) || IsBlank(cbContractDepartment.SelectedItems),
                   UpdateContext({cbContractDepartment_validation: false}),
                   UpdateContext({cbContractDepartment_validation: true})
                );
                /*If(IsBlank(txtContractReason.Text),
                   UpdateContext({txtContractReason_validation: false}),
                   UpdateContext({txtContractReason_validation: true})
                );
                If(IsEmpty(cbContractDuration.SelectedItems) || IsBlank(cbContractDuration.SelectedItems),
                   UpdateContext({cbContractDuration_validation: false}),
                   UpdateContext({cbContractDuration_validation: true})
                );
                If(IsEmpty(dpContractDateOfExpiration.SelectedDate) || IsBlank(dpContractDateOfExpiration.SelectedDate),
                   UpdateContext({dpContractDateOfExpiration_validation: false}),
                   UpdateContext({dpContractDateOfExpiration_validation: true})
                );
                If(IsBlank(txtContractTerminationPeriodMonths.Text),
                   UpdateContext({txtContractTerminationPeriodMonths_validation: false}),
                   UpdateContext({txtContractTerminationPeriodMonths_validation: true})
                );
                If(IsBlank(txtContractLiabilityLimitValue.Text),
                   UpdateContext({txtContractLiabilityLimitValue_validation: false}),
                   UpdateContext({txtContractLiabilityLimitValue_validation: true})
                );
                If(IsBlank(txtContractFinValue.Text),
                   UpdateContext({txtContractFinValue_validation: false}),
                   UpdateContext({txtContractFinValue_validation: true})
                );
                If(IsEmpty(cbContractFinValueCurrency.SelectedItems) || IsBlank(cbContractFinValueCurrency.SelectedItems),
                   UpdateContext({cbContractFinValueCurrency_validation: false}),
                   UpdateContext({cbContractFinValueCurrency_validation: true})
                );
                If(IsBlank(txtContractFinValueLocalCurrency.Text),
                   UpdateContext({txtContractFinValueLocalCurrency_validation: false}),
                   UpdateContext({txtContractFinValueLocalCurrency_validation: true})
                );
                If(IsBlank(txtContractFinValueExchRate.Text),
                   UpdateContext({txtContractFinValueExchRate_validation: false}),
                   UpdateContext({txtContractFinValueExchRate_validation: true})
                );
                If(IsBlank(txtContractSubject.Text),
                   UpdateContext({txtContractSubject_validation: false}),
                   UpdateContext({txtContractSubject_validation: true})
                );
                If(IsBlank(txtContractNotes.Text),
                   UpdateContext({txtContractNotes_validation: false}),
                   UpdateContext({txtContractNotes_validation: true})
                );
                If(IsBlank(txtContractPrintsNumberHEU.Text),
                   UpdateContext({txtContractPrintsNumberHEU_validation: false}),
                   UpdateContext({txtContractPrintsNumberHEU_validation: true})
                );
                If(IsBlank(txtContractPrintsNumberOther.Text),
                   UpdateContext({txtContractPrintsNumberOther_validation: false}),
                   UpdateContext({txtContractPrintsNumberOther_validation: true})
                );*/
                If(IsBlank(txtContractPartyRegID1.Text),
                   UpdateContext({txtContractPartyRegID1_validation: false}),
                   UpdateContext({txtContractPartyRegID1_validation: true})
                );
                If(IsBlank(txtContractPartyName1.Text),
                   UpdateContext({txtContractPartyName1_validation: false}),
                   UpdateContext({txtContractPartyName1_validation: true})
                );
                If(CountRows(glrOrderAttachments_2.AllItems) < 1,
                   UpdateContext({glrOrderAttachments_2_validation: false}),
                   UpdateContext({glrOrderAttachments_2_validation: true})
                );
                
                If(
                    cbContractLegalEntity_validation &&
                txtContractNumber_validation &&
                txtContractAmendment_validation &&
                txtContractDescription_validation &&
                cbContractOwner_validation &&
                cbContractDepartment_validation &&
                //txtContractReason_validation &&
                //cbContractDuration_validation &&
                //dpContractDateOfExpiration_validation &&
                //txtContractTerminationPeriodMonths_validation &&
                //txtContractLiabilityLimitValue_validation &&
                //txtContractFinValue_validation &&
                //cbContractFinValueCurrency_validation &&
                //txtContractFinValueLocalCurrency_validation &&
                //txtContractFinValueExchRate_validation &&
                //txtContractSubject_validation &&
                //txtContractNotes_validation &&
                //txtContractPrintsNumberHEU_validation &&
                //txtContractPrintsNumberOther_validation &&
                txtContractPartyRegID1_validation &&
                txtContractPartyName1_validation &&
                glrOrderAttachments_2_validation,
                
                    If(IsBlank(cbContractOwner.SelectedItems) || IsEmpty(cbContractOwner.SelectedItems),
                        Set(cbContractOwnerValue,BlankPeople),
                        Set(cbContractOwnerValue,
                            Table({'@odata.type':"#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                            Claims:"i:0#.f|membership|" & First(cbContractOwner.SelectedItems).Mail,
                            Department:"",
                            DisplayName:First(cbContractOwner.SelectedItems).DisplayName,
                            Email:First(cbContractOwner.SelectedItems).Mail,
                            JobTitle:".",
                            Picture:"."})
                        )
                    );
                
                    If(IsBlank(cbContractDepartment.SelectedItems) || IsEmpty(cbContractDepartment.SelectedItems),
                        Set(cbContractBudgetOwnerValue,BlankPeople),
                        Set(cbContractBudgetOwnerValue,
                            Table({'@odata.type':"#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                            Claims:"i:0#.f|membership|" & Lower(First(cbContractDepartment.SelectedItems).'Budget Owner E-mail'),
                            Department:"",
                            DisplayName:First(cbContractDepartment.SelectedItems).'Budget Owner Name',
                            Email:First(cbContractDepartment.SelectedItems).'Budget Owner E-mail',
                            JobTitle:".",
                            Picture:"."})
                        )
                    );
                
                    Set(NewContractSHPItem,
                        Patch(
                            DMSContract,
                            If(customFormMode = FormMode.New,Defaults(DMSContract),LookUp(DMSContract,ID = ContractSHPItemID)),
                            //Defaults(DMSContract),
                            {Title: txtContractNumber.Text},
                            {DMSContractAmendment:cbContractAmendment.Value},
                            {DMSContractAmendmentNumber:txtContractAmendment.Text},
                            {DMSContractAutomaticRenewal:cbContractAutomaticRenewal.Value},
                            {'Date of Expiration':dpContractDateOfExpiration.Value},
                            {DMSContractDateOfSignature:dpContractDateOfSignature.Value},
                            {DMSContractDateReceived:dpContractDateReceived.Value},
                            {DMSContractDateSent:dpContractDateSent.Value},
                            {DMSContractDepartmentCode:First(cbContractDepartment.SelectedItems).'Cost Center Code'},
                            {'Cost Center':First(cbContractDepartment.SelectedItems).'Name (DMSDepartmentName)'},
                            {DMSContractDuration:First(cbContractDuration.SelectedItems)},
                            {'Financial Value':Value(txtContractFinValue.Text)},
                            {'Contract Currency':First(cbContractFinValueCurrency.SelectedItems).Currency},
                            {'Contract Exchange Rate':Value(txtContractFinValueExchRate.Text)},
                            {'Value in Local Currency':Value(txtContractFinValueLocalCurrency.Text)},
                            {'In Budget':cbContractInBudget.Value},
                            {'Legal Entity Code':First(cbContractLegalEntity.SelectedItems).'Legal Entity Code'},
                            {'Legal Entity':First(cbContractLegalEntity.SelectedItems).'Legal Entity Name'},
                            {'Legal Entity Type':LookUp(Choices([@DMSContract].'Legal Entity Type'),Value = First(cbContractLegalEntity.SelectedItems).'Legal Entity Type')},
                            {'Liability Limit':cbContractLiabilityLimit.Value},
                            {DMSContractLiabilityLimitValue:Value(txtContractLiabilityLimitValue.Text)},
                            {DMSContractNotes:txtContractNotes.Text},
                            {Contract:txtContractNumber.Text},
                            {'Contract Owner':cbContractOwnerValue},
                            {DMSContractPartyCode1:First(cbContractPartyCode1.SelectedItems).'ERP Code'},
                            {DMSContractPartyCode2:First(cbContractPartyCode2.SelectedItems).'ERP Code'},
                            {DMSContractPartyCode3:First(cbContractPartyCode3.SelectedItems).'ERP Code'},
                            {DMSContractPartyCode4:First(cbContractPartyCode4.SelectedItems).'ERP Code'},
                            {DMSContractPartyID1:txtContractPartyRegID1.Text},
                            {DMSContractPartyID2:txtContractPartyRegID2.Text},
                            {DMSContractPartyID3:txtContractPartyRegID3.Text},
                            {DMSContractPartyID4:txtContractPartyRegID4.Text},
                            {'Contract Party 1':txtContractPartyName1.Text},
                            {DMSContractPartyName2:txtContractPartyName2.Text},
                            {DMSContractPartyName3:txtContractPartyName3.Text},
                            {DMSContractPartyName4:txtContractPartyName4.Text},
                            {DMSContractPrintsNumberHEU:Value(txtContractPrintsNumberHEU.Text)},
                            {DMSContractPrintsNumberOther:Value(txtContractPrintsNumberOther.Text)},
                            {DMSContractPrintsNumberTotal:Value(txtContractPrintsNumberTotal.Text)},
                            {'Process Note':txtContractLogEventDescription.Text},
                            {Reason:txtContractReason.Text},
                            {'Reserved Matters':cbContractReservedMatters.Value},
                            //{DMSContractState:},
                            {'Actual Phase':If(customFormMode = FormMode.New,"10",ContractSHPItem.'Actual Phase')},
                            {'Actual Owner':If(customFormMode = FormMode.New,Table(SHPMeClaim),ContractSHPItem.'Actual Owner')},
                            {'Actual Owner E-mail':If(customFormMode = FormMode.New,SHPMeClaim.Email,ContractSHPItem.'Actual Owner E-mail')},
                            {'Actual Owner Name':If(customFormMode = FormMode.New,SHPMeClaim.DisplayName,ContractSHPItem.'Actual Owner Name')},
                            {'Contract Subject':txtContractSubject.Text},
                            {DMSContractTerminationPeriodMonths:Value(txtContractTerminationPeriodMonths.Text)},
                            {DMSContractTerminationWithoutReason:cbContractTerminationWithoutReason.Value},
                            {'Contract Title':txtContractDescription.Text},
                            {'Budget Owner':cbContractBudgetOwnerValue},
                            {'Budget Owner E-mail':First(cbContractBudgetOwnerValue).Email},
                            {'Budget Owner Name':First(cbContractBudgetOwnerValue).DisplayName}
                        );        
                    );
                    Set(ContractSHPItem,LookUp(DMSContract,ID = NewContractSHPItem.ID));
                    If(customFormMode = FormMode.New,
                        /*Patch(
                            DMSContract,
                            LookUp(DMSContract,ID = NewContractSHPItem.ID),
                            {DMSContractNumber:"CON" &  Text(NewContractSHPItem.ID,"[$-en-US]000000")}
                        );*/
                        Set(ContractSHPItem,LookUp(DMSContract,ID = NewContractSHPItem.ID));
                        Set(ContractSHPItemID,ContractSHPItem.ID);
                        Set(customFormMode, FormMode.Edit);
                        Reset(txtContractNumber);
                    );
                
                    //DMS_WriteLog.Run(Now(),1,ContractSHPItem.DMSContractProcessActualPhase,txtContractLogEventDescription.Text,User().Email,OrderSHPItem.ID);
                    Reset(txtContractLogEventDescription);
                    Refresh(DMSProcessLog);
                    
                    // APPROVE
                	Patch(
                		DMSContract,
                		LookUp(DMSContract,ID = ContractSHPItemID),
                		{DMSContractActionDate:Now()},
                		{DMSContractActionDescription:txtContractLogEventDescription.Text},
                		{'Action Required':"START DECLINE"},
                		{'Action Required By':SHPMeClaim},
                		{DMSContractActionRequiredByEMail:SHPMeClaim.Email}
                	);
                    Set(customFormMode, FormMode.View);
                    Notify(LookUp(StringsProcess,AppKey="NotificationDecline" && Language=SelectedLanguage,String),NotificationType.Success);
                    ,
                    Notify(LookUp(StringsProcess,AppKey="errEmptyField" && Language=SelectedLanguage,String),NotificationType.Error);
                );
            PressedBorderColor: =patternColor4.Fill
            PressedColor: =
            PressedFill: =ColorFade(patternColor3.Fill, 90%)
            Text: =LookUp(StringsContract,AppKey="btnContractReject" && Language=SelectedLanguage,String)
            Visible: |-
                =customFormMode = FormMode.Edit && (
                    ContractSHPItem.'Actual Phase' = "30" ||
                    ContractSHPItem.'Actual Phase' = "40" ||
                    ContractSHPItem.'Actual Phase' = "50" ||
                    ContractSHPItem.'Actual Phase' = "60" ||
                    ContractSHPItem.'Actual Phase' = "65" ||
                    ContractSHPItem.'Actual Phase' = "70" ||
                    ContractSHPItem.'Actual Phase' = "80" ||
                    ContractSHPItem.'Actual Phase' = "85" ||
                    ContractSHPItem.'Actual Phase' = "90" ||
                    ContractSHPItem.'Actual Phase' = "95"
                    )
            X: =1188
            Y: =18
            ZIndex: =7

        btnReopenPopUp_2 As button:
            BorderColor: =patternColor3.DisabledFill
            BorderThickness: =0.5
            Color: =RGBA(0, 0, 0, 1)
            DisplayMode: =If(SHPMeClaim.Email in ContractSHPItem.'Actual Owner E-mail' || customFormMode = FormMode.New || AdminMode, DisplayMode.Edit,DisplayMode.Disabled)
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =0.5
            HoverBorderColor: =patternColor4.Fill
            HoverColor: =
            HoverFill: =
            OnSelect: |-
                =UpdateContext({popUpReopenVisibility: true});
            PressedBorderColor: =patternColor4.Fill
            PressedColor: =
            PressedFill: =ColorFade(patternColor3.Fill, 90%)
            Text: =LookUp(StringsOrder,AppKey="btnReopenPopUp" && Language=SelectedLanguage,String)
            Visible: =(customFormMode = FormMode.Edit && (ContractSHPItem.'Actual Phase' = "99"))
            Width: =247
            X: =1009
            Y: =18
            ZIndex: =8

    popUpDelegateTo_2 As groupContainer:
        Fill: =RGBA(0, 0, 0, 0.1)
        Height: =695
        Visible: =popUpDelegateToVisibility
        Width: =Parent.Width
        X: =0*0
        Y: =73
        ZIndex: =4

        popUpFooter_4 As rectangle:
            BorderColor: =patternColor1.Fill
            BorderThickness: =2
            Fill: =White
            Height: =405
            Width: =573
            X: =404
            Y: =28
            ZIndex: =1

        popUpHeader_8 As rectangle:
            BorderColor: =patternColor1.Fill
            BorderThickness: =2
            Fill: =patternColor1.Fill
            Height: =48
            Width: =573
            X: =404
            Y: =28
            ZIndex: =2

        popUpLabelOrderItem_8 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Height: =48
            Size: =18
            Text: =LookUp(StringsOrder,AppKey="btnOrdDelegate" && Language=SelectedLanguage,String)
            Width: =573
            X: =404
            Y: =28
            ZIndex: =3

        btnDelegate_2 As button:
            BorderColor: =patternColor3.DisabledFill
            BorderThickness: =0.5
            Color: =RGBA(0, 0, 0, 1)
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =0.5
            HoverBorderColor: =patternColor4.Fill
            HoverColor: =
            HoverFill: =
            OnSelect: |-
                =If(IsBlank(txtDelagateToDescription_2.Text),
                   UpdateContext({txtDelagateToDescription_validation: false}),
                   UpdateContext({txtDelagateToDescription_validation: true})
                );
                If(IsEmpty(cbDelegateTo_2.SelectedItems) || IsBlank(cbDelegateTo_2.SelectedItems),
                   UpdateContext({cbDelegateTo_validation: false}),
                   UpdateContext({cbDelegateTo_validation: true})
                );
                
                
                If(
                    txtDelagateToDescription_validation && cbDelegateTo_validation,
                
                    If(IsBlank(cbContractOwner.SelectedItems) || IsEmpty(cbContractOwner.SelectedItems),
                        Set(cbContractOwnerValue,BlankPeople),
                        Set(cbContractOwnerValue,
                            Table({'@odata.type':"#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                            Claims:"i:0#.f|membership|" & First(cbContractOwner.SelectedItems).Mail,
                            Department:"",
                            DisplayName:First(cbContractOwner.SelectedItems).DisplayName,
                            Email:First(cbContractOwner.SelectedItems).Mail,
                            JobTitle:".",
                            Picture:"."})
                        )
                    );
                
                    If(IsBlank(cbDelegateTo_2.SelectedItems) || IsEmpty(cbDelegateTo_2.SelectedItems),
                		Set(cbContractDelegateToValue,BlankPeople),
                		Set(cbContractDelegateToValue,
                			Table({'@odata.type':"#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                			Claims:"i:0#.f|membership|" & Lower(First(cbDelegateTo_2.SelectedItems).Mail),
                			Department:"",
                			DisplayName:First(cbDelegateTo_2.SelectedItems).DisplayName,
                			Email:First(cbDelegateTo_2.SelectedItems).Mail,
                			JobTitle:".",
                			Picture:"."})
                		)
                	);
                
                    If(IsBlank(cbContractDepartment.SelectedItems) || IsEmpty(cbContractDepartment.SelectedItems),
                        Set(cbContractBudgetOwnerValue,BlankPeople),
                        Set(cbContractBudgetOwnerValue,
                            Table({'@odata.type':"#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                            Claims:"i:0#.f|membership|" & Lower(First(cbContractDepartment.SelectedItems).'Budget Owner E-mail'),
                            Department:"",
                            DisplayName:First(cbContractDepartment.SelectedItems).'Budget Owner Name',
                            Email:First(cbContractDepartment.SelectedItems).'Budget Owner E-mail',
                            JobTitle:".",
                            Picture:"."})
                        )
                    );
                
                Set(NewContractSHPItem,
                    Patch(
                        DMSContract,
                        If(customFormMode = FormMode.New,Defaults(DMSContract),LookUp(DMSContract,ID = ContractSHPItemID)),
                        //Defaults(DMSContract),
                        {Title: txtContractNumber.Text},
                		{DMSContractAmendment:cbContractAmendment.Value},
                		{DMSContractAmendmentNumber:txtContractAmendment.Text},
                		{DMSContractAutomaticRenewal:cbContractAutomaticRenewal.Value},
                		{'Date of Expiration':dpContractDateOfExpiration.Value},
                		{DMSContractDateOfSignature:dpContractDateOfSignature.Value},
                		{DMSContractDateReceived:dpContractDateReceived.Value},
                		{DMSContractDateSent:dpContractDateSent.Value},
                		{DMSContractDepartmentCode:First(cbContractDepartment.SelectedItems).'Cost Center Code'},
                		{'Cost Center':First(cbContractDepartment.SelectedItems).'Name (DMSDepartmentName)'},
                		{DMSContractDuration:First(cbContractDuration.SelectedItems)},
                		{'Financial Value':Value(txtContractFinValue.Text)},
                		{'Contract Currency':First(cbContractFinValueCurrency.SelectedItems).Currency},
                		{'Contract Exchange Rate':Value(txtContractFinValueExchRate.Text)},
                		{'Value in Local Currency':Value(txtContractFinValueLocalCurrency.Text)},
                		{'In Budget':cbContractInBudget.Value},
                		{'Legal Entity Code':First(cbContractLegalEntity.SelectedItems).'Legal Entity Code'},
                		{'Legal Entity':First(cbContractLegalEntity.SelectedItems).'Legal Entity Name'},
                		{'Legal Entity Type':LookUp(Choices([@DMSContract].'Legal Entity Type'),Value = First(cbContractLegalEntity.SelectedItems).'Legal Entity Type')},
                		{'Liability Limit':cbContractLiabilityLimit.Value},
                		{DMSContractLiabilityLimitValue:Value(txtContractLiabilityLimitValue.Text)},
                		{DMSContractNotes:txtContractNotes.Text},
                		{Contract:txtContractNumber.Text},
                		{'Contract Owner':cbContractOwnerValue},
                		{DMSContractPartyCode1:First(cbContractPartyCode1.SelectedItems).'ERP Code'},
                		{DMSContractPartyCode2:First(cbContractPartyCode2.SelectedItems).'ERP Code'},
                		{DMSContractPartyCode3:First(cbContractPartyCode3.SelectedItems).'ERP Code'},
                		{DMSContractPartyCode4:First(cbContractPartyCode4.SelectedItems).'ERP Code'},
                		{DMSContractPartyID1:txtContractPartyRegID1.Text},
                		{DMSContractPartyID2:txtContractPartyRegID2.Text},
                		{DMSContractPartyID3:txtContractPartyRegID3.Text},
                		{DMSContractPartyID4:txtContractPartyRegID4.Text},
                		{'Contract Party 1':txtContractPartyName1.Text},
                		{DMSContractPartyName2:txtContractPartyName2.Text},
                		{DMSContractPartyName3:txtContractPartyName3.Text},
                		{DMSContractPartyName4:txtContractPartyName4.Text},
                		{DMSContractPrintsNumberHEU:Value(txtContractPrintsNumberHEU.Text)},
                		{DMSContractPrintsNumberOther:Value(txtContractPrintsNumberOther.Text)},
                		{DMSContractPrintsNumberTotal:Value(txtContractPrintsNumberTotal.Text)},
                		{'Process Note':txtContractLogEventDescription.Text},
                		{Reason:txtContractReason.Text},
                		{'Reserved Matters':cbContractReservedMatters.Value},
                		//{DMSContractState:},
                        {'Actual Phase':If(customFormMode = FormMode.New,"10",ContractSHPItem.'Actual Phase')},
                        {'Actual Owner':If(customFormMode = FormMode.New,Table(SHPMeClaim),ContractSHPItem.'Actual Owner')},
                        {'Actual Owner E-mail':If(customFormMode = FormMode.New,SHPMeClaim.Email,ContractSHPItem.'Actual Owner E-mail')},
                        {'Actual Owner Name':If(customFormMode = FormMode.New,SHPMeClaim.DisplayName,ContractSHPItem.'Actual Owner Name')},
                		{'Contract Subject':txtContractSubject.Text},
                		{DMSContractTerminationPeriodMonths:Value(txtContractTerminationPeriodMonths.Text)},
                		{DMSContractTerminationWithoutReason:cbContractTerminationWithoutReason.Value},
                		{'Contract Title':txtContractDescription.Text},
                        {'Budget Owner':cbContractBudgetOwnerValue},
                        {'Budget Owner E-mail':First(cbContractBudgetOwnerValue).Email},
                        {'Budget Owner Name':First(cbContractBudgetOwnerValue).DisplayName}
                    );        
                );
                Set(ContractSHPItem,LookUp(DMSContract,ID = NewContractSHPItem.ID));
                If(customFormMode = FormMode.New,
                    Patch(
                        DMSContract,
                        LookUp(DMSContract,ID = NewContractSHPItem.ID),
                        {Title:"CON" &  Text(NewContractSHPItem.ID,"[$-en-US]000000")},
                        {Contract:"CON" &  Text(NewContractSHPItem.ID,"[$-en-US]000000")}
                    );
                    Set(ContractSHPItem,LookUp(DMSContract,ID = NewContractSHPItem.ID));
                    Set(ContractSHPItemID,ContractSHPItem.ID);
                    Set(customFormMode, FormMode.Edit);
                    UpdateContext({showLoading: true});
                    Reset(txtContractNumber);
                );
                
                //DMS_WriteLog.Run(Now(),1,ContractSHPItem.DMSContractProcessActualPhase,txtContractLogEventDescription.Text,User().Email,OrderSHPItem.ID);
                Reset(txtContractLogEventDescription);
                Refresh(DMSProcessLog);
                
                	// COMMENT
                	Patch(
                		DMSContract,
                		LookUp(DMSContract,ID = ContractSHPItemID),
                		{DMSContractActionDate:Now()},
                        {'Delegate to':First(cbContractDelegateToValue)},
                		{'Delegate to E-mail':First(cbDelegateTo_2.SelectedItems).Mail},
                		{DMSContractActionDescription:txtDelagateToDescription_2.Text},
                		{'Action Required':"START DELEGATE"},
                		{'Action Required By':SHPMeClaim},
                		{DMSContractActionRequiredByEMail:SHPMeClaim.Email}
                	);
                
                	UpdateContext({popUpDelegateToVisibility: false});
                	Reset(txtCommnentDescription_2);
                	Reset(cbCommenter_2);
                    Set(customFormMode, FormMode.View);
                    Notify(LookUp(StringsProcess,AppKey="NotificationDelegated" && Language=SelectedLanguage,String) & " " & First(cbContractDelegateToValue).DisplayName,NotificationType.Success);
                    ,
                    Notify(LookUp(StringsProcess,AppKey="errEmptyField" && Language=SelectedLanguage,String),NotificationType.Error);
                );
            PressedBorderColor: =patternColor4.Fill
            PressedColor: =
            PressedFill: =ColorFade(patternColor3.Fill, 90%)
            Text: =LookUp(StringsOrder,AppKey="btnDelegate" && Language=SelectedLanguage,String)
            X: =521
            Y: =364
            ZIndex: =4

        btnClose_6 As button:
            BorderColor: =patternColor3.DisabledFill
            BorderThickness: =0.5
            Color: =RGBA(0, 0, 0, 1)
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =0.5
            HoverBorderColor: =patternColor4.Fill
            HoverColor: =
            HoverFill: =
            OnSelect: |-
                =UpdateContext({popUpDelegateToVisibility: false});
                Reset(txtDelagateToDescription_2);
                Reset(cbDelegateTo_2);
            PressedBorderColor: =patternColor4.Fill
            PressedColor: =
            PressedFill: =ColorFade(patternColor3.Fill, 90%)
            Text: =LookUp(StringsOrder,AppKey="btnClose" && Language=SelectedLanguage,String)
            X: =699
            Y: =364
            ZIndex: =5

        lblDelegateTo_2 As label:
            Color: =labelSettings.Color
            Font: =labelSettings.Font
            Size: =labelSettings.Size
            Text: =LookUp(StringsOrder,AppKey="lblDelegateTo" && Language=SelectedLanguage,String) & " *"
            Tooltip: =labelSettings.Tooltip
            Width: =162
            X: =437
            Y: =105
            ZIndex: =6

        lblDelagateToDescription_2 As label:
            Color: =labelSettings.Color
            Font: =labelSettings.Font
            Size: =labelSettings.Size
            Text: =LookUp(StringsOrder,AppKey="lblDescription" && Language=SelectedLanguage,String) & " *"
            Tooltip: =labelSettings.Tooltip
            Width: =162
            X: =437
            Y: =158
            ZIndex: =10

        txtDelagateToDescription_2 As text:
            BorderColor: =If(txtDelagateToDescription_validation,patternColor3.Fill,patternColor6.Fill)
            BorderThickness: =1
            Default: =""
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =1
            Height: =122
            HoverBorderColor: =patternColor4.Fill
            HoverFill: =ColorFade(patternColor3.Fill, 90%)
            Mode: =TextMode.MultiLine
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =328
            X: =615
            Y: =158
            ZIndex: =11

        cbDelegateTo_2 As combobox:
            BorderColor: =If(cbDelegateTo_validation,patternColor3.Fill,patternColor6.Fill)
            BorderThickness: =1
            ChevronBackground: =
            ChevronFill: =patternColor1.Fill
            ChevronHoverBackground: =patternColor4.Fill
            DefaultSelectedItems: =
            DisplayFields: =["DisplayName","Mail"]
            DisplayMode: |-
                =If(customFormMode = FormMode.Edit || customFormMode = FormMode.New,
                    DisplayMode.Edit,
                    DisplayMode.View
                )
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =1
            HoverBorderColor: =patternColor4.Fill
            HoverFill: =ColorFade(patternColor3.Fill, 90%)
            InputTextPlaceholder: =LookUp(StringsOrder,AppKey="findItems" && Language=SelectedLanguage,String)
            Items: |-
                =ShowColumns(Office365Users.SearchUser({searchTerm:"",top: 999}),"DisplayName","Mail")
            PressedColor: =White
            SearchFields: =["DisplayName"]
            SearchItems: |-
                =Search(ShowColumns(Office365Users.SearchUser({searchTerm:"",top: 999}),"DisplayName","Mail"),cbDelegateTo_2.SearchText,"DisplayName")
            SelectionColor: =White
            SelectionFill: =patternColor4.Fill
            SelectMultiple: =false
            Tooltip: =
            X: =615
            Y: =105
            ZIndex: =12

    popUpNewContractAttachment As groupContainer:
        Fill: =RGBA(0, 0, 0, 0.1)
        Height: =695
        Visible: =popUpNewAttachmentVisibility
        Width: =Parent.Width
        X: =0*0
        Y: =73
        ZIndex: =5

        popUpAttachmentBody_2 As groupContainer:
            BorderColor: =patternColor1.Fill
            BorderThickness: =2
            Fill: =White
            Height: =492
            Width: =573
            X: =404
            Y: =89
            ZIndex: =1

            frmContractAttachments As form:
                AcceptsFocus: =false
                DataSource: =DMSContract
                Height: =381
                Item: =LookUp(DMSContract,ID = ContractSHPItemID)
                NumberOfColumns: =1
                Width: =573
                Y: =48
                ZIndex: =12

                dcAttachments_2 As typedDataCard.attachmentsEditCard:
                    BorderColor: =patternColor1.Fill
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="{Attachments}"
                    Default: =ThisItem.Attachments
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Attachments"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =50
                    Required: =false
                    Update: =DataCardValue46_2.Attachments
                    Width: =573
                    X: =0
                    Y: =0
                    ZIndex: =13

                    DataCardKey46_2 As label:
                        AutoHeight: =true
                        Color: =RGBA(0, 0, 0, 1)
                        Height: =34
                        Text: =Parent.DisplayName
                        Width: =Parent.Width - 60
                        Wrap: =false
                        X: =30
                        Y: =10
                        ZIndex: =1

                    DataCardValue46_2 As attachments:
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        DisplayMode: =Parent.DisplayMode
                        IsInDataCard: =true
                        ItemFill: =patternColor1.Fill
                        ItemPressedFill: =patternColor4.Fill
                        Items: =Parent.Default
                        NoAttachmentsText: ="There is no attachment."
                        PaddingBottom: =5
                        PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedFill: =patternColor4.Fill
                        Tooltip: =Parent.DisplayName
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardKey46_2.Y + DataCardKey46_2.Height + 5
                        ZIndex: =2

                    ErrorMessage46_2 As label:
                        AutoHeight: =true
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue46_2.Y + DataCardValue46_2.Height
                        ZIndex: =3

                    StarVisible46_2 As label:
                        Align: =Align.Center
                        Color: =RGBA(0, 0, 0, 1)
                        Height: =DataCardKey46_2.Height
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey46_2.Y
                        ZIndex: =4

        popUpAttachmentButtons_2 As groupContainer:
            Fill: =Transparent
            Height: =62
            Width: =573
            X: =404
            Y: =519
            ZIndex: =3

            btnSafeItem_2 As button:
                BorderColor: =patternColor3.DisabledFill
                BorderThickness: =0.5
                Color: =RGBA(0, 0, 0, 1)
                Fill: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =patternColor4.Fill
                FocusedBorderThickness: =0.5
                HoverBorderColor: =patternColor4.Fill
                HoverColor: =
                HoverFill: =
                OnSelect: |-
                    =If(SubmitForm(frmContractAttachments),
                        Select(btnContractSave);
                        DMS_ContractsCreateAttachmentFile.Run(ContractSHPItemID);
                        UpdateContext({popUpNewAttachmentVisibility: false});
                        //DMS_WriteLog.Run(Now(),2,ContractSHPItem.DMSContractProcessActualPhase,"",User().Email,ContractSHPItem.ID);
                        Refresh(DMSProcessLog);
                        ResetForm(frmContractAttachments);
                        //UpdateContext({showLoadingNewItem: true});
                        UpdateContext({showLoadingItemsCount: CountRows(glrOrderAttachments_2.AllItems)});
                    )
                PressedBorderColor: =patternColor4.Fill
                PressedColor: =
                PressedFill: =ColorFade(patternColor3.Fill, 90%)
                Text: =LookUp(StringsOrder,AppKey="btnOrdSave" && Language=SelectedLanguage,String)
                X: =112
                Y: =8
                ZIndex: =3

            btnClose_4 As button:
                BorderColor: =patternColor3.DisabledFill
                BorderThickness: =0.5
                Color: =RGBA(0, 0, 0, 1)
                Fill: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =patternColor4.Fill
                FocusedBorderThickness: =0.5
                HoverBorderColor: =patternColor4.Fill
                HoverColor: =
                HoverFill: =
                OnSelect: |-
                    =UpdateContext({popUpNewAttachmentVisibility: false});
                    ResetForm(frmContractAttachments);
                PressedBorderColor: =patternColor4.Fill
                PressedColor: =
                PressedFill: =ColorFade(patternColor3.Fill, 90%)
                Text: =LookUp(StringsOrder,AppKey="btnClose" && Language=SelectedLanguage,String)
                X: =290
                Y: =8
                ZIndex: =4

        popUpAttachmentHeader_2 As groupContainer:
            Fill: =White
            Height: =49
            Width: =573
            X: =404
            Y: =89
            ZIndex: =4

            popUpHeader_7 As rectangle:
                BorderColor: =patternColor1.Fill
                BorderThickness: =2
                Fill: =patternColor1.Fill
                Height: =48
                Width: =573
                ZIndex: =1

            popUpLabelOrderItem_7 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                Height: =48
                OnSelect: =
                Size: =18
                Text: =LookUp(StringsOrder,AppKey="lblNewOrderItem" && Language=SelectedLanguage,String)
                Width: =573
                Y: =1
                ZIndex: =2

    popUpComment_2 As groupContainer:
        Fill: =RGBA(0, 0, 0, 0.1)
        Height: =695
        Visible: =popUpCommentVisibility
        Width: =Parent.Width
        X: =0*0
        Y: =73
        ZIndex: =6

        popUpFooter_7 As rectangle:
            BorderColor: =patternColor1.Fill
            BorderThickness: =2
            Fill: =White
            Height: =405
            Width: =573
            X: =404
            Y: =28
            ZIndex: =1

        popUpHeader_11 As rectangle:
            BorderColor: =patternColor1.Fill
            BorderThickness: =2
            Fill: =patternColor1.Fill
            Height: =48
            Width: =573
            X: =404
            Y: =28
            ZIndex: =2

        popUpLabelOrderItem_11 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Height: =48
            Size: =18
            Text: =LookUp(StringsOrder,AppKey="btnOrdComment" && Language=SelectedLanguage,String)
            Width: =573
            X: =404
            Y: =28
            ZIndex: =3

        btnComment_2 As button:
            BorderColor: =patternColor3.DisabledFill
            BorderThickness: =0.5
            Color: =RGBA(0, 0, 0, 1)
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =0.5
            HoverBorderColor: =patternColor4.Fill
            HoverColor: =
            HoverFill: =
            OnSelect: |-
                =If(
                    IsBlank(txtContractFinValue.Text),
                    UpdateContext({txtContractFinValue_validation: false}),
                    UpdateContext({txtContractFinValue_validation: true})
                );
                
                If(IsBlank(txtCommnentDescription_2.Text),
                   UpdateContext({txtDelagateToDescription_validation: false}),
                   UpdateContext({txtDelagateToDescription_validation: true})
                );
                If(IsEmpty(cbCommenter_2.SelectedItems) || IsBlank(cbCommenter_2.SelectedItems),
                   UpdateContext({cbDelegateTo_validation: false}),
                   UpdateContext({cbDelegateTo_validation: true})
                );
                
                
                If(
                    txtDelagateToDescription_validation && cbDelegateTo_validation && txtContractFinValue_validation,
                
                    If(IsBlank(cbContractOwner.SelectedItems) || IsEmpty(cbContractOwner.SelectedItems),
                        Set(cbContractOwnerValue,BlankPeople),
                        Set(cbContractOwnerValue,
                            Table({'@odata.type':"#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                            Claims:"i:0#.f|membership|" & First(cbContractOwner.SelectedItems).Mail,
                            Department:"",
                            DisplayName:First(cbContractOwner.SelectedItems).DisplayName,
                            Email:First(cbContractOwner.SelectedItems).Mail,
                            JobTitle:".",
                            Picture:"."})
                        )
                    );
                
                    If(IsBlank(cbCommenter_2.SelectedItems) || IsEmpty(cbCommenter_2.SelectedItems),
                		Set(cbContractCommenterValue,BlankPeople),
                		Set(cbContractCommenterValue,
                			Table({'@odata.type':"#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                			Claims:"i:0#.f|membership|" & Lower(First(cbCommenter_2.SelectedItems).Mail),
                			Department:"",
                			DisplayName:First(cbCommenter_2.SelectedItems).DisplayName,
                			Email:First(cbCommenter_2.SelectedItems).Mail,
                			JobTitle:".",
                			Picture:"."})
                		)
                	);
                
                    If(IsBlank(cbContractDepartment.SelectedItems) || IsEmpty(cbContractDepartment.SelectedItems),
                        Set(cbContractBudgetOwnerValue,BlankPeople),
                        Set(cbContractBudgetOwnerValue,
                            Table({'@odata.type':"#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                            Claims:"i:0#.f|membership|" & Lower(First(cbContractDepartment.SelectedItems).'Budget Owner E-mail'),
                            Department:"",
                            DisplayName:First(cbContractDepartment.SelectedItems).'Budget Owner Name',
                            Email:First(cbContractDepartment.SelectedItems).'Budget Owner E-mail',
                            JobTitle:".",
                            Picture:"."})
                        )
                    );
                
                Set(NewContractSHPItem,
                    Patch(
                        DMSContract,
                        If(customFormMode = FormMode.New,Defaults(DMSContract),LookUp(DMSContract,ID = ContractSHPItemID)),
                        //Defaults(DMSContract),
                        {Title: txtContractNumber.Text},
                		{DMSContractAmendment:cbContractAmendment.Value},
                		{DMSContractAmendmentNumber:txtContractAmendment.Text},
                		{DMSContractAutomaticRenewal:cbContractAutomaticRenewal.Value},
                		{'Date of Expiration':dpContractDateOfExpiration.Value},
                		{DMSContractDateOfSignature:dpContractDateOfSignature.Value},
                		{DMSContractDateReceived:dpContractDateReceived.Value},
                		{DMSContractDateSent:dpContractDateSent.Value},
                		{DMSContractDepartmentCode:First(cbContractDepartment.SelectedItems).'Cost Center Code'},
                		{'Cost Center':First(cbContractDepartment.SelectedItems).'Name (DMSDepartmentName)'},
                		{DMSContractDuration:First(cbContractDuration.SelectedItems)},
                		{'Financial Value':Value(txtContractFinValue.Text)},
                		{'Contract Currency':First(cbContractFinValueCurrency.SelectedItems).Currency},
                		{'Contract Exchange Rate':Value(txtContractFinValueExchRate.Text)},
                		{'Value in Local Currency':Value(txtContractFinValueLocalCurrency.Text)},
                		{'In Budget':cbContractInBudget.Value},
                		{'Legal Entity Code':First(cbContractLegalEntity.SelectedItems).'Legal Entity Code'},
                		{'Legal Entity':First(cbContractLegalEntity.SelectedItems).'Legal Entity Name'},
                		{'Legal Entity Type':LookUp(Choices([@DMSContract].'Legal Entity Type'),Value = First(cbContractLegalEntity.SelectedItems).'Legal Entity Type')},
                		{'Liability Limit':cbContractLiabilityLimit.Value},
                		{DMSContractLiabilityLimitValue:Value(txtContractLiabilityLimitValue.Text)},
                		{DMSContractNotes:txtContractNotes.Text},
                		{Contract:txtContractNumber.Text},
                		{'Contract Owner':cbContractOwnerValue},
                		{DMSContractPartyCode1:First(cbContractPartyCode1.SelectedItems).'ERP Code'},
                		{DMSContractPartyCode2:First(cbContractPartyCode2.SelectedItems).'ERP Code'},
                		{DMSContractPartyCode3:First(cbContractPartyCode3.SelectedItems).'ERP Code'},
                		{DMSContractPartyCode4:First(cbContractPartyCode4.SelectedItems).'ERP Code'},
                		{DMSContractPartyID1:txtContractPartyRegID1.Text},
                		{DMSContractPartyID2:txtContractPartyRegID2.Text},
                		{DMSContractPartyID3:txtContractPartyRegID3.Text},
                		{DMSContractPartyID4:txtContractPartyRegID4.Text},
                		{'Contract Party 1':txtContractPartyName1.Text},
                		{DMSContractPartyName2:txtContractPartyName2.Text},
                		{DMSContractPartyName3:txtContractPartyName3.Text},
                		{DMSContractPartyName4:txtContractPartyName4.Text},
                		{DMSContractPrintsNumberHEU:Value(txtContractPrintsNumberHEU.Text)},
                		{DMSContractPrintsNumberOther:Value(txtContractPrintsNumberOther.Text)},
                		{DMSContractPrintsNumberTotal:Value(txtContractPrintsNumberTotal.Text)},
                		{'Process Note':txtContractLogEventDescription.Text},
                		{Reason:txtContractReason.Text},
                		{'Reserved Matters':cbContractReservedMatters.Value},
                		//{DMSContractState:},
                        {'Actual Phase':If(customFormMode = FormMode.New,"10",ContractSHPItem.'Actual Phase')},
                        {'Actual Owner':If(customFormMode = FormMode.New,Table(SHPMeClaim),ContractSHPItem.'Actual Owner')},
                        {'Actual Owner E-mail':If(customFormMode = FormMode.New,SHPMeClaim.Email,ContractSHPItem.'Actual Owner E-mail')},
                        {'Actual Owner Name':If(customFormMode = FormMode.New,SHPMeClaim.DisplayName,ContractSHPItem.'Actual Owner Name')},
                		{'Contract Subject':txtContractSubject.Text},
                		{DMSContractTerminationPeriodMonths:Value(txtContractTerminationPeriodMonths.Text)},
                		{DMSContractTerminationWithoutReason:cbContractTerminationWithoutReason.Value},
                		{'Contract Title':txtContractDescription.Text},
                        {'Budget Owner':cbContractBudgetOwnerValue},
                        {'Budget Owner E-mail':First(cbContractBudgetOwnerValue).Email},
                        {'Budget Owner Name':First(cbContractBudgetOwnerValue).DisplayName}
                    );        
                );
                Set(ContractSHPItem,LookUp(DMSContract,ID = NewContractSHPItem.ID));
                If(customFormMode = FormMode.New,
                    Patch(
                        DMSContract,
                        LookUp(DMSContract,ID = NewContractSHPItem.ID),
                        {Title:"CON" &  Text(NewContractSHPItem.ID,"[$-en-US]000000")},
                        {Contract:"CON" &  Text(NewContractSHPItem.ID,"[$-en-US]000000")}
                    );
                    Set(ContractSHPItem,LookUp(DMSContract,ID = NewContractSHPItem.ID));
                    Set(ContractSHPItemID,ContractSHPItem.ID);
                    Set(customFormMode, FormMode.Edit);
                    UpdateContext({showLoading: true});
                    Reset(txtContractNumber);
                );
                
                //DMS_WriteLog.Run(Now(),1,ContractSHPItem.DMSContractProcessActualPhase,txtContractLogEventDescription.Text,User().Email,OrderSHPItem.ID);
                    Reset(txtContractLogEventDescription);
                    Refresh(DMSProcessLog);
                    
                	// COMMENT
                	Patch(
                		DMSContract,
                		LookUp(DMSContract,ID = ContractSHPItemID),
                		{DMSContractActionDate:Now()},
                        {'Delegate to':First(cbContractCommenterValue)},
                		{'Delegate to E-mail':First(cbCommenter_2.SelectedItems).Mail},
                		{DMSContractActionDescription:txtCommnentDescription_2.Text},
                		{'Action Required':"START COMMENT"},
                		{'Action Required By':SHPMeClaim},
                		{DMSContractActionRequiredByEMail:SHPMeClaim.Email}
                	);
                
                	UpdateContext({popUpCommentVisibility: false});
                	Reset(txtCommnentDescription_2);
                	Reset(cbCommenter_2);
                    Set(customFormMode, FormMode.View);
                    Notify(LookUp(StringsProcess,AppKey="NotificationCommentedTo" && Language=SelectedLanguage,String) & " " & First(cbContractCommenterValue).DisplayName,NotificationType.Success);
                    ,
                    Notify(LookUp(StringsProcess,AppKey="errEmptyField" && Language=SelectedLanguage,String),NotificationType.Error);
                );
            PressedBorderColor: =patternColor4.Fill
            PressedColor: =
            PressedFill: =ColorFade(patternColor3.Fill, 90%)
            Text: =LookUp(StringsOrder,AppKey="btnComment" && Language=SelectedLanguage,String)
            X: =521
            Y: =364
            ZIndex: =4

        btnClose_9 As button:
            BorderColor: =patternColor3.DisabledFill
            BorderThickness: =0.5
            Color: =RGBA(0, 0, 0, 1)
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =0.5
            HoverBorderColor: =patternColor4.Fill
            HoverColor: =
            HoverFill: =
            OnSelect: |-
                =UpdateContext({popUpCommentVisibility: false});
                UpdateContext({txtDelagateToDescription_validation: true});
                UpdateContext({cbDelegateTo_validation: true});
                
                Reset(txtCommnentDescription_2);
                Reset(cbCommenter_2);
            PressedBorderColor: =patternColor4.Fill
            PressedColor: =
            PressedFill: =ColorFade(patternColor3.Fill, 90%)
            Text: =LookUp(StringsOrder,AppKey="btnClose" && Language=SelectedLanguage,String)
            X: =699
            Y: =364
            ZIndex: =5

        lblCommenter_2 As label:
            Color: =labelSettings.Color
            Font: =labelSettings.Font
            Size: =labelSettings.Size
            Text: =LookUp(StringsOrder,AppKey="lblCommenter" && Language=SelectedLanguage,String) & " *"
            Tooltip: =labelSettings.Tooltip
            Width: =162
            X: =437
            Y: =105
            ZIndex: =6

        lblDelagateToDescription_5 As label:
            Color: =labelSettings.Color
            Font: =labelSettings.Font
            Size: =labelSettings.Size
            Text: =LookUp(StringsOrder,AppKey="lblDescription" && Language=SelectedLanguage,String) & " *"
            Tooltip: =labelSettings.Tooltip
            Width: =162
            X: =437
            Y: =158
            ZIndex: =10

        txtCommnentDescription_2 As text:
            BorderColor: =If(txtDelagateToDescription_validation,patternColor3.Fill,patternColor6.Fill)
            BorderThickness: =1
            Default: =""
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =1
            Height: =122
            HoverBorderColor: =patternColor4.Fill
            HoverFill: =ColorFade(patternColor3.Fill, 90%)
            Mode: =TextMode.MultiLine
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =328
            X: =615
            Y: =158
            ZIndex: =11

        cbCommenter_2 As combobox:
            BorderColor: =If(cbDelegateTo_validation,patternColor3.Fill,patternColor6.Fill)
            BorderThickness: =1
            ChevronBackground: =
            ChevronFill: =patternColor1.Fill
            ChevronHoverBackground: =patternColor4.Fill
            DefaultSelectedItems: =
            DisplayFields: =["DisplayName","Mail"]
            DisplayMode: |-
                =If(customFormMode = FormMode.Edit || customFormMode = FormMode.New,
                    DisplayMode.Edit,
                    DisplayMode.View
                )
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =1
            HoverBorderColor: =patternColor4.Fill
            HoverFill: =ColorFade(patternColor3.Fill, 90%)
            InputTextPlaceholder: =LookUp(StringsOrder,AppKey="findItems" && Language=SelectedLanguage,String)
            Items: |-
                =ShowColumns(Office365Users.SearchUser({searchTerm:"",top: 999}),"DisplayName","Mail")
            PressedColor: =White
            SearchFields: =["DisplayName"]
            SearchItems: |-
                =Search(ShowColumns(Office365Users.SearchUser({searchTerm:"",top: 999}),"DisplayName","Mail"),cbCommenter_2.SearchText,"DisplayName")
            SelectionColor: =White
            SelectionFill: =patternColor4.Fill
            SelectMultiple: =false
            Tooltip: =
            X: =615
            Y: =105
            ZIndex: =12

    popUpLogItemDetail_2 As groupContainer:
        Fill: =RGBA(0, 0, 0, 0.1)
        Height: =695
        Visible: =popUpLogItemDetailVisibility
        Width: =Parent.Width
        X: =0*0
        Y: =73
        ZIndex: =7

        popUpItemBody_5 As groupContainer:
            BorderColor: =patternColor1.Fill
            BorderThickness: =2
            Fill: =White
            Height: =502
            Width: =573
            X: =404
            Y: =28
            ZIndex: =1

            txtLogDetailPhase_2 As text:
                BorderColor: =patternColor3.Fill
                BorderThickness: =1
                Default: =LookUp(StatesContract,AppKey = Value(glrProcessHistoryItems_2.Selected.DMSLogItemPhase) && Language = SelectedLanguage,String) & " (" & glrProcessHistoryItems_2.Selected.DMSLogItemPhase & ")"
                DisplayMode: =DisplayMode.Disabled
                FocusedBorderColor: =patternColor4.Fill
                FocusedBorderThickness: =1
                HoverBorderColor: =patternColor4.Fill
                HoverFill: =ColorFade(patternColor3.Fill, 90%)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Width: =381
                X: =176
                Y: =lblLogDetailPhase_2.Y
                ZIndex: =1

            lblLogDetailPhase_2 As label:
                Color: =labelSettings.Color
                Font: =labelSettings.Font
                Size: =labelSettings.Size
                Text: =LookUp(StringsProcess,AppKey="lblLogDetailPhase" && Language=SelectedLanguage,String)
                Tooltip: =labelSettings.Tooltip
                Width: =190
                X: =10
                Y: =110
                ZIndex: =2

            txtLogDetailDescription_2 As text:
                BorderColor: =patternColor3.Fill
                BorderThickness: =1
                Default: =glrProcessHistoryItems_2.Selected.DMSLogEventDescription
                DisplayMode: =DisplayMode.Disabled
                FocusedBorderColor: =patternColor4.Fill
                FocusedBorderThickness: =1
                Height: =156
                HoverBorderColor: =patternColor4.Fill
                HoverFill: =ColorFade(patternColor3.Fill, 90%)
                Mode: =TextMode.MultiLine
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Width: =380
                X: =txtLogDetailPhase_2.X
                Y: =275
                ZIndex: =3

            lblLogDetailUser_2 As label:
                Color: =labelSettings.Color
                Font: =labelSettings.Font
                Size: =labelSettings.Size
                Text: =LookUp(StringsProcess,AppKey="lblLogDetailUser" && Language=SelectedLanguage,String)
                Tooltip: =labelSettings.Tooltip
                Width: =190
                X: =lblLogDetailPhase_2.X
                Y: =lblLogDetailPhase_2.Y + 50
                ZIndex: =5

            lblLogDetailTitle_2 As label:
                Color: =labelSettings.Color
                Font: =labelSettings.Font
                Size: =labelSettings.Size
                Text: =LookUp(StringsProcess,AppKey="lblLogDetailTitle" && Language=SelectedLanguage,String)
                Tooltip: =labelSettings.Tooltip
                Width: =190
                X: =lblLogDetailPhase_2.X
                Y: =lblLogDetailPhase_2.Y +100
                ZIndex: =6

            lblLogDetailDescription_2 As label:
                Color: =labelSettings.Color
                Font: =labelSettings.Font
                Size: =labelSettings.Size
                Text: =LookUp(StringsProcess,AppKey="lblLogDetailDescription" && Language=SelectedLanguage,String)
                Tooltip: =labelSettings.Tooltip
                Width: =190
                X: =lblLogDetailPhase_2.X
                Y: =275
                ZIndex: =7

            lblLogDetailLogDate_2 As label:
                Color: =labelSettings.Color
                Font: =labelSettings.Font
                Size: =labelSettings.Size
                Text: =LookUp(StringsProcess,AppKey="lblLogDetailLogDate" && Language=SelectedLanguage,String)
                Tooltip: =labelSettings.Tooltip
                Width: =190
                X: =10
                Y: =60
                ZIndex: =8

            txtLogDetailLogDate_2 As text:
                BorderColor: =patternColor3.Fill
                BorderThickness: =1
                Default: |-
                    =Text(glrProcessHistoryItems_2.Selected.DMSLogDate,"[$-en-US]dd.mm.yyyy hh:mm:ss")
                DisplayMode: =DisplayMode.Disabled
                FocusedBorderColor: =patternColor4.Fill
                FocusedBorderThickness: =1
                HoverBorderColor: =patternColor4.Fill
                HoverFill: =ColorFade(patternColor3.Fill, 90%)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Width: =380
                X: =176
                Y: =60
                ZIndex: =18

            txtLogDetailUser_2 As text:
                BorderColor: =patternColor3.Fill
                BorderThickness: =1
                Default: =glrProcessHistoryItems_2.Selected.DMSLogUserName
                DisplayMode: =DisplayMode.Disabled
                FocusedBorderColor: =patternColor4.Fill
                FocusedBorderThickness: =1
                HoverBorderColor: =patternColor4.Fill
                HoverFill: =ColorFade(patternColor3.Fill, 90%)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Width: =381
                X: =176
                Y: =160
                ZIndex: =19

            txtLogDetailTitle_2 As text:
                BorderColor: =patternColor3.Fill
                BorderThickness: =1
                Default: =glrProcessHistoryItems_2.Selected.DMSLogEventTitle
                DisplayMode: =DisplayMode.Disabled
                FocusedBorderColor: =patternColor4.Fill
                FocusedBorderThickness: =1
                Height: =52
                HoverBorderColor: =patternColor4.Fill
                HoverFill: =ColorFade(patternColor3.Fill, 90%)
                Mode: =TextMode.MultiLine
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Width: =380
                X: =176
                Y: =210
                ZIndex: =20

        popUpItemButtons_6 As groupContainer:
            Fill: =Transparent
            Height: =62
            Width: =573
            X: =404
            Y: =468
            ZIndex: =3

            btnClose2_5 As button:
                BorderColor: =patternColor3.DisabledFill
                BorderThickness: =0.5
                Color: =RGBA(0, 0, 0, 1)
                Fill: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =patternColor4.Fill
                FocusedBorderThickness: =0.5
                HoverBorderColor: =patternColor4.Fill
                HoverColor: =
                HoverFill: =
                OnSelect: |-
                    =UpdateContext({popUpLogItemDetailVisibility: false});
                PressedBorderColor: =patternColor4.Fill
                PressedColor: =
                PressedFill: =ColorFade(patternColor3.Fill, 90%)
                Text: =LookUp(StringsOrder,AppKey="btnClose" && Language=SelectedLanguage,String)
                X: =210
                Y: =10
                ZIndex: =4

        popUpItemHeader_5 As groupContainer:
            Fill: =White
            Height: =49
            Width: =573
            X: =404
            Y: =28
            ZIndex: =4

            popUpHeader_16 As rectangle:
                BorderColor: =patternColor1.Fill
                BorderThickness: =2
                Fill: =patternColor1.Fill
                Height: =48
                Width: =573
                ZIndex: =1

            lblPopUpLogDetailHeader_2 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                Height: =48
                Size: =18
                Text: =LookUp(StringsProcess,AppKey="LogDetailHeader" && Language=SelectedLanguage,String)
                Width: =573
                ZIndex: =2

    popUpReopen_2 As groupContainer:
        Fill: =RGBA(0, 0, 0, 0.1)
        Height: =695
        Visible: =popUpReopenVisibility
        Width: =Parent.Width
        X: =0*0
        Y: =73
        ZIndex: =8

        popUpFooter_11 As rectangle:
            BorderColor: =patternColor1.Fill
            BorderThickness: =2
            Fill: =White
            Height: =405
            Width: =573
            X: =404
            Y: =28
            ZIndex: =1

        popUpHeader_19 As rectangle:
            BorderColor: =patternColor1.Fill
            BorderThickness: =2
            Fill: =patternColor1.Fill
            Height: =48
            Width: =573
            X: =404
            Y: =28
            ZIndex: =2

        popUpLabelReopen_2 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Height: =48
            Size: =18
            Text: =LookUp(StringsOrder,AppKey="popUpLabelReopen" && Language=SelectedLanguage,String)
            Width: =573
            X: =404
            Y: =28
            ZIndex: =3

        btnReopen_2 As button:
            BorderColor: =patternColor3.DisabledFill
            BorderThickness: =0.5
            Color: =RGBA(0, 0, 0, 1)
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =0.5
            HoverBorderColor: =patternColor4.Fill
            HoverColor: =
            HoverFill: =
            OnSelect: |-
                =/*If(IsBlank(txtReopenDescription_2.Text),
                   UpdateContext({txtReturnToDescription_validation: false}),
                   UpdateContext({txtReturnToDescription_validation: true})
                );*/
                
                If(IsEmpty(cbReturnTo_2.SelectedItems) || IsBlank(cbReturnTo_2.SelectedItems),
                   UpdateContext({cbReturnTo_validation: false}),
                   UpdateContext({cbReturnTo_validation: true})
                );
                
                
                If(
                    txtReturnToDescription_validation && cbReturnTo_validation,
                
                    If(IsBlank(cbContractOwner.SelectedItems) || IsEmpty(cbContractOwner.SelectedItems),
                        Set(cbContractOwnerValue,BlankPeople),
                        Set(cbContractOwnerValue,
                            Table({'@odata.type':"#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                            Claims:"i:0#.f|membership|" & First(cbContractOwner.SelectedItems).Mail,
                            Department:"",
                            DisplayName:First(cbContractOwner.SelectedItems).DisplayName,
                            Email:First(cbContractOwner.SelectedItems).Mail,
                            JobTitle:".",
                            Picture:"."})
                        )
                    );
                
                    If(IsBlank(cbReturnTo_2.SelectedItems) || IsEmpty(cbReturnTo_2.SelectedItems),
                		Set(cbReturnToValue,BlankPeople),
                		Set(cbReturnToValue,
                			Table({'@odata.type':"#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                			Claims:"i:0#.f|membership|" & Lower(First(cbReturnTo_2.SelectedItems).Mail),
                			Department:"",
                			DisplayName:First(cbReturnTo_2.SelectedItems).DisplayName,
                			Email:First(cbReturnTo_2.SelectedItems).Mail,
                			JobTitle:".",
                			Picture:"."})
                		)
                	);
                
                    If(IsBlank(cbContractDepartment.SelectedItems) || IsEmpty(cbContractDepartment.SelectedItems),
                        Set(cbContractBudgetOwnerValue,BlankPeople),
                        Set(cbContractBudgetOwnerValue,
                            Table({'@odata.type':"#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                            Claims:"i:0#.f|membership|" & Lower(First(cbContractDepartment.SelectedItems).'Budget Owner E-mail'),
                            Department:"",
                            DisplayName:First(cbContractDepartment.SelectedItems).'Budget Owner Name',
                            Email:First(cbContractDepartment.SelectedItems).'Budget Owner E-mail',
                            JobTitle:".",
                            Picture:"."})
                        )
                    );
                
                Set(NewContractSHPItem,
                    Patch(
                        DMSContract,
                        If(customFormMode = FormMode.New,Defaults(DMSContract),LookUp(DMSContract,ID = ContractSHPItemID)),
                        //Defaults(DMSContract),
                        {Title: txtContractNumber.Text},
                		{DMSContractAmendment:cbContractAmendment.Value},
                		{DMSContractAmendmentNumber:txtContractAmendment.Text},
                		{DMSContractAutomaticRenewal:cbContractAutomaticRenewal.Value},
                		{'Date of Expiration':dpContractDateOfExpiration.Value},
                		{DMSContractDateOfSignature:dpContractDateOfSignature.Value},
                		{DMSContractDateReceived:dpContractDateReceived.Value},
                		{DMSContractDateSent:dpContractDateSent.Value},
                		{DMSContractDepartmentCode:First(cbContractDepartment.SelectedItems).'Cost Center Code'},
                		{'Cost Center':First(cbContractDepartment.SelectedItems).'Name (DMSDepartmentName)'},
                		{DMSContractDuration:First(cbContractDuration.SelectedItems)},
                		{'Financial Value':Value(txtContractFinValue.Text)},
                		{'Contract Currency':First(cbContractFinValueCurrency.SelectedItems).Currency},
                		{'Contract Exchange Rate':Value(txtContractFinValueExchRate.Text)},
                		{'Value in Local Currency':Value(txtContractFinValueLocalCurrency.Text)},
                		{'In Budget':cbContractInBudget.Value},
                		{'Legal Entity Code':First(cbContractLegalEntity.SelectedItems).'Legal Entity Code'},
                		{'Legal Entity':First(cbContractLegalEntity.SelectedItems).'Legal Entity Name'},
                		{'Legal Entity Type':LookUp(Choices([@DMSContract].'Legal Entity Type'),Value = First(cbContractLegalEntity.SelectedItems).'Legal Entity Type')},
                		{'Liability Limit':cbContractLiabilityLimit.Value},
                		{DMSContractLiabilityLimitValue:Value(txtContractLiabilityLimitValue.Text)},
                		{DMSContractNotes:txtContractNotes.Text},
                		{Contract:txtContractNumber.Text},
                		{'Contract Owner':cbContractOwnerValue},
                		{DMSContractPartyCode1:First(cbContractPartyCode1.SelectedItems).'ERP Code'},
                		{DMSContractPartyCode2:First(cbContractPartyCode2.SelectedItems).'ERP Code'},
                		{DMSContractPartyCode3:First(cbContractPartyCode3.SelectedItems).'ERP Code'},
                		{DMSContractPartyCode4:First(cbContractPartyCode4.SelectedItems).'ERP Code'},
                		{DMSContractPartyID1:txtContractPartyRegID1.Text},
                		{DMSContractPartyID2:txtContractPartyRegID2.Text},
                		{DMSContractPartyID3:txtContractPartyRegID3.Text},
                		{DMSContractPartyID4:txtContractPartyRegID4.Text},
                		{'Contract Party 1':txtContractPartyName1.Text},
                		{DMSContractPartyName2:txtContractPartyName2.Text},
                		{DMSContractPartyName3:txtContractPartyName3.Text},
                		{DMSContractPartyName4:txtContractPartyName4.Text},
                		{DMSContractPrintsNumberHEU:Value(txtContractPrintsNumberHEU.Text)},
                		{DMSContractPrintsNumberOther:Value(txtContractPrintsNumberOther.Text)},
                		{DMSContractPrintsNumberTotal:Value(txtContractPrintsNumberTotal.Text)},
                		{'Process Note':txtReopenDescription_2.Text},
                		{Reason:txtContractReason.Text},
                		{'Reserved Matters':cbContractReservedMatters.Value},
                		//{DMSContractState:},
                        {'Actual Phase':If(customFormMode = FormMode.New,"10",ContractSHPItem.'Actual Phase')},
                        {'Actual Owner':If(customFormMode = FormMode.New,Table(SHPMeClaim),ContractSHPItem.'Actual Owner')},
                        {'Actual Owner E-mail':If(customFormMode = FormMode.New,SHPMeClaim.Email,ContractSHPItem.'Actual Owner E-mail')},
                        {'Actual Owner Name':If(customFormMode = FormMode.New,SHPMeClaim.DisplayName,ContractSHPItem.'Actual Owner Name')},
                		{'Contract Subject':txtContractSubject.Text},
                		{DMSContractTerminationPeriodMonths:Value(txtContractTerminationPeriodMonths.Text)},
                		{DMSContractTerminationWithoutReason:cbContractTerminationWithoutReason.Value},
                		{'Contract Title':txtContractDescription.Text},
                        {'Budget Owner':cbContractBudgetOwnerValue},
                        {'Budget Owner E-mail':First(cbContractBudgetOwnerValue).Email},
                        {'Budget Owner Name':First(cbContractBudgetOwnerValue).DisplayName}
                    );        
                );
                Set(ContractSHPItem,LookUp(DMSContract,ID = NewContractSHPItem.ID));
                If(customFormMode = FormMode.New,
                    /*Patch(
                        DMSContract,
                        LookUp(DMSContract,ID = NewContractSHPItem.ID),
                        {DMSContractNumber:"CON" &  Text(NewContractSHPItem.ID,"[$-en-US]000000")}
                    );*/
                    Set(ContractSHPItem,LookUp(DMSContract,ID = NewContractSHPItem.ID));
                    Set(ContractSHPItemID,ContractSHPItem.ID);
                    Set(customFormMode, FormMode.Edit);
                    Reset(txtContractNumber);
                );
                
                //DMS_WriteLog.Run(Now(),1,ContractSHPItem.DMSContractProcessActualPhase,txtContractLogEventDescription.Text,User().Email,OrderSHPItem.ID);
                Reset(txtContractLogEventDescription);
                Refresh(DMSProcessLog);
                
                	// START REOPEN
                	Patch(
                		DMSContract,
                		LookUp(DMSContract,ID = ContractSHPItemID),
                		{DMSContractActionDate:Now()},
                        {'Delegate to':First(cbReturnToValue)},
                		{'Delegate to E-mail':First(cbReturnTo_2.SelectedItems).Mail},
                		{DMSContractActionDescription:txtReopenDescription_2.Text},
                		{'Action Required':"START REOPEN"},
                		{'Action Required By':SHPMeClaim},
                		{DMSContractActionRequiredByEMail:SHPMeClaim.Email}
                	);
                
                	UpdateContext({popUpReopenVisibility: false});
                	Reset(txtReopenDescription_2);
                	Reset(cbReturnTo_2);
                    Set(customFormMode, FormMode.View);
                    Notify(LookUp(StringsProcess,AppKey="NotificationReopened" && Language=SelectedLanguage,String) & " " & First(cbContractDelegateToValue).DisplayName,NotificationType.Success);
                    ,
                    Notify(LookUp(StringsProcess,AppKey="errEmptyField" && Language=SelectedLanguage,String),NotificationType.Error);
                );
            PressedBorderColor: =patternColor4.Fill
            PressedColor: =
            PressedFill: =ColorFade(patternColor3.Fill, 90%)
            Text: =LookUp(StringsOrder,AppKey="btnReopen" && Language=SelectedLanguage,String)
            X: =521
            Y: =364
            ZIndex: =4

        btnClose_12 As button:
            BorderColor: =patternColor3.DisabledFill
            BorderThickness: =0.5
            Color: =RGBA(0, 0, 0, 1)
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =0.5
            HoverBorderColor: =patternColor4.Fill
            HoverColor: =
            HoverFill: =
            OnSelect: |-
                =UpdateContext({popUpReopenVisibility: false});
                UpdateContext({cbReturnTo_validation: true});
                UpdateContext({txtReturnToDescription_validation: true});
                
                Reset(txtReopenDescription_2);
                Reset(cbReturnTo_2);
            PressedBorderColor: =patternColor4.Fill
            PressedColor: =
            PressedFill: =ColorFade(patternColor3.Fill, 90%)
            Text: =LookUp(StringsOrder,AppKey="btnClose" && Language=SelectedLanguage,String)
            X: =699
            Y: =364
            ZIndex: =5

        lblReturnTo_2 As label:
            Color: =labelSettings.Color
            Font: =labelSettings.Font
            Size: =labelSettings.Size
            Text: =LookUp(StringsOrder,AppKey="lblReturnTo" && Language=SelectedLanguage,String) & " *"
            Tooltip: =labelSettings.Tooltip
            Width: =162
            X: =437
            Y: =105
            ZIndex: =6

        lblReopenDescription_2 As label:
            Color: =labelSettings.Color
            Font: =labelSettings.Font
            Size: =labelSettings.Size
            Text: =LookUp(StringsOrder,AppKey="lblPoznamka" && Language=SelectedLanguage,String)
            Tooltip: =labelSettings.Tooltip
            Width: =162
            X: =437
            Y: =158
            ZIndex: =10

        txtReopenDescription_2 As text:
            BorderColor: =If(txtReturnToDescription_validation,patternColor3.Fill,patternColor6.Fill)
            BorderThickness: =1
            Default: =""
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =1
            Height: =122
            HoverBorderColor: =patternColor4.Fill
            HoverFill: =ColorFade(patternColor3.Fill, 90%)
            Mode: =TextMode.MultiLine
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =328
            X: =615
            Y: =158
            ZIndex: =11

        cbReturnTo_2 As combobox:
            BorderColor: =If(cbReturnTo_validation,patternColor3.Fill,patternColor6.Fill)
            BorderThickness: =1
            ChevronBackground: =
            ChevronFill: =patternColor1.Fill
            ChevronHoverBackground: =patternColor4.Fill
            DefaultSelectedItems: |-
                =Filter(ShowColumns(Office365Users.SearchUser({searchTerm:"",top: 999}),"DisplayName","Mail"),Mail = ContractSHPItem.'Budget Owner E-mail')
            DisplayFields: =["DisplayName","Mail"]
            DisplayMode: |-
                =If(customFormMode = FormMode.Edit || customFormMode = FormMode.New,
                    DisplayMode.Edit,
                    DisplayMode.View
                )
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =1
            HoverBorderColor: =patternColor4.Fill
            HoverFill: =ColorFade(patternColor3.Fill, 90%)
            InputTextPlaceholder: =LookUp(StringsOrder,AppKey="findItems" && Language=SelectedLanguage,String)
            Items: |-
                =ShowColumns(Office365Users.SearchUser({searchTerm:"",top: 999}),"DisplayName","Mail")
            PressedColor: =White
            SearchFields: =["DisplayName"]
            SearchItems: |-
                =Search(ShowColumns(Office365Users.SearchUser({searchTerm:"",top: 999}),"DisplayName","Mail"),cbReturnTo_2.SearchText,"DisplayName")
            SelectionColor: =White
            SelectionFill: =patternColor4.Fill
            SelectMultiple: =false
            Tooltip: =
            X: =615
            Y: =105
            ZIndex: =12

    popUpNewAttachmentLink As groupContainer:
        Fill: =RGBA(0, 0, 0, 0.1)
        Height: =695
        Visible: =popUpNewAttachmentLinkVisibility
        Width: =Parent.Width
        X: =0*0
        Y: =73
        ZIndex: =9

        popUpFooter_13 As rectangle:
            BorderColor: =patternColor1.Fill
            BorderThickness: =2
            Fill: =White
            Height: =405
            Width: =573
            X: =404
            Y: =28
            ZIndex: =1

        popUpHeader_21 As rectangle:
            BorderColor: =patternColor1.Fill
            BorderThickness: =2
            Fill: =patternColor1.Fill
            Height: =48
            Width: =573
            X: =404
            Y: =28
            ZIndex: =2

        popUpLabelAttachmentLink As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Height: =48
            Size: =18
            Text: =LookUp(StringsOrder,AppKey="popUpLabelAttachmentLink" && Language=SelectedLanguage,String)
            Width: =573
            X: =404
            Y: =28
            ZIndex: =3

        btnDelegate_3 As button:
            BorderColor: =patternColor3.DisabledFill
            BorderThickness: =0.5
            Color: =RGBA(0, 0, 0, 1)
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =0.5
            HoverBorderColor: =patternColor4.Fill
            HoverColor: =
            HoverFill: =
            OnSelect: |-
                =If(IsBlank(txtAttachmentLinkURL.Text),
                   UpdateContext({ttxtAttachmentLinkURL_validation: false}),
                   UpdateContext({ttxtAttachmentLinkURL_validation: true})
                );
                
                If(IsBlank(txtAttachmentLinkTitle.Text),
                   UpdateContext({txtAttachmentLinkTitle_validation: false}),
                   UpdateContext({txtAttachmentLinkTitle_validation: true})
                );
                
                If(
                    ttxtAttachmentLinkURL_validation && txtAttachmentLinkTitle_validation,
                
                    Set(ContractAttachmentLinkItem,Patch(
                        DMSContractLink,
                        If(popUpContractAttachmentLinkItemFormMode = FormMode.New,Defaults(DMSContractLink),LookUp(DMSContractLink, ID = popUpContractAttachmentLinkItemID)),
                        {Title: ContractSHPItem.ID},
                        {DMSContractLinkContractID: ContractSHPItem.ID},
                        {DMSContractLinkTitle: txtAttachmentLinkTitle.Text},
                        {DMSContractLinkURL: txtAttachmentLinkURL.Text}
                    )
                    );
                    
                    Refresh(DMSProcessLog);
                    UpdateContext({popUpContractAttachmentLinkItem: Blank()});
                    UpdateContext({popUpOrderItemOrderNumber: Blank()});
                
                    UpdateContext({popUpNewAttachmentLinkVisibility: false});
                    Reset(txtAttachmentLinkTitle);
                    Reset(txtAttachmentLinkURL);
                   
                    Notify(LookUp(StringsProcess,AppKey="NotificationItemSaved" && Language=SelectedLanguage,String),NotificationType.Success);
                    ,
                    Notify(LookUp(StringsProcess,AppKey="errEmptyField" && Language=SelectedLanguage,String),NotificationType.Error);
                );
            PressedBorderColor: =patternColor4.Fill
            PressedColor: =
            PressedFill: =ColorFade(patternColor3.Fill, 90%)
            Text: =LookUp(StringsOrder,AppKey="btnOrdSave" && Language=SelectedLanguage,String)
            X: =521
            Y: =364
            ZIndex: =4

        btnClose_14 As button:
            BorderColor: =patternColor3.DisabledFill
            BorderThickness: =0.5
            Color: =RGBA(0, 0, 0, 1)
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =0.5
            HoverBorderColor: =patternColor4.Fill
            HoverColor: =
            HoverFill: =
            OnSelect: |-
                =UpdateContext({popUpNewAttachmentLinkVisibility: false});
                Reset(txtAttachmentLinkURL);
                Reset(txtAttachmentLinkTitle);
            PressedBorderColor: =patternColor4.Fill
            PressedColor: =
            PressedFill: =ColorFade(patternColor3.Fill, 90%)
            Text: =LookUp(StringsOrder,AppKey="btnClose" && Language=SelectedLanguage,String)
            X: =699
            Y: =364
            ZIndex: =5

        lblAttachmentLinkTitle As label:
            Color: =labelSettings.Color
            Font: =labelSettings.Font
            Size: =labelSettings.Size
            Text: =LookUp(StringsOrder,AppKey="lblAttachmentLinkTitle" && Language=SelectedLanguage,String) & " *"
            Tooltip: =labelSettings.Tooltip
            Width: =162
            X: =437
            Y: =105
            ZIndex: =6

        lblAttachmentLinkURL As label:
            Color: =labelSettings.Color
            Font: =labelSettings.Font
            Size: =labelSettings.Size
            Text: =LookUp(StringsOrder,AppKey="lblAttachmentLinkURL" && Language=SelectedLanguage,String) & " *"
            Tooltip: =labelSettings.Tooltip
            Width: =162
            X: =437
            Y: =158
            ZIndex: =10

        txtAttachmentLinkURL As text:
            BorderColor: =If(ttxtAttachmentLinkURL_validation,patternColor3.Fill,patternColor6.Fill)
            BorderThickness: =1
            Default: =popUpContractAttachmentLinkItem.DMSContractLinkURL
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =1
            Height: =122
            HoverBorderColor: =patternColor4.Fill
            HoverFill: =ColorFade(patternColor3.Fill, 90%)
            Mode: =TextMode.MultiLine
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =328
            X: =615
            Y: =158
            ZIndex: =11

        txtAttachmentLinkTitle As text:
            BorderColor: =If(txtAttachmentLinkTitle_validation,patternColor3.Fill,patternColor6.Fill)
            BorderThickness: =1
            Default: =popUpContractAttachmentLinkItem.DMSContractLinkTitle
            FocusedBorderColor: =patternColor4.Fill
            FocusedBorderThickness: =1
            HoverBorderColor: =patternColor4.Fill
            HoverFill: =ColorFade(patternColor3.Fill, 90%)
            Mode: =TextMode.MultiLine
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =328
            X: =615
            Y: =105
            ZIndex: =12

    headerContracts As groupContainer:
        Fill: =Transparent
        Height: =73
        Width: =Parent.Width
        X: =0*0
        ZIndex: =10

        lblContractTitle As label:
            Align: =Align.Center
            BorderColor: =RGBA(166, 166, 166, 1)
            Color: =patternColor1.Fill
            Height: =73
            Text: =LookUp(StringsContract,AppKey="scrContract" && Language=SelectedLanguage,String)
            Width: =1366
            ZIndex: =2

        ContractHeurekaLogo As image:
            Height: =72
            Image: =heureka_group_logo
            Width: =240
            X: =30
            ZIndex: =3

        ContractHeaderOrder As rectangle:
            BorderColor: =patternColor3.Fill
            BorderThickness: =0.5
            Fill: =RGBA(0, 0, 0, 0)
            Height: =1
            Width: =Parent.Width
            Y: =72
            ZIndex: =4

        btnContractBack As icon.ChevronLeft:
            Color: =patternColor1.Fill
            Height: =40
            Icon: =Icon.ChevronLeft
            OnSelect: =Navigate(scrContractsTestMenu)
            Visible: =DebugMode
            Width: =40
            X: =1180
            Y: =16
            ZIndex: =5

        btnContractCloseApp As icon.ChevronLeft:
            Color: =patternColor1.Fill
            Height: =40
            Icon: =Icon.Cancel
            OnSelect: =
            Visible: =DebugMode
            Width: =40
            X: =1240
            Y: =17
            ZIndex: =6

        btnBackToMobile_2 As arrow.backArrow:
            Fill: =patternColor1.Fill
            Height: =35
            OnSelect: =Launch(txtWebAppURL)
            Visible: |-
                =!IsBlank(Acceleration.X)
                //true
            Width: =35
            X: =1240
            Y: =19
            ZIndex: =7

    scrDebugMode As groupContainer:
        Fill: =RGBA(0, 0, 0, 0.8)
        Height: =768
        Visible: =dbgWindow
        Width: =678
        X: =687
        ZIndex: =11

        Label5 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(0, 0, 0, 0.6)
            FontWeight: =FontWeight.Semibold
            Height: =71
            Text: ="DEBUG MODE"
            Width: =678
            ZIndex: =1

        Label6 As label:
            Color: =RGBA(255, 255, 255, 1)
            Text: |-
                ="User email:"
            X: =16
            Y: =117
            ZIndex: =2

        Label6_1 As label:
            Color: =RGBA(255, 255, 255, 1)
            Text: =User().Email
            Width: =439
            X: =222
            Y: =117
            ZIndex: =3

        Label6_2 As label:
            Color: =RGBA(255, 255, 255, 1)
            Text: |-
                ="ParamScreen:"
            X: =16
            Y: =193
            ZIndex: =4

        Label6_3 As label:
            Color: =RGBA(255, 255, 255, 1)
            Text: =ParamScreen
            Width: =439
            X: =221
            Y: =193
            ZIndex: =5

        Label6_4 As label:
            Color: =RGBA(255, 255, 255, 1)
            Text: |-
                ="ParamFormMode:"
            Width: =162
            X: =16
            Y: =233
            ZIndex: =6

        Label6_5 As label:
            Color: =RGBA(255, 255, 255, 1)
            Text: =ParamFormMode
            Width: =439
            X: =222
            Y: =233
            ZIndex: =7

        Label6_6 As label:
            Color: =RGBA(255, 255, 255, 1)
            Text: |-
                ="ContractSHPItemID:"
            Width: =176
            X: =16
            Y: =273
            ZIndex: =8

        Label6_7 As label:
            Color: =RGBA(255, 255, 255, 1)
            Text: =ContractSHPItemID
            Width: =439
            X: =222
            Y: =273
            ZIndex: =9

        Label6_8 As label:
            Color: =RGBA(255, 255, 255, 1)
            Text: |-
                ="customFormMode:"
            Width: =176
            X: =16
            Y: =313
            ZIndex: =10

        Label6_9 As label:
            Color: =RGBA(255, 255, 255, 1)
            Text: =customFormMode
            Width: =439
            X: =222
            Y: =313
            ZIndex: =11

        Label6_10 As label:
            Color: =RGBA(255, 255, 255, 1)
            Text: |-
                ="User name:"
            X: =16
            Y: =77
            ZIndex: =12

        Label6_11 As label:
            Color: =RGBA(255, 255, 255, 1)
            Text: =User().FullName
            Width: =439
            X: =222
            Y: =77
            ZIndex: =13

        Label5_1 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(0, 0, 0, 0.6)
            FontWeight: =FontWeight.Semibold
            Height: =71
            Text: |-
                ="version: " & appVersion
            Width: =678
            Y: =697
            ZIndex: =14

        Label6_24 As label:
            Color: =RGBA(255, 255, 255, 1)
            Text: |-
                ="User claim:"
            X: =16
            Y: =152
            ZIndex: =15

        Label6_25 As label:
            Color: =RGBA(255, 255, 255, 1)
            Text: =SHPMeClaim.Email
            Width: =439
            X: =222
            Y: =152
            ZIndex: =16

        Label2 As label:
            Text: ="Text"
            X: =352
            Y: =567
            ZIndex: =17

    icoDebugMode As icon.Information:
        Color: =If(dbgWindow,RGBA(255, 255, 255, 1),patternColor1.Fill)
        Height: =33
        Icon: =Icon.Information
        OnSelect: =Set(dbgWindow, !dbgWindow);
        Width: =37
        X: =1302
        Y: =20
        ZIndex: =12

